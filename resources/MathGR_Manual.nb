(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    247373,       8015]
NotebookOptionsPosition[    239791,       7764]
NotebookOutlinePosition[    240126,       7779]
CellTagsIndexPosition[    240083,       7776]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MathGR Manual", "Title",
 CellChangeTimes->{{3.59238328321369*^9, 3.592383305878134*^9}}],

Cell["\<\
By Yi Wang, Centre for Theoretical Cosmology, DAMTP, University of Cambridge

You are welcome to report bug at https://github.com/tririver/MathGR/issues . \
You may also contact the author at tririverwangyi@gmail.com. However, an open \
discussion at github is recommended.

On the other hand, as part of GPLv3, the author has no responsibility for \
(though tries hard to achieve) the correctness of the code. If you use this \
package in your research, please do check the result using independent \
methods.\
\>", "Text",
 CellChangeTimes->{{3.5923833667872066`*^9, 3.592383374507791*^9}, {
   3.592383436526936*^9, 3.592383450426792*^9}, {3.592621662224024*^9, 
   3.592621663630933*^9}, {3.592621853994488*^9, 3.592621928421978*^9}, {
   3.592622007090208*^9, 3.592622009992198*^9}, {3.592622191808166*^9, 
   3.5926222773980503`*^9}, 3.592622313043351*^9, {3.5926242057213707`*^9, 
   3.59262420661043*^9}}],

Cell[CellGroupData[{

Cell["Tensor Calculations (tensor.m)", "Section",
 CellChangeTimes->{{3.592383538641851*^9, 3.592383551837599*^9}, {
  3.592383748315991*^9, 3.592383764615114*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/tensor.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "to", " ", "typeset", " ", "the", " ", "output"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.592383563045433*^9, 3.592383575847917*^9}, {
  3.592383775936923*^9, 3.592383803780487*^9}}],

Cell[CellGroupData[{

Cell["Tensor convention", "Subsection",
 CellChangeTimes->{{3.592383814715877*^9, 3.5923838198210506`*^9}}],

Cell["\<\
Tensors in MathGR are expressed in the form, e.g.\
\>", "Text",
 CellChangeTimes->{{3.5923836026828337`*^9, 3.592383627927*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<\[Alpha]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Beta]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Gamma]\>\""}], ",", 
   RowBox[{"UP", "@", "\"\<\[Delta]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5923836316735477`*^9, 3.59238367071555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["T",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], "", "", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP]},
      {"", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], ""}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Output",
 CellChangeTimes->{{3.592383654594595*^9, 3.592383671271758*^9}, 
   3.592384665184346*^9, 3.5923848296110573`*^9, 3.592385543683503*^9, 
   3.59255224733722*^9, 3.592552483637986*^9, 3.592566903005534*^9, {
   3.5926233045092907`*^9, 3.592623325905444*^9}, {3.59262338491138*^9, 
   3.592623396618031*^9}, {3.592623442684757*^9, 3.5926234498436527`*^9}, 
   3.596958897190613*^9}]
}, Open  ]],

Cell[TextData[{
 "One can either input the tensors directly, or copy/modify the output as new \
input. \n\nWhen copying the tensor into input, please do pay attention that \
there are some invisible bound boxes thus please do copy the largest possible \
selection. Also it is helpful to test the copy-paste. Hopefully this \
inconvenience will be fixed after the package is updated to ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10. Also, this issue only affects the typeset form. The input form T[UP@\
\[CloseCurlyDoubleQuote]\[Alpha]\[CloseCurlyDoubleQuote],DN@\
\[CloseCurlyDoubleQuote]\[Beta]\[CloseCurlyDoubleQuote],DN@\
\[CloseCurlyDoubleQuote]\[Gamma]\[CloseCurlyDoubleQuote],UP@\
\[CloseCurlyDoubleQuote]\[Delta]\[CloseCurlyDoubleQuote]] has everything \
explicit, and is free from this problem.\n\nNote that the indices \
\[OpenCurlyDoubleQuote]\[Alpha]\[CloseCurlyDoubleQuote], ... are defined as \
strings. This is not necessary but it prohibits the possibility that \[Alpha] \
is set to a value such as \[Alpha]=1. In the output the doube quote sign is \
not displayed.\n\nHere the UP and DN are identifieres for upper and lower \
indices. They are predefined internally as\n\nDeclareIdx[{UP, DN}, \
DefaultDim, GreekIdx, Black]\n\nHere DefaultDim is spacetime dimension, used \
in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[Delta]", "a"], "a"], "=", "DefaultDim"}], 
   TraditionalForm]]],
 ". GreekIdx is the default indices to use for dummy indices: {\
\[OpenCurlyDoubleQuote]\[Alpha]\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]\[Beta]\[CloseCurlyDoubleQuote], ...}. One can either \
use LatinIdx, LatinCapitalIdx, or any user-defined set of strings.\n\nBlack \
is the color to display the indices {UP, DN}. Any other ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "-defined colors can be used.\n\nOne can also define upper and lower indices \
identifiers other than {UP, DN}. For example,\n\nDeclareIdx[{U2, D2}, Dim2, \
LatinIdx, Red]\n\nMore discussions are available when indroducing decomp.m "
}], "Text",
 CellChangeTimes->{{3.592383697590067*^9, 3.592383723490519*^9}, {
  3.592383905386013*^9, 3.5923842422548513`*^9}, {3.592384319619892*^9, 
  3.592384329855151*^9}, {3.592384365359956*^9, 3.592384421433889*^9}, {
  3.592535016857683*^9, 3.592535145456586*^9}, {3.5926223446990547`*^9, 
  3.592622569368891*^9}, {3.592622612834042*^9, 3.5926226234970016`*^9}, {
  3.592622864479847*^9, 3.592622918209013*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Einstein\[CloseCurlyQuote]s summation convention\
\>", "Subsection",
 CellChangeTimes->{{3.592547476879816*^9, 3.5925475145360126`*^9}}],

Cell[TextData[{
 "Dummy indices are considered summed. \n\nHowever, sometimes, dummy indices \
in one tensor may coincide with the dummy in another tensor. For example, ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " = ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 ", then what\[CloseCurlyQuote]s ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 "? We know it shouldn\[CloseCurlyQuote]t be\n",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " = ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " because it doesn\[CloseCurlyQuote]t make sense to have indice \[Rho] \
appear 4 times.\n\nTo make sure the above problem doesn\[CloseCurlyQuote]t \
happen, we make use of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s Unique[] function, to generate unique dummy indices. \
For example, one can define"
}], "Text",
 CellChangeTimes->{{3.592547488475833*^9, 3.592547782329068*^9}, {
  3.5925479021435432`*^9, 3.592547916818199*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\[Mu]_",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\[Nu]_",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["T1",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\[Mu]",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP], ""},
          {"", 
           TagBox[
            StyleBox["#1",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], 
     TagBox[
      RowBox[{
       AdjustmentBox["T1",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["#1",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP], ""},
          {"", 
           TagBox[
            StyleBox["\[Nu]",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}], "&"}], "@", 
   RowBox[{"Unique", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592547786507189*^9, 3.592547869063339*^9}, {
  3.5925479410810347`*^9, 3.592547952779361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592547875761746*^9, 3.592547925605997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Mu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$3",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Nu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$4",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$3",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Nu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$4",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Mu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.59254783872719*^9, {3.592547871864098*^9, 3.592547893913225*^9}, {
   3.5925479260594263`*^9, 3.592547954753255*^9}, 3.592552247434173*^9, 
   3.5925524837407093`*^9, 3.5925669030865803`*^9, {3.592623304599566*^9, 
   3.592623326043706*^9}, {3.592623385110477*^9, 3.5926233969911222`*^9}, {
   3.592623442753937*^9, 3.592623449928732*^9}, 3.5969589050617523`*^9}]
}, Open  ]],

Cell["\<\
Now the dummy indices do not coincide. For multiple dummy indices, Uq[n] is \
defined, such that ...&@Uq[3] is equivalent to ...&[Unique[ ], Unique[ ], \
Unique[ ]].\
\>", "Text",
 CellChangeTimes->{{3.5925479995155993`*^9, 3.592548041999528*^9}, {
  3.592548400425274*^9, 3.592548404856921*^9}, {3.592623066900333*^9, 
  3.592623139252087*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor simplification", "Subsection",
 CellChangeTimes->{{3.592534897417115*^9, 3.592534905363347*^9}}],

Cell["\<\
Simp[expr] brings tensors into a unique forms. Thus cancellation between \
tensors are manifest. For example,\
\>", "Text",
 CellChangeTimes->{{3.5925352061125193`*^9, 3.592535272052431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Mu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Lambda]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Lambda]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Nu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}], "+", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Mu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Rho]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Rho]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Nu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}]}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
  3.592535158349567*^9, 3.592535183994375*^9}, {3.592623478238757*^9, 
  3.592623480897429*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Nu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Mu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592534956775133*^9, 3.592534977721964*^9}, 
   3.592535185288974*^9, 3.592552247541443*^9, 3.59255248384684*^9, 
   3.592566903190234*^9, {3.592623304737172*^9, 3.59262332623808*^9}, {
   3.5926233851942863`*^9, 3.592623397201036*^9}, {3.592623442812731*^9, 
   3.592623450002203*^9}, 3.5969589088248377`*^9}]
}, Open  ]],

Cell["\<\
In this example, dummy variables are renamed. Simp can also take care of \
tensor symmetries, as long as you define them (as below).\
\>", "Text",
 CellChangeTimes->{{3.592535285161714*^9, 3.592535351508684*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Declare tensor symmetry", "Subsection",
 CellChangeTimes->{{3.592383814715877*^9, 3.59238383651434*^9}}],

Cell["\<\
If a tensor is known to have some symmetries (or anti-symmetries), one had \
better to declare them, so that the symmetries are taken into consideration \
when doing tensor simplification. For example,\
\>", "Text",
 CellChangeTimes->{{3.592384546085244*^9, 3.592384610593562*^9}}],

Cell[BoxData[
 RowBox[{"DeclareSym", "[", 
  RowBox[{"T", ",", 
   RowBox[{"{", 
    RowBox[{"UP", ",", "DN", ",", "DN", ",", "UP"}], "}"}], ",", 
   RowBox[{"Antisymmetric", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5923838396306553`*^9, 3.5923838789715548`*^9}, {
  3.5923849367511253`*^9, 3.5923849474808197`*^9}, {3.592535493008594*^9, 
  3.5925354942764053`*^9}}],

Cell["\<\
Now MathGR can make use of the symmetry:\
\>", "Text",
 CellChangeTimes->{{3.5923846959820957`*^9, 3.592384713671777*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<\[Alpha]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<\[Delta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<\[Beta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<\[Gamma]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], "-", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<\[Alpha]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<\[Delta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<\[Gamma]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<\[Beta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"]}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592384727308025*^9, 3.5923847379444313`*^9}, {
  3.592384865716988*^9, 3.592384868883602*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.5923847384557257`*^9, 3.592384754042075*^9}, 
   3.592384829764579*^9, {3.592384866520507*^9, 3.592384869487259*^9}, 
   3.5923855441215277`*^9, 3.592552247652443*^9, 3.592552483954777*^9, 
   3.592566903273094*^9, {3.592623304831995*^9, 3.592623326575317*^9}, {
   3.592623385270816*^9, 3.592623397340296*^9}, {3.592623442884169*^9, 
   3.592623450099037*^9}, 3.59695891310843*^9}]
}, Open  ]],

Cell[TextData[{
 "Other available symmetries include Symmetric and Cycles. Those functions \
are ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " builtin functions with manual available therein."
}], "Text",
 CellChangeTimes->{{3.592535500525838*^9, 3.59253558416088*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial derivatives", "Subsection",
 CellChangeTimes->{{3.592535477851265*^9, 3.592535481559907*^9}, 
   3.592535707711619*^9}],

Cell["\<\
Partial derivatives in MathGR is defined as\
\>", "Text",
 CellChangeTimes->{{3.592535656552045*^9, 3.592535674260539*^9}, 
   3.5925357065087233`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pd", "[", 
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<\[Alpha]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<\[Delta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<\[Beta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<\[Gamma]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ",", 
   RowBox[{"DN", "@", "\"\<\[Lambda]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592535622874538*^9, 3.592535640015697*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   SubscriptBox["\[CapitalSampi]", 
    TagBox[
     StyleBox["\<\"\[Lambda]\"\>",
      FontColor->GrayLevel[0]],
     MathGR`tensor`DN]], 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"]}],
  "mgrPd"]], "Output",
 CellChangeTimes->{
  3.5925356431472683`*^9, 3.592552247739015*^9, 3.592552484043466*^9, 
   3.592566903283193*^9, {3.5926233048439283`*^9, 3.5926233267499323`*^9}, {
   3.5926233852782383`*^9, 3.5926233973530912`*^9}, {3.592623442894405*^9, 
   3.592623450111801*^9}, 3.5969589177626867`*^9}]
}, Open  ]],

Cell["\<\
Partial derivatives are linear and obeys the Leibniz rule:\
\>", "Text",
 CellChangeTimes->{{3.592535698172316*^9, 3.592535749523859*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pd", "[", 
  RowBox[{
   RowBox[{"x", "+", 
    RowBox[{"y", " ", "z"}]}], ",", 
   RowBox[{"DN", "@", "\"\<\[Alpha]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925357531868677`*^9, 3.592535766545393*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    SubscriptBox["\[CapitalSampi]", 
     TagBox[
      StyleBox["\<\"\[Alpha]\"\>",
       FontColor->GrayLevel[0]],
      MathGR`tensor`DN]], "x"}],
   "mgrPd"], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "z"}],
     "mgrPd"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.5925357669684277`*^9, 3.592552247753811*^9, 3.5925524840575438`*^9, 
   3.592566903528707*^9, {3.592623304921487*^9, 3.592623326900395*^9}, {
   3.592623385366194*^9, 3.592623397635202*^9}, {3.592623442933345*^9, 
   3.592623450189477*^9}, 3.5969589192997913`*^9}]
}, Open  ]],

Cell["\<\
As shown above, undeclared quantities are not assumed as constant. Rather, \
one has to define constants explicitly:\
\>", "Text",
 CellChangeTimes->{{3.592535785052247*^9, 3.592535836411697*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{"const", ",", "_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Pd", "[", 
  RowBox[{
   RowBox[{"const", "*", "x"}], ",", 
   RowBox[{"DN", "@", "\"\<\[Alpha]\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.592535837904208*^9, 3.592535866796677*^9}}],

Cell[BoxData[
 RowBox[{"const", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     SubscriptBox["\[CapitalSampi]", 
      TagBox[
       StyleBox["\<\"\[Alpha]\"\>",
        FontColor->GrayLevel[0]],
       MathGR`tensor`DN]], "x"}],
    "mgrPd"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.592535860337606*^9, 3.592552247837673*^9, 3.592552484131105*^9, 
   3.592566903945957*^9, {3.59262330492708*^9, 3.592623327040902*^9}, {
   3.592623385380733*^9, 3.59262339764351*^9}, {3.592623443010791*^9, 
   3.592623450236676*^9}, 3.596958920835064*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Kronecker \[Delta] symbol", "Subsection",
 CellChangeTimes->{{3.592535931013461*^9, 3.5925359577796497`*^9}}],

Cell["\<\
The Kronecker \[Delta] symbol will evaluate contraction automatically\
\>", "Text",
 CellChangeTimes->{{3.592536192699143*^9, 3.592536212260251*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["Dta",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Gamma]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592536000839815*^9, 3.5925360486091413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$9",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$9",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592536030710761*^9, 3.592536049409071*^9}, 
   3.592552247927678*^9, 3.5925524842322607`*^9, 3.592566904046266*^9, {
   3.592623305128131*^9, 3.5926233273488483`*^9}, {3.5926233854831944`*^9, 
   3.592623397749036*^9}, {3.592623443017017*^9, 3.592623450310655*^9}, 
   3.596958925685793*^9}]
}, Open  ]],

Cell["\<\
If no contraction in \[Delta] is found, Dta is held to prevent searching for \
contractions all the time. This Hold[Dta] is released when Simp is called, \
where new contractions are searched for.\
\>", "Text",
 CellChangeTimes->{{3.592536290281402*^9, 3.592536366758533*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["Dta",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Delta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Gamma]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592536219664036*^9, 3.592536270423643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$10",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$10",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox[
      RowBox[{"Hold", "[", "Dta", "]"}],
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592536235469802*^9, 3.592536270877605*^9}, 
   3.592552247936401*^9, 3.592552484248513*^9, 3.592566904088455*^9, {
   3.5926233054044952`*^9, 3.5926233274633303`*^9}, {3.592623385574839*^9, 
   3.592623398158699*^9}, {3.592623443074771*^9, 3.592623450323901*^9}, 
   3.5969589277917747`*^9}]
}, Open  ]],

Cell["\<\
This gives spacetime dimension:\
\>", "Text",
 CellChangeTimes->{{3.592536389123045*^9, 3.592536394266321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["Dta",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], ""},
      {"", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Input",
 CellChangeTimes->{{3.592536378134956*^9, 3.59253637854865*^9}}],

Cell[BoxData["DefaultDim"], "Output",
 CellChangeTimes->{
  3.592536379129898*^9, 3.592552248000677*^9, 3.592552484323791*^9, 
   3.592566904128502*^9, {3.592623305417657*^9, 3.592623327562953*^9}, {
   3.592623385686133*^9, 3.592623398534938*^9}, {3.5926234433740463`*^9, 
   3.592623450371579*^9}, 3.59695893088735*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The generalized \[Delta] symbol", "Subsection",
 CellChangeTimes->{{3.5925364173722467`*^9, 3.5925364232924*^9}}],

Cell["\<\
The generalized \[Delta] symbol is defined as a product of \[Delta]\
\[CloseCurlyQuote]s, with lower indices perfectly antisymmetrized:\
\>", "Text",
 CellChangeTimes->{{3.592536563396202*^9, 3.592536598966343*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DtaGen", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<\[Alpha]\>\""}], ",", 
   RowBox[{"UP", "@", "\"\<\[Beta]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Mu]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Nu]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925364331188517`*^9, 3.592536498293972*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       AdjustmentBox[
        RowBox[{"Hold", "[", "Dta", "]"}],
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {"", 
           TagBox[
            StyleBox["\<\"\[Beta]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP]},
          {
           TagBox[
            StyleBox["\<\"\[Mu]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN], ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], ")"}]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox[
       RowBox[{"Hold", "[", "Dta", "]"}],
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"\[Nu]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox[
       RowBox[{"Hold", "[", "Dta", "]"}],
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"\[Mu]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox[
       RowBox[{"Hold", "[", "Dta", "]"}],
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"\[Nu]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.592536468066381*^9, 3.592536498822962*^9}, 
   3.592552248089136*^9, 3.5925524843714733`*^9, 3.5925669041600018`*^9, {
   3.592623305540909*^9, 3.592623327706264*^9}, {3.592623385701824*^9, 
   3.592623398693427*^9}, {3.592623443438369*^9, 3.59262345044751*^9}, 
   3.596958935746752*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Levi-Civita symbol", "Subsection",
 CellChangeTimes->{{3.5925366489484243`*^9, 3.592536675458056*^9}, {
  3.5925367565240602`*^9, 3.59253675689246*^9}}],

Cell["\<\
If spacetime dimension is given explicitly as a number, the Levi-Civita \
symbol is defined as LeviCivita[...], which is totally anti-symmetric. A \
product ot two Levi-Civita tensors is reduced to generalized \[Delta] symbol.\
\
\>", "Text",
 CellChangeTimes->{{3.5925367343662148`*^9, 3.592536833037497*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Symmetrization or anti-symmetrization of free indices\
\>", "Subsection",
 CellChangeTimes->{{3.592536937062154*^9, 3.592536944844756*^9}, {
  3.592536977316908*^9, 3.592536979794327*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "//", "Sym"}]], "Input",
 CellChangeTimes->{{3.5925369622405787`*^9, 3.5925369739790077`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "+", 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Output",
 CellChangeTimes->{{3.592536964233883*^9, 3.592536974448186*^9}, 
   3.5925522481574783`*^9, 3.592552484448515*^9, 3.592566904171669*^9, {
   3.5926233057832747`*^9, 3.592623327719996*^9}, {3.592623385798024*^9, 
   3.592623398969266*^9}, {3.592623443453079*^9, 3.592623450518778*^9}, 
   3.596958937453475*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "//", "Asym"}]], "Input",
 CellChangeTimes->{{3.5925369622405787`*^9, 3.5925369635711527`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "-", 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Output",
 CellChangeTimes->{
  3.592536964233883*^9, 3.592552248399541*^9, 3.5925524845297613`*^9, 
   3.5925669042067947`*^9, {3.592623305902053*^9, 3.592623327837315*^9}, {
   3.592623385906249*^9, 3.5926233989842567`*^9}, {3.59262344352314*^9, 
   3.592623450635056*^9}, 3.5969589384917917`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GR calculations (gr.m)", "Section",
 CellChangeTimes->{{3.5925368757140913`*^9, 3.592536880888844*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/gr.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592536994899125*^9, 3.5925369988552027`*^9}, {
  3.592563328542149*^9, 3.592563328880149*^9}}],

Cell[CellGroupData[{

Cell["GR quantities", "Subsection",
 CellChangeTimes->{{3.592547212008951*^9, 3.592547214769696*^9}}],

Cell["\<\
Quantities Affine[UP,DN,DN], R[UP,DN,DN,DN], R[DN,DN,DN,DN], R[DN,DN], R[] \
are calculated with a default metric g.\
\>", "Text",
 CellChangeTimes->{{3.5925370779739723`*^9, 3.592537093269932*^9}, {
  3.592547082198957*^9, 3.5925471288318357`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["Affine",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], "", ""},
      {"", 
       TagBox[
        StyleBox["\"\<\[Beta]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], 
       TagBox[
        StyleBox["\"\<\[Gamma]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Input",
 CellChangeTimes->{{3.5925370563040752`*^9, 3.59253705636567*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["$11",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["$11",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Beta]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Gamma]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"], ")"}]}], "+", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["$11",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], "+", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["$11",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.592537057975049*^9, 3.592552248506106*^9, 3.5925524848068113`*^9, 
   3.592566904283984*^9, {3.592623306014205*^9, 3.592623328005434*^9}, {
   3.5926233859921827`*^9, 3.592623399169107*^9}, {3.592623443706889*^9, 
   3.5926234508212147`*^9}, 3.5969589459038*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547067850177*^9, 3.592547071015139*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Beta]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Gamma]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.592547071880156*^9, 3.5925522487292633`*^9, 3.592552485063575*^9, 
   3.592566904534931*^9, {3.592623306337317*^9, 3.592623328268077*^9}, {
   3.59262338608315*^9, 3.592623399308264*^9}, {3.592623443983449*^9, 
   3.5926234509590273`*^9}, 3.596958958321105*^9}]
}, Open  ]],

Cell["\<\
Quantities can be calculated using alternative metric\
\>", "Text",
 CellChangeTimes->{{3.5925471843529243`*^9, 3.592547192722919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"WithMetric", "[", 
   RowBox[{"h", ",", 
    RowBox[{"R", "[", "]"}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547133961891*^9, 3.5925471362395353`*^9}, {
  3.592547167272147*^9, 3.592547172530463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["h",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Beta]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["h",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Gamma]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.592547173228063*^9, 3.592552249008205*^9, 3.592552485285125*^9, 
   3.59256690498538*^9, {3.592623306588084*^9, 3.592623328586069*^9}, {
   3.592623386289989*^9, 3.592623399616419*^9}, {3.592623444224001*^9, 
   3.592623451195444*^9}, 3.596958963022174*^9}]
}, Open  ]],

Cell["\<\
Quantities can be calculated in terms of, say, affine instead of metric. One \
can also define new metrics using UseMetric[metric, {upIdx, dnIdx}].\
\>", "Text",
 CellChangeTimes->{{3.592547227071014*^9, 3.592547253505663*^9}, {
  3.592548150629743*^9, 3.592548205934392*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Affine", "=", "\[CapitalGamma]"}], "}"}], ",", 
    RowBox[{"R", "[", "]"}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547255102035*^9, 3.592547268084371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalGamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], "", ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalGamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], "", ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5925472648246927`*^9, 3.592547268607706*^9}, 
   3.592552249060154*^9, 3.592552485354107*^9, 3.592566905113068*^9, {
   3.592623306819353*^9, 3.592623328669876*^9}, {3.5926233864188128`*^9, 
   3.5926233999672537`*^9}, {3.592623444288439*^9, 3.592623451239603*^9}, 
   3.5969589643442497`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariant derivatives", "Subsection",
 CellChangeTimes->{{3.592547378393669*^9, 3.592547381310028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CovD", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"DN", "@", "\"\<\[Alpha]\>\""}], "]"}], ",", 
    RowBox[{"DN", "@", "\"\<\[Beta]\>\""}]}], "]"}], "//", "Simp"}]], "Input",\

 CellChangeTimes->{{3.592547383447771*^9, 3.592547406346381*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    SubscriptBox["\[CapitalSampi]", 
     TagBox[
      StyleBox["\<\"\[Beta]\"\>",
       FontColor->GrayLevel[0]],
      MathGR`tensor`DN]], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}],
   "mgrPd"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5925474034058857`*^9, 3.59254740694311*^9}, 
   3.592552249129002*^9, 3.592552485420312*^9, 3.592566905308597*^9, {
   3.592623306951138*^9, 3.592623328768993*^9}, {3.592623386544668*^9, 
   3.592623400123444*^9}, {3.592623444341186*^9, 3.592623451293209*^9}, 
   3.596958973632131*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric contraction", "Subsection",
 CellChangeTimes->{{3.5925474397619267`*^9, 3.592547443760118*^9}}],

Cell["\<\
One can definitely contract tensors with metric directly, such as\
\>", "Text",
 CellChangeTimes->{{3.592548116508953*^9, 3.59254812659149*^9}, {
  3.592548252221116*^9, 3.592548253245625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["g",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP]},
       {"", ""}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592548260558618*^9, 3.592548275768819*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.592548281246608*^9, 3.592552249196795*^9, 3.592552485438751*^9, 
   3.59256690540143*^9, {3.592623307075439*^9, 3.5926233287779293`*^9}, {
   3.592623386693965*^9, 3.592623400263131*^9}, {3.592623444354697*^9, 
   3.5926234513101797`*^9}, 3.596958977240753*^9}]
}, Open  ]],

Cell["\<\
However, if there are lots of metric contractions, it is useful to introduce \
the following short hand. Here UG and DG are upper and lower indices which \
are to be contracted with metric.\
\>", "Text",
 CellChangeTimes->{{3.59254828328295*^9, 3.5925483174251413`*^9}, {
  3.592548350897723*^9, 3.592548367882963*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"DG", "@", "1"}], ",", 
     RowBox[{"DG", "@", "1"}], ",", 
     RowBox[{"UG", "@", "2"}], ",", 
     RowBox[{"UG", "@", "2"}], ",", 
     RowBox[{"DG", "@", "3"}], ",", 
     RowBox[{"DG", "@", "3"}]}], "]"}], "//", "MetricContract"}], "//", 
  "Simp"}]], "Input",
 CellChangeTimes->{{3.5925483207485228`*^9, 3.592548343651291*^9}, {
  3.5925483756902027`*^9, 3.592548379270257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[CurlyEpsilon]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Zeta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", "", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", ""},
        {
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], "", "", 
         TagBox[
          StyleBox["\<\"\[CurlyEpsilon]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Zeta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.59254833286753*^9, 3.592548344066506*^9}, 
   3.592548380063374*^9, 3.592552249428406*^9, 3.592552485520343*^9, 
   3.5925669054717073`*^9, {3.592623307227124*^9, 3.59262332886201*^9}, {
   3.592623386834155*^9, 3.5926234004246264`*^9}, {3.5926234444013653`*^9, 
   3.592623451381364*^9}, 3.596958978885734*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integration by parts (ibp.m)", "Section",
 CellChangeTimes->{{3.592548872819849*^9, 3.5925488986372433`*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/ibp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592548883231072*^9, 3.592548885423325*^9}, {
  3.592563333218902*^9, 3.5925633340647087`*^9}, {3.596958991814237*^9, 
  3.596958993329874*^9}}],

Cell["\<\
This module tries to rewrite an expression into a total derivative, possibly \
with a rest part.\
\>", "Text",
 CellChangeTimes->{{3.592548892759857*^9, 3.592548957858235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], "+", 
   RowBox[{"y", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925491001828203`*^9, 3.592549147025807*^9}}],

Cell[BoxData[
 RowBox[{"PdHold", "[", 
  RowBox[{
   RowBox[{"x", " ", "y"}], ",", 
   RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.59254914769416*^9, 3.5925522495365133`*^9, 3.592552485632535*^9, 
   3.592566905558329*^9, {3.592623307827752*^9, 3.5926233293657312`*^9}, {
   3.5926233875573587`*^9, 3.592623400902482*^9}, {3.592623444504614*^9, 
   3.592623451460738*^9}, 3.596958995398645*^9}]
}, Open  ]],

Cell["\<\
Here we have renamed Pd into PdHold. Otherwise Pd will automatically be \
calculated via Leibniz rule.

Note that expressions cannot always be written as total derivatives. For \
example, the following has a rest part:\
\>", "Text",
 CellChangeTimes->{{3.592549152149476*^9, 3.592549384734662*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], "+", 
   RowBox[{"2", "y", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925491001828203`*^9, 3.592549147025807*^9}, 
   3.592549318260007*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"x", " ", "y"}], ",", 
    RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.5925493186860323`*^9, 3.5925522496984177`*^9, 3.592552485959116*^9, 
   3.592566905974062*^9, {3.592623308144906*^9, 3.592623329538454*^9}, {
   3.592623387885622*^9, 3.5926234014085608`*^9}, {3.592623444637096*^9, 
   3.5926234516025667`*^9}, 3.5969589978002987`*^9}]
}, Open  ]],

Cell["\<\
Also, Ibp[expr] may fail to find the total derivative even if it exists.

Sometimes one wants finer control. For example, what kind of rest part is \
considered to be simpler. In this case, one can specify the measure function \
explicitly. Here are a few examples:\
\>", "Text",
 CellChangeTimes->{{3.592549152149476*^9, 3.59254931134094*^9}, {
  3.5925493916620607`*^9, 3.592549462860622*^9}, {3.592549500998979*^9, 
  3.592549506625141*^9}}],

Cell["\<\
(1) Get rid of derivative on specified variable (y in the below example)\
\>", "Text",
 CellChangeTimes->{{3.592549515406789*^9, 3.592549539574801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], ",", 
   RowBox[{"IbpVar", "[", "y", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592549475194147*^9, 3.5925494939242697`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "y"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"x", " ", "y"}], ",", 
    RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.59254948607865*^9, 3.592549494391553*^9}, 
   3.59255224984006*^9, 3.592552486132552*^9, 3.592556972679886*^9, 
   3.592566906109055*^9, {3.5926233086061697`*^9, 3.5926233297078323`*^9}, {
   3.592623388380424*^9, 3.592623401750649*^9}, {3.5926234448350697`*^9, 
   3.592623451727701*^9}, 3.59695900272034*^9}]
}, Open  ]],

Cell["\<\
A more efficient version of this function (and setting boundary term to be \
zero) is\
\>", "Text",
 CellChangeTimes->{{3.592556915990922*^9, 3.5925569645030823`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IbpVariation", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.5925569388245983`*^9, 3.592556951119632*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "y"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     SubscriptBox["\[CapitalSampi]", 
      TagBox[
       StyleBox["\<\"\[Alpha]\"\>",
        FontColor->GrayLevel[0]],
       MathGR`tensor`DN]], "x"}],
    "mgrPd"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592556951526786*^9, 3.592556973943396*^9}, 
   3.592566906146654*^9, {3.592623308760557*^9, 3.592623329798568*^9}, {
   3.592623388544425*^9, 3.592623401932147*^9}, {3.5926234448862133`*^9, 
   3.592623451874774*^9}, 3.5969590039714193`*^9}]
}, Open  ]],

Cell["\<\
(2) Rules to write second order action in standard form\
\>", "Text",
 CellChangeTimes->{{3.592549546714025*^9, 3.592549582835376*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"(", 
       OverscriptBox["\[Phi]", "\[Bullet]"], ")"}], "2"]}], "+", " ", 
    RowBox[{"\[Phi]", " ", 
     OverscriptBox["\[Phi]", "\[Bullet]\[Bullet]"]}], "+", 
    RowBox[{"m", " ", "\[Phi]", 
     OverscriptBox["\[Phi]", "\[Bullet]"]}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox["M", "2"], 
     SuperscriptBox["\[Phi]", "2"]}]}], ",", "IbpStd2"}], "]"}]], "Input",
 CellChangeTimes->{{3.592556785759036*^9, 3.592556870702876*^9}, {
  3.592557000430122*^9, 3.592557042034514*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["M", "2"], " ", 
   SuperscriptBox["\[Phi]", "2"]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Phi]", "2"], " ", 
    OverscriptBox["m", "\[Bullet]"]}], "2"], "+", 
  SuperscriptBox[
   OverscriptBox["\[Phi]", "\[Bullet]"], "2"], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"m", " ", 
      SuperscriptBox["\[Phi]", "2"]}], "2"], ",", 
    RowBox[{"DE", "[", "0", "]"}]}], "]"}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"Pd", "[", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"DE", "[", "\<\"(PdId)\"\>", "]"}]}], "]"}]}], ",", 
    RowBox[{"DE", "[", "\<\"(PdId)\"\>", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.592556871506406*^9, {3.592557007787573*^9, 3.592557042543975*^9}, 
   3.5925669062559977`*^9, {3.5926233094346523`*^9, 3.592623330048965*^9}, {
   3.592623389045257*^9, 3.5926234024698257`*^9}, {3.592623445054178*^9, 
   3.5926234520561447`*^9}, 3.59695900492488*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Decomposition of dimensions (decomp.m)\
\>", "Section",
 CellChangeTimes->{{3.592557249590426*^9, 3.592557252593915*^9}, {
  3.592557467915167*^9, 3.592557468950857*^9}, {3.592557507780242*^9, 
  3.592557509644903*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/gr.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/decomp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/ibp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592557441459054*^9, 3.59255745414318*^9}, {
  3.592563340824881*^9, 3.592563355889909*^9}, {3.592565088523473*^9, 
  3.592565092333067*^9}}],

Cell["\<\
In decomp.m, two additional set of indices ({UTot, DTot}, {U2, D2}), together \
with decomposition rules are defined. Here we show the usage of decomp.m by \
going through an example.

First we define metric in the total dimensions, and the \
\[OpenCurlyDoubleQuote]compactified\[CloseCurlyDoubleQuote] dimensions. The \
3+1 dim metric is pre-defined as usual, denoted by g.\
\>", "Text",
 CellChangeTimes->{{3.592557463132421*^9, 3.5925575430470743`*^9}, {
  3.5925576214368973`*^9, 3.592557679319751*^9}}],

Cell[BoxData[{
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[DoubleStruckG]", ",", 
   RowBox[{"{", 
    RowBox[{"UTot", ",", " ", "DTot"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[Gamma]", ",", 
   RowBox[{"{", 
    RowBox[{"U2", ",", "D2"}], "}"}], ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.592557441459054*^9, 3.59255745414318*^9}, 
   3.592557547534232*^9}],

Cell["\<\
Here for illustration purpose, we compactify Einstein gravity on n-torus. The \
non-compact dimensions are assumed Minkowski and the internal dimensions also \
has no curvature. There are n constant teleparallel killing vectors (denoted \
by V here) on n-torus. The off-diag components of the metric is expanded \
using this killing vector basis, with coefficients as gauge fields A.

The followings are the form of the metric and definition of their partial \
derivatives.\
\>", "Text",
 CellChangeTimes->{{3.592565424747127*^9, 3.592565484159156*^9}, {
  3.5925655974296083`*^9, 3.592565682069167*^9}, {3.592565746190011*^9, 
  3.5925657686960583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecompHook", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\[Beta]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["g",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {"", ""},
               {
                TagBox[
                 StyleBox["\[Alpha]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN], 
                TagBox[
                 StyleBox["\[Beta]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "+", 
          RowBox[{
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["\[Alpha]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["\[Beta]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#1",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#2",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["\[Gamma]",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {"", ""},
                 {
                  TagBox[
                   StyleBox["#1",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2], 
                  TagBox[
                   StyleBox["#2",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}]}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "4", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      StyleBox["\[RuleDelayed]",
       FontSize->10], 
      RowBox[{
       StyleBox["(",
        FontSize->10], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["\[Alpha]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`DN]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["V",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#1",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["\[Gamma]",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {"", ""},
                {
                 TagBox[
                  StyleBox["b",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2], 
                 TagBox[
                  StyleBox["#1",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "2", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["a_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2], 
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      TagBox[
       RowBox[{
        AdjustmentBox["\[Gamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["a",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2], 
            TagBox[
             StyleBox["b",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], 
            TagBox[
             StyleBox["\[Beta]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\[Alpha]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], 
            TagBox[
             StyleBox["\[Beta]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], 
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["g",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["\[Alpha]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP], 
                  TagBox[
                   StyleBox["#1",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP]},
                 {"", ""}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}]}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["V",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["b",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#1",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`DN]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "2", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["a_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], 
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[Gamma]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["a",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`decomp`U2], 
                TagBox[
                 StyleBox["b",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`decomp`U2]},
               {"", ""}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "+", 
          RowBox[{
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["g",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#1",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP], 
                  TagBox[
                   StyleBox["#2",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP]},
                 {"", ""}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["a",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#1",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["b",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#2",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}]}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "4", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.592563618485373*^9, 3.5925637278950777`*^9}, {
  3.592563792803883*^9, 3.592563837593978*^9}, {3.592564484015979*^9, 
  3.592564535609757*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"g", "[", "__", "]"}], ",", "_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"Pd", "[", 
      RowBox[{
       RowBox[{"g", "[", "__", "]"}], ",", "_"}], "]"}], ",", "_"}], "]"}], ":=",
    "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"A", "[", "__", "]"}], ",", "_D2"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"Pd", "[", 
      RowBox[{
       RowBox[{"A", "[", "__", "]"}], ",", "_"}], "]"}], ",", "_D2"}], "]"}], 
   ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pd", "[", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", "__", "]"}], ",", "_"}], "]"}], ":=", "0"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{
     RowBox[{"U2", "@", "a_"}], ",", 
     RowBox[{"D2", "@", "b_"}]}], "]"}], ":=", 
   RowBox[{"Dta", "[", 
    RowBox[{
     RowBox[{"U2", "@", "a"}], ",", 
     RowBox[{"D2", "@", "b"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5925628452449293`*^9, 3.592562850285047*^9}, {
  3.592565017843031*^9, 3.592565018574593*^9}, {3.592565716957241*^9, 
  3.592565728752329*^9}}],

Cell["Now we decompose R[ ].", "Text",
 CellChangeTimes->{{3.592565784202579*^9, 3.592565807553802*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R\[Bullet]decomp", "=", 
  RowBox[{"DecompSe", "[", 
   RowBox[{
    RowBox[{"R", "[", "]"}], "//", "Simp"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.592563845504451*^9, 3.592563848330171*^9}, {
  3.5925650272364273`*^9, 3.592565061191041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Gamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Gamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.592564614269884*^9, {3.5925650504876013`*^9, 3.592565062311471*^9}, 
   3.59256690698011*^9, {3.5926233100755367`*^9, 3.5926233310927887`*^9}, {
   3.592623390124276*^9, 3.5926234033246403`*^9}, {3.592623445629925*^9, 
   3.592623452650238*^9}, 3.5969590364433537`*^9}]
}, Open  ]],

Cell["\<\
To find the result in covariant form, we try to rewrite A in terms of F. The \
TrySimp utility is provided in ibp.m\
\>", "Text",
 CellChangeTimes->{{3.592565814753924*^9, 3.592565850559642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrySimp", "[", 
  RowBox[{"R\[Bullet]decomp", ",", 
   RowBox[{
    RowBox[{"a_.", "+", 
     RowBox[{"b_.", 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\[Beta]_",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["A",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {
              TagBox[
               StyleBox["m_",
                FontColor->RGBColor[1, 0, 0]],
               MathGR`decomp`U2], ""},
             {"", 
              TagBox[
               StyleBox["\[Alpha]_",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}]}], "\[RuleDelayed]", 
    RowBox[{"a", "+", 
     RowBox[{"Simp", "[", 
      RowBox[{"b", 
       RowBox[{"(", 
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["F",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {
               TagBox[
                StyleBox["m",
                 FontColor->RGBColor[1, 0, 0]],
                MathGR`decomp`U2], "", ""},
              {"", 
               TagBox[
                StyleBox["\[Alpha]",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN], 
               TagBox[
                StyleBox["\[Beta]",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "+", 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\[Alpha]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["m",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["\[Beta]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`DN]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"]}],
          "mgrPd"]}], ")"}]}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592565067138731*^9, 3.592565134473177*^9}, {
  3.59256527458284*^9, 3.59256527691647*^9}, {3.592565368948697*^9, 
  3.592565371508411*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["F",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`decomp`U2], "", ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     SubscriptBox["\[CapitalSampi]", 
      TagBox[
       StyleBox["\<\"\[Delta]\"\>",
        FontColor->GrayLevel[0]],
       MathGR`tensor`DN]], 
     TagBox[
      RowBox[{
       AdjustmentBox["A",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`decomp`U2], ""},
          {"", 
           TagBox[
            StyleBox["\<\"\[Gamma]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}],
    "mgrPd"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["\[Gamma]",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`decomp`D2], 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`decomp`D2]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.59256527754312*^9, 3.592565372268806*^9, 3.592566907526195*^9, {
   3.5926233106482267`*^9, 3.59262333140038*^9}, {3.592623390688212*^9, 
   3.5926234038580837`*^9}, {3.592623445762424*^9, 3.59262345279537*^9}, 
   3.596959037741493*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
ADM decomposition of FRW universe (frwadm.m)\
\>", "Section",
 CellChangeTimes->{{3.59255725693364*^9, 3.592557271115985*^9}, {
  3.592566322322671*^9, 3.592566326371385*^9}}],

Cell["\<\
The frwadm.m is the setup for FRW universe with ADM type perturbations. Here \
we illuatrate the usage of this module by calculating second order \
cosmological perturbations.\
\>", "Text",
 CellChangeTimes->{{3.5925663283418407`*^9, 3.592566526740505*^9}, {
  3.592623248046653*^9, 3.5926232487204943`*^9}}],

Cell[BoxData[{
 RowBox[{"Remove", "[", 
  RowBox[{
  "a", ",", "\[Alpha]", ",", "\[Beta]", ",", "b", ",", "h", ",", "PdHold"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/util.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/ibp.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/frwadm.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/typeset.m\>\""}]}], "Input",
 CellChangeTimes->{{3.592565911778283*^9, 3.592565950142881*^9}, {
   3.592566071705748*^9, 3.592566103393549*^9}, 3.592566541700692*^9, {
   3.592623230329701*^9, 3.592623238765238*^9}, {3.5926232900686293`*^9, 
   3.5926232921910667`*^9}}],

Cell["\<\
Here we define the indices explicitly, because we want to use LatinIdx \
instead of GreekIdx for 3 spatial dimensions. 

We neglect boundary terms. Also \[Phi] is set to be homogeneous and isotropic \
(i.e. the calculation is done in \[Zeta]-gauge). \
\>", "Text",
 CellChangeTimes->{{3.592566547259996*^9, 3.592566620248598*^9}}],

Cell[BoxData[{
 RowBox[{"DeclareIdx", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"UP", ",", "DN"}], "}"}], ",", "DefaultDim", ",", "LatinIdx", ",",
    "Black"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PdHold", "[", "__", "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pd", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "|", 
     RowBox[{"Pd", "[", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"DE", "@", "0"}]}], "]"}]}], ",", 
    RowBox[{"DN", "@", "_"}]}], "]"}], ":=", "0"}]}], "Input",
 CellChangeTimes->{{3.592565911778283*^9, 3.592565950142881*^9}, {
   3.592566071705748*^9, 3.592566103393549*^9}, 3.592566541700692*^9, {
   3.59262325768673*^9, 3.592623284368868*^9}}],

Cell["\<\
The action is calculated using the ADM curvature, and the decomposed scalar \
field. DecompG2H is a helper function to decompose 3+1 dimensional quantities \
into 3 and 1.\
\>", "Text",
 CellChangeTimes->{{3.592566633154161*^9, 3.592566633519821*^9}, {
  3.592566666147599*^9, 3.592566722486635*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s012", "=", 
  RowBox[{
   RowBox[{"Sqrtg", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"RADM", "[", "]"}], "/", "2"}], "+", 
      RowBox[{"DecompG2H", "[", 
       RowBox[{"X", "[", "\[Phi]", "]"}], "]"}], "-", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], ")"}]}], "//", 
   RowBox[{"SS", "[", "2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592565970960834*^9, 3.59256597896949*^9}, {
  3.5925660621883097`*^9, 3.592566079499516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "Eps", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Zeta]"}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["a", "3"], " ", "H", " ", 
      OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
     RowBox[{
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{"4", " ", "a", " ", "H", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         SubscriptBox["\[CapitalSampi]", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]], 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], "\[Beta]"}],
          "mgrPd"]}],
        "mgrPd"], ")"}]}], "-", 
     RowBox[{"4", " ", "a", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         SubscriptBox["\[CapitalSampi]", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]], 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], "\[Zeta]"}],
          "mgrPd"]}],
        "mgrPd"], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", "a", " ", "\[ExponentialE]"}]], 
   RowBox[{
    SuperscriptBox["Eps", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "12"}], " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["H", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"]}], "+", 
      RowBox[{"36", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["H", "2"], " ", "\[Alpha]", " ", "\[Zeta]"}], "-", 
      RowBox[{"54", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["H", "2"], " ", 
       SuperscriptBox["\[Zeta]", "2"]}], "+", 
      RowBox[{"24", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Alpha]", " ", 
       OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
      RowBox[{"72", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Zeta]", " ", 
       OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox[
        OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          AdjustmentBox["b",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {""},
             {
              TagBox[
               StyleBox["\<\"a\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], "\[Zeta]"}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], "\[Beta]"}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], "\[Zeta]"}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], "\[Zeta]"}],
          "mgrPd"], ")"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "\[Alpha]", " ",
        "\[Zeta]", " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["\[Zeta]", "2"], " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Alpha]", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Zeta]", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", 
       OverscriptBox["\[Zeta]", "\[Bullet]"], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], 
           TagBox[
            RowBox[{
             SubscriptBox["\[CapitalSampi]", 
              TagBox[
               StyleBox["\<\"a\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]], "\[Beta]"}],
            "mgrPd"]}],
          "mgrPd"], ")"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"b\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Zeta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "\[Zeta]", " ", 
       
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Zeta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "\[Alpha]", " ",
        "\[Zeta]", " ", 
       RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{"18", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["\[Zeta]", "2"], " ", 
       RowBox[{"V", "[", "\[Phi]", "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.59256607655898*^9, 3.592566107542033*^9, 3.5925662383004627`*^9, 
   3.592566910169251*^9, {3.592623312401331*^9, 3.592623332656321*^9}, {
   3.592623392050716*^9, 3.592623405163845*^9}, {3.592623447108526*^9, 
   3.592623454072809*^9}, 3.596959044261691*^9}]
}, Open  ]],

Cell["\<\
The first order action. Here OO[n] is defined in util.m, which collect order \
n terms w.r.t. Eps\
\>", "Text",
 CellChangeTimes->{{3.59256673780443*^9, 3.592566775771201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s1", "=", 
  RowBox[{"s012", "//", 
   RowBox[{"OO", "[", "1", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566089724766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Alpha]"}], "-", 
  RowBox[{"9", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Zeta]"}], "-", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
  RowBox[{
   FractionBox["3", "2"], " ", 
   SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
  RowBox[{"2", " ", "a", " ", "H", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"a\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], "\[Beta]"}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"a\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], "\[Zeta]"}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.5925660911681967`*^9, 3.592566111248671*^9}, 
   3.592566240943439*^9, 3.592566910527968*^9, {3.592623312650408*^9, 
   3.592623333084898*^9}, {3.5926233924729033`*^9, 3.592623405552698*^9}, {
   3.592623447314098*^9, 3.5926234542888308`*^9}, 3.596959044307406*^9}]
}, Open  ]],

Cell["\<\
The background EoM is solved (by varying the 1st order action) and added into \
SimpHook.\
\>", "Text",
 CellChangeTimes->{{3.59256679734159*^9, 3.5925668247144623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpHook", "=", 
  RowBox[{"SimpHook", "~", "Union", "~", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SolveExpr", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"s1", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"IbpVariation", "[", 
             RowBox[{"s1", ",", "\[Zeta]"}], "]"}], ",", "\[Zeta]"}], "]"}], 
          "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "[", "\[Phi]", "]"}], ",", 
         RowBox[{
          RowBox[{"Pd", "[", 
           RowBox[{"\[Phi]", ",", 
            RowBox[{"DE", "@", "0"}]}], "]"}], "^", "2"}]}], "}"}]}], "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.5925661896593227`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DefaultDim", "\[Rule]", "3"}], ",", 
   RowBox[{
    OverscriptBox["a", "\[Bullet]"], "\[Rule]", 
    RowBox[{"a", " ", "H"}]}], ",", 
   RowBox[{
    OverscriptBox["H", "\[Bullet]"], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["H", "2"]}], " ", "\[Epsilon]"}]}], ",", 
   RowBox[{
    OverscriptBox["\[Epsilon]", "\[Bullet]"], "\[Rule]", 
    RowBox[{"H", " ", "\[Epsilon]", " ", "\[Eta]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["\[Phi]", "\[Bullet]"], "2"], "\[Rule]", 
    RowBox[{"2", " ", 
     SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}], ",", 
   RowBox[{
    RowBox[{"V", "[", "\[Phi]", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["H", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5925661330107822`*^9, 3.5925662430249662`*^9}, 
   3.592566910606022*^9, {3.5926233127432632`*^9, 3.592623333263301*^9}, {
   3.592623392632369*^9, 3.5926234056957607`*^9}, {3.592623447372363*^9, 
   3.592623454358177*^9}, 3.5969590443331614`*^9}]
}, Open  ]],

Cell["The second order action.", "Text",
 CellChangeTimes->{{3.592566834006785*^9, 3.5925668382864532`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2", "=", 
  RowBox[{
   RowBox[{"s012", "//", 
    RowBox[{"OO", "[", "2", "]"}]}], "//", "Fourier2"}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566131041789*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"]}], "+", 
  RowBox[{"2", " ", "a", " ", "H", " ", 
   SuperscriptBox["k", "2"], " ", "\[Alpha]", " ", "\[Beta]"}], "+", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Epsilon]"}], "+", 
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["k", "2"], " ", "\[Alpha]", " ", "\[Zeta]"}], "-", 
  RowBox[{"27", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{"a", " ", 
   SuperscriptBox["k", "2"], " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Epsilon]", " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["k", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{
        AdjustmentBox["b",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], ")"}], "2"]}], 
   RowBox[{"4", " ", "a", " ", "\[ExponentialE]"}]], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", "\[Alpha]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["k", "2"], " ", "\[Beta]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"18", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", "\[Zeta]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox[
    OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.5925662466214867`*^9, 3.5925669107414913`*^9, {3.592623312865692*^9, 
   3.592623333574745*^9}, {3.592623392767048*^9, 3.59262340582801*^9}, {
   3.5926234474911623`*^9, 3.5926234544783916`*^9}, 3.596959044396988*^9}]
}, Open  ]],

Cell["\<\
Solving constraints in the second order action.\
\>", "Text",
 CellChangeTimes->{{3.5925668477139378`*^9, 3.592566858279282*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solCons", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", "\[Beta]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", 
          RowBox[{"b", "[", 
           RowBox[{"DN", "@", "\"\<a\>\""}], "]"}]}], "]"}], "\[Equal]", 
        "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
       RowBox[{"b", "[", 
        RowBox[{"DN", "@", "\"\<a\>\""}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566117708316*^9}, {3.592566252107847*^9, 
   3.592566254434847*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     OverscriptBox["\[Zeta]", "\[Bullet]"], "H"]}], ",", 
   RowBox[{"\[Beta]", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["k", "2"], " ", "\[Zeta]"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "H", " ", "\[Epsilon]", " ", 
        OverscriptBox["\[Zeta]", "\[Bullet]"]}]}], 
      RowBox[{"H", " ", 
       SuperscriptBox["k", "2"]}]]}]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["b",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.592566255651764*^9, 3.5925669108105917`*^9, {3.5926233129715157`*^9, 
   3.592623334104526*^9}, {3.592623392939781*^9, 3.592623405988326*^9}, {
   3.5926234475277653`*^9, 3.592623454553454*^9}, 3.596959044418895*^9}]
}, Open  ]],

Cell["\<\
Inserting the solved constraints, and do integration by parts, we get the \
desired second order action.\
\>", "Text",
 CellChangeTimes->{{3.5925668657837667`*^9, 3.5925668890597563`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2Solved", "=", 
  RowBox[{
   RowBox[{"s2", "/.", "solCons"}], "//", 
   RowBox[{
    RowBox[{"Ibp", "[", 
     RowBox[{"#", ",", "IbpStd2"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566117708316*^9}, {3.592566252107847*^9, 
   3.592566260591505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "a"}], " ", 
   SuperscriptBox["k", "2"], " ", "\[Epsilon]", " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", "\[Epsilon]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.5925662626264563`*^9, 3.592566911054432*^9, {3.592623313274959*^9, 
   3.592623334431535*^9}, {3.5926233934436283`*^9, 3.59262340644344*^9}, {
   3.5926234477124968`*^9, 3.592623454748464*^9}, 3.5969590444703007`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"PdHold", ",", "h"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"clean", " ", "up", " ", "for", " ", "non"}], "-", 
    RowBox[{"standard", " ", "definition"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.592623340769743*^9, 3.592623381390614*^9}, {
  3.5926234309349737`*^9, 3.5926234312312613`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 748},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 95, 1, 92, "Title"],
Cell[677, 25, 923, 17, 165, "Text"],
Cell[CellGroupData[{
Cell[1625, 46, 164, 2, 80, "Section"],
Cell[1792, 50, 372, 8, 55, "Input"],
Cell[CellGroupData[{
Cell[2189, 62, 107, 1, 44, "Subsection"],
Cell[2299, 65, 138, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[2462, 72, 323, 7, 32, "Input"],
Cell[2788, 81, 1314, 39, 36, "Output"]
}, Open  ]],
Cell[4117, 123, 2497, 43, 517, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6651, 171, 146, 3, 44, "Subsection"],
Cell[6800, 176, 9897, 324, 173, "Text"],
Cell[16700, 502, 2416, 82, 36, "Input"],
Cell[CellGroupData[{
Cell[19141, 588, 1482, 52, 36, "Input"],
Cell[20626, 642, 3354, 111, 36, "Output"]
}, Open  ]],
Cell[23995, 756, 355, 7, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24387, 768, 109, 1, 44, "Subsection"],
Cell[24499, 771, 201, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[24725, 779, 3275, 111, 36, "Input"],
Cell[28003, 892, 3368, 110, 36, "Output"]
}, Open  ]],
Cell[31386, 1005, 222, 4, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31645, 1014, 110, 1, 44, "Subsection"],
Cell[31758, 1017, 291, 5, 55, "Text"],
Cell[32052, 1024, 435, 10, 32, "Input"],
Cell[32490, 1036, 132, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[32647, 1043, 2133, 70, 36, "Input"],
Cell[34783, 1115, 1448, 41, 36, "Output"]
}, Open  ]],
Cell[36246, 1159, 278, 7, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36561, 1171, 133, 2, 44, "Subsection"],
Cell[36697, 1175, 161, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[36883, 1183, 1155, 37, 36, "Input"],
Cell[38041, 1222, 1468, 46, 36, "Output"]
}, Open  ]],
Cell[39524, 1271, 148, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[39697, 1278, 235, 6, 32, "Input"],
Cell[39935, 1286, 1021, 34, 32, "Output"]
}, Open  ]],
Cell[40971, 1323, 206, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[41202, 1331, 345, 10, 55, "Input"],
Cell[41550, 1343, 548, 15, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42147, 1364, 119, 1, 44, "Subsection"],
Cell[42269, 1367, 159, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[42453, 1374, 1496, 52, 36, "Input"],
Cell[43952, 1428, 1818, 58, 36, "Output"]
}, Open  ]],
Cell[45785, 1489, 286, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[46096, 1498, 1495, 52, 36, "Input"],
Cell[47594, 1552, 2606, 85, 36, "Output"]
}, Open  ]],
Cell[50215, 1640, 121, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[50361, 1647, 761, 26, 36, "Input"],
Cell[51125, 1675, 321, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51495, 1686, 119, 1, 44, "Subsection"],
Cell[51617, 1689, 225, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[51867, 1697, 323, 7, 32, "Input"],
Cell[52193, 1706, 3688, 120, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55930, 1832, 162, 2, 44, "Subsection"],
Cell[56095, 1836, 320, 6, 55, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56452, 1847, 198, 4, 44, "Subsection"],
Cell[CellGroupData[{
Cell[56675, 1855, 813, 27, 36, "Input"],
Cell[57491, 1884, 1744, 56, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59272, 1945, 814, 27, 36, "Input"],
Cell[60089, 1974, 1722, 56, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61872, 2037, 109, 1, 80, "Section"],
Cell[61984, 2040, 235, 4, 55, "Input"],
Cell[CellGroupData[{
Cell[62244, 2048, 101, 1, 44, "Subsection"],
Cell[62348, 2051, 259, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[62632, 2060, 884, 30, 36, "Input"],
Cell[63519, 2092, 4192, 136, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67748, 2233, 142, 3, 32, "Input"],
Cell[67893, 2238, 28318, 953, 84, "Output"]
}, Open  ]],
Cell[96226, 3194, 145, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[96396, 3201, 256, 6, 32, "Input"],
Cell[96655, 3209, 28314, 953, 84, "Output"]
}, Open  ]],
Cell[124984, 4165, 286, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[125295, 4174, 270, 7, 32, "Input"],
Cell[125568, 4183, 9620, 318, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135237, 4507, 109, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[135371, 4512, 288, 8, 32, "Input"],
Cell[135662, 4522, 8685, 294, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144396, 4822, 108, 1, 44, "Subsection"],
Cell[144507, 4825, 203, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[144735, 4833, 1492, 52, 36, "Input"],
Cell[146230, 4887, 1814, 58, 36, "Output"]
}, Open  ]],
Cell[148059, 4948, 329, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[148413, 4958, 468, 13, 32, "Input"],
Cell[148884, 4973, 3882, 126, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[152827, 5106, 115, 1, 80, "Section"],
Cell[152945, 5109, 285, 5, 55, "Input"],
Cell[153233, 5116, 186, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[153444, 5124, 591, 21, 32, "Input"],
Cell[154038, 5147, 440, 9, 32, "Output"]
}, Open  ]],
Cell[154493, 5159, 308, 7, 77, "Text"],
Cell[CellGroupData[{
Cell[154826, 5170, 622, 22, 32, "Input"],
Cell[155451, 5194, 716, 20, 32, "Output"]
}, Open  ]],
Cell[156182, 5217, 454, 9, 99, "Text"],
Cell[156639, 5228, 162, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[156826, 5235, 403, 13, 32, "Input"],
Cell[157232, 5250, 775, 21, 32, "Output"]
}, Open  ]],
Cell[158022, 5274, 177, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[158224, 5282, 378, 12, 32, "Input"],
Cell[158605, 5296, 545, 15, 32, "Output"]
}, Open  ]],
Cell[159165, 5314, 145, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[159335, 5321, 605, 16, 44, "Input"],
Cell[159943, 5339, 1032, 28, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161024, 5373, 229, 5, 80, "Section"],
Cell[161256, 5380, 398, 7, 99, "Input"],
Cell[161657, 5389, 517, 10, 99, "Text"],
Cell[162177, 5401, 411, 10, 55, "Input"],
Cell[162591, 5413, 665, 12, 121, "Text"],
Cell[163259, 5427, 25083, 728, 209, "Input"],
Cell[188345, 6157, 1409, 48, 143, "Input"],
Cell[189757, 6207, 104, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[189886, 6212, 269, 6, 32, "Input"],
Cell[190158, 6220, 9246, 309, 47, "Output"]
}, Open  ]],
Cell[199419, 6532, 205, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[199649, 6540, 3670, 110, 36, "Input"],
Cell[203322, 6652, 4456, 150, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[207827, 6808, 185, 4, 80, "Section"],
Cell[208015, 6814, 318, 6, 33, "Text"],
Cell[208336, 6822, 658, 12, 121, "Input"],
Cell[208997, 6836, 340, 7, 77, "Text"],
Cell[209340, 6845, 708, 18, 77, "Input"],
Cell[210051, 6865, 310, 6, 33, "Text"],
Cell[CellGroupData[{
Cell[210386, 6875, 484, 13, 32, "Input"],
Cell[210873, 6890, 16503, 497, 160, "Output"]
}, Open  ]],
Cell[227391, 7390, 186, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[227602, 7398, 297, 6, 32, "Input"],
Cell[227902, 7406, 2171, 66, 47, "Output"]
}, Open  ]],
Cell[230088, 7475, 180, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[230293, 7483, 1061, 29, 32, "Input"],
Cell[231357, 7514, 1150, 30, 45, "Output"]
}, Open  ]],
Cell[232522, 7547, 108, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[232655, 7552, 330, 7, 32, "Input"],
Cell[232988, 7561, 2526, 69, 57, "Output"]
}, Open  ]],
Cell[235529, 7633, 139, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[235693, 7640, 1014, 27, 32, "Input"],
Cell[236710, 7669, 1426, 43, 56, "Output"]
}, Open  ]],
Cell[238151, 7715, 198, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[238374, 7723, 435, 10, 32, "Input"],
Cell[238812, 7735, 550, 13, 38, "Output"]
}, Open  ]],
Cell[239377, 7751, 386, 9, 32, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
