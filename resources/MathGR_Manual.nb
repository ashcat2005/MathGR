(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    242826,       7963]
NotebookOptionsPosition[    235045,       7706]
NotebookOutlinePosition[    235381,       7721]
CellTagsIndexPosition[    235338,       7718]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MathGR Manual", "Title",
 CellChangeTimes->{{3.59238328321369*^9, 3.592383305878134*^9}}],

Cell["\<\
By Yi Wang, Centre for Theoretical Cosmology, DAMTP, University of Cambridge\
\>", "Text",
 CellChangeTimes->{{3.5923833667872066`*^9, 3.592383374507791*^9}, {
  3.592383436526936*^9, 3.592383450426792*^9}}],

Cell[CellGroupData[{

Cell["Tensor Calculations (tensor.m)", "Section",
 CellChangeTimes->{{3.592383538641851*^9, 3.592383551837599*^9}, {
  3.592383748315991*^9, 3.592383764615114*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/tensor.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "to", " ", "typeset", " ", "the", " ", "output"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.592383563045433*^9, 3.592383575847917*^9}, {
  3.592383775936923*^9, 3.592383803780487*^9}}],

Cell[CellGroupData[{

Cell["Tensor convention", "Subsection",
 CellChangeTimes->{{3.592383814715877*^9, 3.5923838198210506`*^9}}],

Cell["\<\
Tensors in MathGR are expressed in the form, e.g.\
\>", "Text",
 CellChangeTimes->{{3.5923836026828337`*^9, 3.592383627927*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<\[Alpha]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Beta]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Gamma]\>\""}], ",", 
   RowBox[{"UP", "@", "\"\<\[Delta]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5923836316735477`*^9, 3.59238367071555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["T",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], "", "", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP]},
      {"", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], ""}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Output",
 CellChangeTimes->{{3.592383654594595*^9, 3.592383671271758*^9}, 
   3.592384665184346*^9, 3.5923848296110573`*^9, 3.592385543683503*^9, 
   3.59255224733722*^9, 3.592552483637986*^9, 3.592566903005534*^9}]
}, Open  ]],

Cell[TextData[{
 "One can either input the tensors directly, or copy/modify the output as new \
input. Note that the indices \[OpenCurlyDoubleQuote]\[Alpha]\
\[CloseCurlyDoubleQuote], ... are defined as strings. This is not necessary \
but it prohibits the possibility that \[Alpha] is set to a value such as \
\[Alpha]=1. In the output the doube quote sign is not displayed.\n\nHere the \
UP and DN are identifieres for upper and lower indices. They are predefined \
internally as\n\nDeclareIdx[{UP, DN}, DefaultDim, GreekIdx, Black]\n\nHere \
DefaultDim is spacetime dimension, used in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[Delta]", "a"], "a"], "=", "DefaultDim"}], 
   TraditionalForm]]],
 ". GreekIdx is the default indices to use for dummy indices: {\
\[OpenCurlyDoubleQuote]\[Alpha]\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]\[Beta]\[CloseCurlyDoubleQuote], ...}. One can either \
use LatinIdx, LatinCapitalIdx, or any user-defined set of strings.\n\nBlack \
is the color to display the indices {UP, DN}. Any other ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "-defined colors can be used.\n\nOne can also define upper and lower indices \
identifiers other than {UP, DN}. For example,\n\nDeclareIdx[{U2, D2}, Dim2, \
LatinIdx, Red]\n\nMore discussions are available when indroducing decomp.m "
}], "Text",
 CellChangeTimes->{{3.592383697590067*^9, 3.592383723490519*^9}, {
  3.592383905386013*^9, 3.5923842422548513`*^9}, {3.592384319619892*^9, 
  3.592384329855151*^9}, {3.592384365359956*^9, 3.592384421433889*^9}, {
  3.592535016857683*^9, 3.592535145456586*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Einstein\[CloseCurlyQuote]s summation convention\
\>", "Subsection",
 CellChangeTimes->{{3.592547476879816*^9, 3.5925475145360126`*^9}}],

Cell[TextData[{
 "Dummy indices are considered summed. \n\nHowever, sometimes, dummy indices \
in one tensor may coincide with the dummy in another tensor. For example, ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " = ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 ", then what\[CloseCurlyQuote]s ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 "? We know it shouldn\[CloseCurlyQuote]t be\n",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " = ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " because it doesn\[CloseCurlyQuote]t make sense to have indice \[Rho] \
appear 4 times.\n\nTo make sure the above problem doesn\[CloseCurlyQuote]t \
happen, we make use of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s Unique[] function, to generate unique dummy indices. \
For example, one can define"
}], "Text",
 CellChangeTimes->{{3.592547488475833*^9, 3.592547782329068*^9}, {
  3.5925479021435432`*^9, 3.592547916818199*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\[Mu]_",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\[Nu]_",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["T1",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\[Mu]",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP], ""},
          {"", 
           TagBox[
            StyleBox["#1",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], 
     TagBox[
      RowBox[{
       AdjustmentBox["T1",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["#1",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP], ""},
          {"", 
           TagBox[
            StyleBox["\[Nu]",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}], "&"}], "@", 
   RowBox[{"Unique", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592547786507189*^9, 3.592547869063339*^9}, {
  3.5925479410810347`*^9, 3.592547952779361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592547875761746*^9, 3.592547925605997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Mu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$3",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Nu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$4",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$3",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Nu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$4",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Mu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.59254783872719*^9, {3.592547871864098*^9, 3.592547893913225*^9}, {
   3.5925479260594263`*^9, 3.592547954753255*^9}, 3.592552247434173*^9, 
   3.5925524837407093`*^9, 3.5925669030865803`*^9}]
}, Open  ]],

Cell["\<\
Now the dummy indices do not coincide.\
\>", "Text",
 CellChangeTimes->{{3.5925479995155993`*^9, 3.592548041999528*^9}, {
  3.592548400425274*^9, 3.592548404856921*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor simplification", "Subsection",
 CellChangeTimes->{{3.592534897417115*^9, 3.592534905363347*^9}}],

Cell["\<\
Simp[expr] brings tensors into a unique forms. Thus cancellation between \
tensors are manifest. For example,\
\>", "Text",
 CellChangeTimes->{{3.5925352061125193`*^9, 3.592535272052431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Mu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Lambda]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Lambda]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Nu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}], "+", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Mu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Rho]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<\[Rho]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<\[Nu]\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}]}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
  3.592535158349567*^9, 3.592535183994375*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Nu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Mu]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592534956775133*^9, 3.592534977721964*^9}, 
   3.592535185288974*^9, 3.592552247541443*^9, 3.59255248384684*^9, 
   3.592566903190234*^9}]
}, Open  ]],

Cell["\<\
In this example, dummy variables are renamed. Simp can also take care of \
tensor symmetries, as long as you define them (as below).\
\>", "Text",
 CellChangeTimes->{{3.592535285161714*^9, 3.592535351508684*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Declare tensor symmetry", "Subsection",
 CellChangeTimes->{{3.592383814715877*^9, 3.59238383651434*^9}}],

Cell["\<\
If a tensor is known to have some symmetries (or anti-symmetries), one had \
better to declare them, so that the symmetries are taken into consideration \
when doing tensor simplification. For example,\
\>", "Text",
 CellChangeTimes->{{3.592384546085244*^9, 3.592384610593562*^9}}],

Cell[BoxData[
 RowBox[{"DeclareSym", "[", 
  RowBox[{"T", ",", 
   RowBox[{"{", 
    RowBox[{"UP", ",", "DN", ",", "DN", ",", "UP"}], "}"}], ",", 
   RowBox[{"Antisymmetric", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5923838396306553`*^9, 3.5923838789715548`*^9}, {
  3.5923849367511253`*^9, 3.5923849474808197`*^9}, {3.592535493008594*^9, 
  3.5925354942764053`*^9}}],

Cell["\<\
Now MathGR can make use of the symmetry:\
\>", "Text",
 CellChangeTimes->{{3.5923846959820957`*^9, 3.592384713671777*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<\[Alpha]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<\[Delta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<\[Beta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<\[Gamma]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], "-", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<\[Alpha]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<\[Delta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<\[Gamma]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<\[Beta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"]}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592384727308025*^9, 3.5923847379444313`*^9}, {
  3.592384865716988*^9, 3.592384868883602*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.5923847384557257`*^9, 3.592384754042075*^9}, 
   3.592384829764579*^9, {3.592384866520507*^9, 3.592384869487259*^9}, 
   3.5923855441215277`*^9, 3.592552247652443*^9, 3.592552483954777*^9, 
   3.592566903273094*^9}]
}, Open  ]],

Cell[TextData[{
 "Other available symmetries include Symmetric and Cycles. Those functions \
are ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " builtin functions with manual available therein."
}], "Text",
 CellChangeTimes->{{3.592535500525838*^9, 3.59253558416088*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial derivatives", "Subsection",
 CellChangeTimes->{{3.592535477851265*^9, 3.592535481559907*^9}, 
   3.592535707711619*^9}],

Cell["\<\
Partial derivatives in MathGR is defined as\
\>", "Text",
 CellChangeTimes->{{3.592535656552045*^9, 3.592535674260539*^9}, 
   3.5925357065087233`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pd", "[", 
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<\[Alpha]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<\[Delta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<\[Beta]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<\[Gamma]\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ",", 
   RowBox[{"DN", "@", "\"\<\[Lambda]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592535622874538*^9, 3.592535640015697*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   SubscriptBox["\[CapitalSampi]", 
    TagBox[
     StyleBox["\<\"\[Lambda]\"\>",
      FontColor->GrayLevel[0]],
     MathGR`tensor`DN]], 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"]}],
  "mgrPd"]], "Output",
 CellChangeTimes->{3.5925356431472683`*^9, 3.592552247739015*^9, 
  3.592552484043466*^9, 3.592566903283193*^9}]
}, Open  ]],

Cell["\<\
Partial derivatives are linear and obeys the Leibniz rule:\
\>", "Text",
 CellChangeTimes->{{3.592535698172316*^9, 3.592535749523859*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pd", "[", 
  RowBox[{
   RowBox[{"x", "+", 
    RowBox[{"y", " ", "z"}]}], ",", 
   RowBox[{"DN", "@", "\"\<\[Alpha]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925357531868677`*^9, 3.592535766545393*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    SubscriptBox["\[CapitalSampi]", 
     TagBox[
      StyleBox["\<\"\[Alpha]\"\>",
       FontColor->GrayLevel[0]],
      MathGR`tensor`DN]], "x"}],
   "mgrPd"], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "z"}],
     "mgrPd"], ")"}]}]}]], "Output",
 CellChangeTimes->{3.5925357669684277`*^9, 3.592552247753811*^9, 
  3.5925524840575438`*^9, 3.592566903528707*^9}]
}, Open  ]],

Cell["\<\
As shown above, undeclared quantities are not assumed as constant. Rather, \
one has to define constants explicitly:\
\>", "Text",
 CellChangeTimes->{{3.592535785052247*^9, 3.592535836411697*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{"const", ",", "_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Pd", "[", 
  RowBox[{
   RowBox[{"const", "*", "x"}], ",", 
   RowBox[{"DN", "@", "\"\<\[Alpha]\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.592535837904208*^9, 3.592535866796677*^9}}],

Cell[BoxData[
 RowBox[{"const", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     SubscriptBox["\[CapitalSampi]", 
      TagBox[
       StyleBox["\<\"\[Alpha]\"\>",
        FontColor->GrayLevel[0]],
       MathGR`tensor`DN]], "x"}],
    "mgrPd"], ")"}]}]], "Output",
 CellChangeTimes->{3.592535860337606*^9, 3.592552247837673*^9, 
  3.592552484131105*^9, 3.592566903945957*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Kronecker \[Delta] symbol", "Subsection",
 CellChangeTimes->{{3.592535931013461*^9, 3.5925359577796497`*^9}}],

Cell["\<\
The Kronecker \[Delta] symbol will evaluate contraction automatically\
\>", "Text",
 CellChangeTimes->{{3.592536192699143*^9, 3.592536212260251*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["Dta",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Gamma]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592536000839815*^9, 3.5925360486091413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$9",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$9",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592536030710761*^9, 3.592536049409071*^9}, 
   3.592552247927678*^9, 3.5925524842322607`*^9, 3.592566904046266*^9}]
}, Open  ]],

Cell["\<\
If no contraction in \[Delta] is found, Dta is held to prevent searching for \
contractions all the time. This Hold[Dta] is released when Simp is called, \
where new contractions are searched for.\
\>", "Text",
 CellChangeTimes->{{3.592536290281402*^9, 3.592536366758533*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["Dta",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Delta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Gamma]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592536219664036*^9, 3.592536270423643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$10",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T1",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$10",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox[
      RowBox[{"Hold", "[", "Dta", "]"}],
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592536235469802*^9, 3.592536270877605*^9}, 
   3.592552247936401*^9, 3.592552484248513*^9, 3.592566904088455*^9}]
}, Open  ]],

Cell["\<\
This gives spacetime dimension:\
\>", "Text",
 CellChangeTimes->{{3.592536389123045*^9, 3.592536394266321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["Dta",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], ""},
      {"", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Input",
 CellChangeTimes->{{3.592536378134956*^9, 3.59253637854865*^9}}],

Cell[BoxData["DefaultDim"], "Output",
 CellChangeTimes->{3.592536379129898*^9, 3.592552248000677*^9, 
  3.592552484323791*^9, 3.592566904128502*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The generalized \[Delta] symbol", "Subsection",
 CellChangeTimes->{{3.5925364173722467`*^9, 3.5925364232924*^9}}],

Cell["\<\
The generalized \[Delta] symbol is defined as a product of \[Delta]\
\[CloseCurlyQuote]s, with lower indices perfectly antisymmetrized:\
\>", "Text",
 CellChangeTimes->{{3.592536563396202*^9, 3.592536598966343*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DtaGen", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<\[Alpha]\>\""}], ",", 
   RowBox[{"UP", "@", "\"\<\[Beta]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Mu]\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<\[Nu]\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925364331188517`*^9, 3.592536498293972*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       AdjustmentBox[
        RowBox[{"Hold", "[", "Dta", "]"}],
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {"", 
           TagBox[
            StyleBox["\<\"\[Beta]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP]},
          {
           TagBox[
            StyleBox["\<\"\[Mu]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN], ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], ")"}]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox[
       RowBox[{"Hold", "[", "Dta", "]"}],
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"\[Nu]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox[
       RowBox[{"Hold", "[", "Dta", "]"}],
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"\[Mu]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox[
       RowBox[{"Hold", "[", "Dta", "]"}],
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"\[Nu]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.592536468066381*^9, 3.592536498822962*^9}, 
   3.592552248089136*^9, 3.5925524843714733`*^9, 3.5925669041600018`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Levi-Civita symbol", "Subsection",
 CellChangeTimes->{{3.5925366489484243`*^9, 3.592536675458056*^9}, {
  3.5925367565240602`*^9, 3.59253675689246*^9}}],

Cell["\<\
If spacetime dimension is given explicitly as a number, the Levi-Civita \
symbol is defined as LeviCivita[...], which is totally anti-symmetric. A \
product ot two Levi-Civita tensors is reduced to generalized \[Delta] symbol.\
\
\>", "Text",
 CellChangeTimes->{{3.5925367343662148`*^9, 3.592536833037497*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Symmetrization or anti-symmetrization of free indices\
\>", "Subsection",
 CellChangeTimes->{{3.592536937062154*^9, 3.592536944844756*^9}, {
  3.592536977316908*^9, 3.592536979794327*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "//", "Sym"}]], "Input",
 CellChangeTimes->{{3.5925369622405787`*^9, 3.5925369739790077`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "+", 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Output",
 CellChangeTimes->{{3.592536964233883*^9, 3.592536974448186*^9}, 
   3.5925522481574783`*^9, 3.592552484448515*^9, 3.592566904171669*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "//", "Asym"}]], "Input",
 CellChangeTimes->{{3.5925369622405787`*^9, 3.5925369635711527`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "-", 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"\[Beta]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"\[Alpha]\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Output",
 CellChangeTimes->{3.592536964233883*^9, 3.592552248399541*^9, 
  3.5925524845297613`*^9, 3.5925669042067947`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["GR calculations (gr.m)", "Section",
 CellChangeTimes->{{3.5925368757140913`*^9, 3.592536880888844*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/gr.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592536994899125*^9, 3.5925369988552027`*^9}, {
  3.592563328542149*^9, 3.592563328880149*^9}}],

Cell[CellGroupData[{

Cell["GR quantities", "Subsection",
 CellChangeTimes->{{3.592547212008951*^9, 3.592547214769696*^9}}],

Cell["\<\
Quantities Affine[UP,DN,DN], R[UP,DN,DN,DN], R[DN,DN,DN,DN], R[DN,DN], R[] \
are calculated with a default metric g.\
\>", "Text",
 CellChangeTimes->{{3.5925370779739723`*^9, 3.592537093269932*^9}, {
  3.592547082198957*^9, 3.5925471288318357`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["Affine",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], "", ""},
      {"", 
       TagBox[
        StyleBox["\"\<\[Beta]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], 
       TagBox[
        StyleBox["\"\<\[Gamma]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Input",
 CellChangeTimes->{{3.5925370563040752`*^9, 3.59253705636567*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["$11",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["$11",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Beta]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Gamma]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"], ")"}]}], "+", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["$11",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], "+", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["$11",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.592537057975049*^9, 3.592552248506106*^9, 
  3.5925524848068113`*^9, 3.592566904283984*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547067850177*^9, 3.592547071015139*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Beta]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Gamma]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}]}]], "Output",
 CellChangeTimes->{3.592547071880156*^9, 3.5925522487292633`*^9, 
  3.592552485063575*^9, 3.592566904534931*^9}]
}, Open  ]],

Cell["\<\
Quantities can be calculated using alternative metric\
\>", "Text",
 CellChangeTimes->{{3.5925471843529243`*^9, 3.592547192722919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"WithMetric", "[", 
   RowBox[{"h", ",", 
    RowBox[{"R", "[", "]"}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547133961891*^9, 3.5925471362395353`*^9}, {
  3.592547167272147*^9, 3.592547172530463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[CurlyEpsilon]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[CurlyEpsilon]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Zeta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Zeta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[CurlyEpsilon]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["h",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Beta]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["h",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"\[Alpha]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"\[Gamma]\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}]}]], "Output",
 CellChangeTimes->{3.592547173228063*^9, 3.592552249008205*^9, 
  3.592552485285125*^9, 3.59256690498538*^9}]
}, Open  ]],

Cell["\<\
Quantities can be calculated in terms of, say, affine instead of metric. One \
can also define new metrics using UseMetric[metric, {upIdx, dnIdx}].\
\>", "Text",
 CellChangeTimes->{{3.592547227071014*^9, 3.592547253505663*^9}, {
  3.592548150629743*^9, 3.592548205934392*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Affine", "=", "\[CapitalGamma]"}], "}"}], ",", 
    RowBox[{"R", "[", "]"}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547255102035*^9, 3.592547268084371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalGamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], "", ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalGamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], "", ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5925472648246927`*^9, 3.592547268607706*^9}, 
   3.592552249060154*^9, 3.592552485354107*^9, 3.592566905113068*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariant derivatives", "Subsection",
 CellChangeTimes->{{3.592547378393669*^9, 3.592547381310028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CovD", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"DN", "@", "\"\<\[Alpha]\>\""}], "]"}], ",", 
    RowBox[{"DN", "@", "\"\<\[Beta]\>\""}]}], "]"}], "//", "Simp"}]], "Input",\

 CellChangeTimes->{{3.592547383447771*^9, 3.592547406346381*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    SubscriptBox["\[CapitalSampi]", 
     TagBox[
      StyleBox["\<\"\[Beta]\"\>",
       FontColor->GrayLevel[0]],
      MathGR`tensor`DN]], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}],
   "mgrPd"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5925474034058857`*^9, 3.59254740694311*^9}, 
   3.592552249129002*^9, 3.592552485420312*^9, 3.592566905308597*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric contraction", "Subsection",
 CellChangeTimes->{{3.5925474397619267`*^9, 3.592547443760118*^9}}],

Cell["\<\
One can definitely contract tensors with metric directly, such as\
\>", "Text",
 CellChangeTimes->{{3.592548116508953*^9, 3.59254812659149*^9}, {
  3.592548252221116*^9, 3.592548253245625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["g",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Alpha]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], 
        TagBox[
         StyleBox["\"\<\[Beta]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP]},
       {"", ""}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592548260558618*^9, 3.592548275768819*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{3.592548281246608*^9, 3.592552249196795*^9, 
  3.592552485438751*^9, 3.59256690540143*^9}]
}, Open  ]],

Cell["\<\
However, if there are lots of metric contractions, it is useful to introduce \
the following short hand. Here UG and DG are upper and lower indices which \
are to be contracted with metric.\
\>", "Text",
 CellChangeTimes->{{3.59254828328295*^9, 3.5925483174251413`*^9}, {
  3.592548350897723*^9, 3.592548367882963*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"DG", "@", "1"}], ",", 
     RowBox[{"DG", "@", "1"}], ",", 
     RowBox[{"UG", "@", "2"}], ",", 
     RowBox[{"UG", "@", "2"}], ",", 
     RowBox[{"DG", "@", "3"}], ",", 
     RowBox[{"DG", "@", "3"}]}], "]"}], "//", "MetricContract"}], "//", 
  "Simp"}]], "Input",
 CellChangeTimes->{{3.5925483207485228`*^9, 3.592548343651291*^9}, {
  3.5925483756902027`*^9, 3.592548379270257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[CurlyEpsilon]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Zeta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", "", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", ""},
        {
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], "", "", 
         TagBox[
          StyleBox["\<\"\[CurlyEpsilon]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Zeta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.59254833286753*^9, 3.592548344066506*^9}, 
   3.592548380063374*^9, 3.592552249428406*^9, 3.592552485520343*^9, 
   3.5925669054717073`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integration by parts (ibp.m)", "Section",
 CellChangeTimes->{{3.592548872819849*^9, 3.5925488986372433`*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "ibp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592548883231072*^9, 3.592548885423325*^9}, {
  3.592563333218902*^9, 3.5925633340647087`*^9}}],

Cell["\<\
This module tries to rewrite an expression into a total derivative, possibly \
with a rest part.\
\>", "Text",
 CellChangeTimes->{{3.592548892759857*^9, 3.592548957858235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], "+", 
   RowBox[{"y", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925491001828203`*^9, 3.592549147025807*^9}}],

Cell[BoxData[
 RowBox[{"PdHold", "[", 
  RowBox[{
   RowBox[{"x", " ", "y"}], ",", 
   RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.59254914769416*^9, 3.5925522495365133`*^9, 
  3.592552485632535*^9, 3.592566905558329*^9}]
}, Open  ]],

Cell["\<\
Here we have renamed Pd into PdHold. Otherwise Pd will automatically be \
calculated via Leibniz rule.

Note that expressions cannot always be written as total derivatives. For \
example, the following has a rest part:\
\>", "Text",
 CellChangeTimes->{{3.592549152149476*^9, 3.592549384734662*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], "+", 
   RowBox[{"2", "y", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925491001828203`*^9, 3.592549147025807*^9}, 
   3.592549318260007*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"x", " ", "y"}], ",", 
    RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.5925493186860323`*^9, 3.5925522496984177`*^9, 
  3.592552485959116*^9, 3.592566905974062*^9}]
}, Open  ]],

Cell["\<\
Also, Ibp[expr] may fail to find the total derivative even if it exists.

Sometimes one wants finer control. For example, what kind of rest part is \
considered to be simpler. In this case, one can specify the measure function \
explicitly. Here are a few examples:\
\>", "Text",
 CellChangeTimes->{{3.592549152149476*^9, 3.59254931134094*^9}, {
  3.5925493916620607`*^9, 3.592549462860622*^9}, {3.592549500998979*^9, 
  3.592549506625141*^9}}],

Cell["\<\
(1) Get rid of derivative on specified variable (y in the below example)\
\>", "Text",
 CellChangeTimes->{{3.592549515406789*^9, 3.592549539574801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], ",", 
   RowBox[{"IbpVar", "[", "y", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592549475194147*^9, 3.5925494939242697`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "y"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Alpha]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"], ")"}]}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"x", " ", "y"}], ",", 
    RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.59254948607865*^9, 3.592549494391553*^9}, 
   3.59255224984006*^9, 3.592552486132552*^9, 3.592556972679886*^9, 
   3.592566906109055*^9}]
}, Open  ]],

Cell["\<\
A more efficient version of this function (and setting boundary term to be \
zero) is\
\>", "Text",
 CellChangeTimes->{{3.592556915990922*^9, 3.5925569645030823`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IbpVariation", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.5925569388245983`*^9, 3.592556951119632*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "y"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     SubscriptBox["\[CapitalSampi]", 
      TagBox[
       StyleBox["\<\"\[Alpha]\"\>",
        FontColor->GrayLevel[0]],
       MathGR`tensor`DN]], "x"}],
    "mgrPd"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592556951526786*^9, 3.592556973943396*^9}, 
   3.592566906146654*^9}]
}, Open  ]],

Cell["\<\
(2) Rules to write second order action in standard form\
\>", "Text",
 CellChangeTimes->{{3.592549546714025*^9, 3.592549582835376*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"(", 
       OverscriptBox["\[Phi]", "\[Bullet]"], ")"}], "2"]}], "+", " ", 
    RowBox[{"\[Phi]", " ", 
     OverscriptBox["\[Phi]", "\[Bullet]\[Bullet]"]}], "+", 
    RowBox[{"m", " ", "\[Phi]", 
     OverscriptBox["\[Phi]", "\[Bullet]"]}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox["M", "2"], 
     SuperscriptBox["\[Phi]", "2"]}]}], ",", "IbpStd2"}], "]"}]], "Input",
 CellChangeTimes->{{3.592556785759036*^9, 3.592556870702876*^9}, {
  3.592557000430122*^9, 3.592557042034514*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["M", "2"], " ", 
   SuperscriptBox["\[Phi]", "2"]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Phi]", "2"], " ", 
    OverscriptBox["m", "\[Bullet]"]}], "2"], "+", 
  SuperscriptBox[
   OverscriptBox["\[Phi]", "\[Bullet]"], "2"], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"m", " ", 
      SuperscriptBox["\[Phi]", "2"]}], "2"], ",", 
    RowBox[{"DE", "[", "0", "]"}]}], "]"}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"\[Phi]", " ", 
     RowBox[{"Pd", "[", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"DE", "[", "\<\"(PdId)\"\>", "]"}]}], "]"}]}], ",", 
    RowBox[{"DE", "[", "\<\"(PdId)\"\>", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.592556871506406*^9, {3.592557007787573*^9, 3.592557042543975*^9}, 
   3.5925669062559977`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Decomposition of dimensions (decomp.m)\
\>", "Section",
 CellChangeTimes->{{3.592557249590426*^9, 3.592557252593915*^9}, {
  3.592557467915167*^9, 3.592557468950857*^9}, {3.592557507780242*^9, 
  3.592557509644903*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/gr.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/decomp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/ibp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592557441459054*^9, 3.59255745414318*^9}, {
  3.592563340824881*^9, 3.592563355889909*^9}, {3.592565088523473*^9, 
  3.592565092333067*^9}}],

Cell["\<\
In decomp.m, two additional set of indices ({UTot, DTot}, {U2, D2}), together \
with decomposition rules are defined. Here we show the usage of decomp.m by \
going through an example.

First we define metric in the total dimensions, and the \
\[OpenCurlyDoubleQuote]compactified\[CloseCurlyDoubleQuote] dimensions. The \
3+1 dim metric is pre-defined as usual, denoted by g.\
\>", "Text",
 CellChangeTimes->{{3.592557463132421*^9, 3.5925575430470743`*^9}, {
  3.5925576214368973`*^9, 3.592557679319751*^9}}],

Cell[BoxData[{
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[DoubleStruckG]", ",", 
   RowBox[{"{", 
    RowBox[{"UTot", ",", " ", "DTot"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[Gamma]", ",", 
   RowBox[{"{", 
    RowBox[{"U2", ",", "D2"}], "}"}], ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.592557441459054*^9, 3.59255745414318*^9}, 
   3.592557547534232*^9}],

Cell["\<\
Here for illustration purpose, we compactify Einstein gravity on n-torus. The \
non-compact dimensions are assumed Minkowski and the internal dimensions also \
has no curvature. There are n constant teleparallel killing vectors (denoted \
by V here) on n-torus. The off-diag components of the metric is expanded \
using this killing vector basis, with coefficients as gauge fields A.

The followings are the form of the metric and definition of their partial \
derivatives.\
\>", "Text",
 CellChangeTimes->{{3.592565424747127*^9, 3.592565484159156*^9}, {
  3.5925655974296083`*^9, 3.592565682069167*^9}, {3.592565746190011*^9, 
  3.5925657686960583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecompHook", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\[Beta]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["g",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {"", ""},
               {
                TagBox[
                 StyleBox["\[Alpha]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN], 
                TagBox[
                 StyleBox["\[Beta]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "+", 
          RowBox[{
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["\[Alpha]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["\[Beta]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#1",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#2",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["\[Gamma]",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {"", ""},
                 {
                  TagBox[
                   StyleBox["#1",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2], 
                  TagBox[
                   StyleBox["#2",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}]}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "4", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      StyleBox["\[RuleDelayed]",
       FontSize->10], 
      RowBox[{
       StyleBox["(",
        FontSize->10], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["\[Alpha]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`DN]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["V",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#1",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["\[Gamma]",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {"", ""},
                {
                 TagBox[
                  StyleBox["b",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2], 
                 TagBox[
                  StyleBox["#1",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "2", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["a_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2], 
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      TagBox[
       RowBox[{
        AdjustmentBox["\[Gamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["a",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2], 
            TagBox[
             StyleBox["b",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`D2]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], 
            TagBox[
             StyleBox["\[Beta]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\[Alpha]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], 
            TagBox[
             StyleBox["\[Beta]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], 
            TagBox[
             StyleBox["\[Alpha]_",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["g",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["\[Alpha]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP], 
                  TagBox[
                   StyleBox["#1",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP]},
                 {"", ""}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}]}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["V",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["b",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`D2]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#2",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#1",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`DN]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "2", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[DoubleStruckG]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["a_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], 
            TagBox[
             StyleBox["b_",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2]},
           {"", ""}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[Gamma]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["a",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`decomp`U2], 
                TagBox[
                 StyleBox["b",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`decomp`U2]},
               {"", ""}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "+", 
          RowBox[{
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["g",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#1",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP], 
                  TagBox[
                   StyleBox["#2",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`UP]},
                 {"", ""}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["a",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#3",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#1",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["V",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["b",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`D2]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}], " ", 
           RowBox[{"(", 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["#4",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`decomp`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["#2",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`DN]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"], ")"}]}]}], "&"}], "@", 
        RowBox[{"Uq", "[", "4", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.592563618485373*^9, 3.5925637278950777`*^9}, {
  3.592563792803883*^9, 3.592563837593978*^9}, {3.592564484015979*^9, 
  3.592564535609757*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"g", "[", "__", "]"}], ",", "_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"Pd", "[", 
      RowBox[{
       RowBox[{"g", "[", "__", "]"}], ",", "_"}], "]"}], ",", "_"}], "]"}], ":=",
    "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"A", "[", "__", "]"}], ",", "_D2"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{
     RowBox[{"Pd", "[", 
      RowBox[{
       RowBox[{"A", "[", "__", "]"}], ",", "_"}], "]"}], ",", "_D2"}], "]"}], 
   ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pd", "[", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", "__", "]"}], ",", "_"}], "]"}], ":=", "0"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{
     RowBox[{"U2", "@", "a_"}], ",", 
     RowBox[{"D2", "@", "b_"}]}], "]"}], ":=", 
   RowBox[{"Dta", "[", 
    RowBox[{
     RowBox[{"U2", "@", "a"}], ",", 
     RowBox[{"D2", "@", "b"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5925628452449293`*^9, 3.592562850285047*^9}, {
  3.592565017843031*^9, 3.592565018574593*^9}, {3.592565716957241*^9, 
  3.592565728752329*^9}}],

Cell["Now we decompose R[ ].", "Text",
 CellChangeTimes->{{3.592565784202579*^9, 3.592565807553802*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R\[Bullet]decomp", "=", 
  RowBox[{"DecompSe", "[", 
   RowBox[{
    RowBox[{"R", "[", "]"}], "//", "Simp"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.592563845504451*^9, 3.592563848330171*^9}, {
  3.5925650272364273`*^9, 3.592565061191041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Delta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Gamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Gamma]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"\[Beta]\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`decomp`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPd"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Gamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`decomp`D2]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.592564614269884*^9, {3.5925650504876013`*^9, 3.592565062311471*^9}, 
   3.59256690698011*^9}]
}, Open  ]],

Cell["\<\
To find the result in covariant form, we try to rewrite A in terms of F. The \
TrySimp utility is provided in ibp.m\
\>", "Text",
 CellChangeTimes->{{3.592565814753924*^9, 3.592565850559642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrySimp", "[", 
  RowBox[{"R\[Bullet]decomp", ",", 
   RowBox[{
    RowBox[{"a_.", "+", 
     RowBox[{"b_.", 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\[Beta]_",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], 
        TagBox[
         RowBox[{
          AdjustmentBox["A",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {
              TagBox[
               StyleBox["m_",
                FontColor->RGBColor[1, 0, 0]],
               MathGR`decomp`U2], ""},
             {"", 
              TagBox[
               StyleBox["\[Alpha]_",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPd"]}]}], "\[RuleDelayed]", 
    RowBox[{"a", "+", 
     RowBox[{"Simp", "[", 
      RowBox[{"b", 
       RowBox[{"(", 
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["F",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {
               TagBox[
                StyleBox["m",
                 FontColor->RGBColor[1, 0, 0]],
                MathGR`decomp`U2], "", ""},
              {"", 
               TagBox[
                StyleBox["\[Alpha]",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN], 
               TagBox[
                StyleBox["\[Beta]",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "+", 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\[Alpha]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["m",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`decomp`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["\[Beta]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`DN]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"]}],
          "mgrPd"]}], ")"}]}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592565067138731*^9, 3.592565134473177*^9}, {
  3.59256527458284*^9, 3.59256527691647*^9}, {3.592565368948697*^9, 
  3.592565371508411*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["F",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`decomp`U2], "", ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     SubscriptBox["\[CapitalSampi]", 
      TagBox[
       StyleBox["\<\"\[Delta]\"\>",
        FontColor->GrayLevel[0]],
       MathGR`tensor`DN]], 
     TagBox[
      RowBox[{
       AdjustmentBox["A",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`decomp`U2], ""},
          {"", 
           TagBox[
            StyleBox["\<\"\[Gamma]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}],
    "mgrPd"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["\[Gamma]",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`decomp`D2], 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`decomp`D2]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{3.59256527754312*^9, 3.592565372268806*^9, 
  3.592566907526195*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ADM decomposition of FRW universe (frwadm.m)\
\>", "Section",
 CellChangeTimes->{{3.59255725693364*^9, 3.592557271115985*^9}, {
  3.592566322322671*^9, 3.592566326371385*^9}}],

Cell["\<\
The frwadm.m is the setup for FRW universe with ADM type perturbations. Here \
we illuatrate the usage of this module by calculating second order \
cosmological perturbations.

Note that there may be a few warnings if kernel is not new. Those warnings \
come because temp variables in frwadm.m are not made local. Nevertheless \
those warnings should not cause problems.\
\>", "Text",
 CellChangeTimes->{{3.5925663283418407`*^9, 3.592566526740505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "\"\<MathGR/util.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/ibp.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/frwadm.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/typeset.m\>\""}]}], "Input",
 CellChangeTimes->{{3.592565911778283*^9, 3.592565950142881*^9}, {
   3.592566071705748*^9, 3.592566103393549*^9}, 3.592566541700692*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"a", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"a\\\"\\)\[NoBreak] appears in \
multiple contexts \[NoBreak]\\!\\({\\\"MathGR`frwadm`\\\", \
\\\"Global`\\\"}\\)\[NoBreak]; definitions in context \
\[NoBreak]\\!\\(\\\"MathGR`frwadm`\\\"\\)\[NoBreak] may shadow or be shadowed \
by other definitions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/shdw\\\", ButtonNote -> \
\\\"MathGR`frwadm`a::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.59256690780935*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"\[Alpha]", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"\\\\[Alpha]\\\"\\)\[NoBreak] \
appears in multiple contexts \[NoBreak]\\!\\({\\\"MathGR`frwadm`\\\", \
\\\"Global`\\\"}\\)\[NoBreak]; definitions in context \
\[NoBreak]\\!\\(\\\"MathGR`frwadm`\\\"\\)\[NoBreak] may shadow or be shadowed \
by other definitions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/shdw\\\", ButtonNote -> \
\\\"MathGR`frwadm`\[Alpha]::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.592566907900854*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"\[Beta]", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"\\\\[Beta]\\\"\\)\[NoBreak] \
appears in multiple contexts \[NoBreak]\\!\\({\\\"MathGR`frwadm`\\\", \
\\\"Global`\\\"}\\)\[NoBreak]; definitions in context \
\[NoBreak]\\!\\(\\\"MathGR`frwadm`\\\"\\)\[NoBreak] may shadow or be shadowed \
by other definitions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/shdw\\\", ButtonNote -> \
\\\"MathGR`frwadm`\[Beta]::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.592566907990961*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"b", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"b\\\"\\)\[NoBreak] appears in \
multiple contexts \[NoBreak]\\!\\({\\\"MathGR`frwadm`\\\", \
\\\"Global`\\\"}\\)\[NoBreak]; definitions in context \
\[NoBreak]\\!\\(\\\"MathGR`frwadm`\\\"\\)\[NoBreak] may shadow or be shadowed \
by other definitions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/shdw\\\", ButtonNote -> \
\\\"MathGR`frwadm`b::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5925669080786667`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"h", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"h\\\"\\)\[NoBreak] appears in \
multiple contexts \[NoBreak]\\!\\({\\\"MathGR`frwadm`\\\", \
\\\"Global`\\\"}\\)\[NoBreak]; definitions in context \
\[NoBreak]\\!\\(\\\"MathGR`frwadm`\\\"\\)\[NoBreak] may shadow or be shadowed \
by other definitions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/shdw\\\", ButtonNote -> \
\\\"MathGR`frwadm`h::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.592566908178864*^9}]
}, Open  ]],

Cell["\<\
Here we define the indices explicitly, because we want to use LatinIdx \
instead of GreekIdx for 3 spatial dimensions. 

We neglect boundary terms. Also \[Phi] is set to be homogeneous and isotropic \
(i.e. the calculation is done in \[Zeta]-gauge). \
\>", "Text",
 CellChangeTimes->{{3.592566547259996*^9, 3.592566620248598*^9}}],

Cell[BoxData[{
 RowBox[{"DeclareIdx", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"UP", ",", "DN"}], "}"}], ",", "DefaultDim", ",", "LatinIdx", ",",
    "Black"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PdHold", "[", "__", "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pd", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "|", 
     RowBox[{"Pd", "[", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"DE", "@", "0"}]}], "]"}]}], ",", 
    RowBox[{"DN", "@", "_"}]}], "]"}], ":=", "0"}]}], "Input",
 CellChangeTimes->{{3.592565911778283*^9, 3.592565950142881*^9}, {
   3.592566071705748*^9, 3.592566103393549*^9}, 3.592566541700692*^9}],

Cell["\<\
The action is calculated using the ADM curvature, and the decomposed scalar \
field. DecompG2H is a helper function to decompose 3+1 dimensional quantities \
into 3 and 1.\
\>", "Text",
 CellChangeTimes->{{3.592566633154161*^9, 3.592566633519821*^9}, {
  3.592566666147599*^9, 3.592566722486635*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s012", "=", 
  RowBox[{
   RowBox[{"Sqrtg", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"RADM", "[", "]"}], "/", "2"}], "+", 
      RowBox[{"DecompG2H", "[", 
       RowBox[{"X", "[", "\[Phi]", "]"}], "]"}], "-", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], ")"}]}], "//", 
   RowBox[{"SS", "[", "2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592565970960834*^9, 3.59256597896949*^9}, {
  3.5925660621883097`*^9, 3.592566079499516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "Eps", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Zeta]"}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["a", "3"], " ", "H", " ", 
      OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
     RowBox[{
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{"4", " ", "a", " ", "H", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         SubscriptBox["\[CapitalSampi]", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]], 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], "\[Beta]"}],
          "mgrPd"]}],
        "mgrPd"], ")"}]}], "-", 
     RowBox[{"4", " ", "a", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         SubscriptBox["\[CapitalSampi]", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]], 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], "\[Zeta]"}],
          "mgrPd"]}],
        "mgrPd"], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", "a", " ", "\[ExponentialE]"}]], 
   RowBox[{
    SuperscriptBox["Eps", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "12"}], " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["H", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"]}], "+", 
      RowBox[{"36", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["H", "2"], " ", "\[Alpha]", " ", "\[Zeta]"}], "-", 
      RowBox[{"54", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["H", "2"], " ", 
       SuperscriptBox["\[Zeta]", "2"]}], "+", 
      RowBox[{"24", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Alpha]", " ", 
       OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
      RowBox[{"72", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Zeta]", " ", 
       OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox[
        OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          AdjustmentBox["b",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {""},
             {
              TagBox[
               StyleBox["\<\"a\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], "\[Zeta]"}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], "\[Beta]"}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], "\[Zeta]"}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], "\[Zeta]"}],
          "mgrPd"], ")"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "\[Alpha]", " ",
        "\[Zeta]", " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["\[Zeta]", "2"], " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}], "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Alpha]", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "H", " ", 
       "\[Zeta]", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", 
       OverscriptBox["\[Zeta]", "\[Bullet]"], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         TagBox[
          RowBox[{
           SubscriptBox["\[CapitalSampi]", 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]], 
           TagBox[
            RowBox[{
             SubscriptBox["\[CapitalSampi]", 
              TagBox[
               StyleBox["\<\"a\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]], "\[Beta]"}],
            "mgrPd"]}],
          "mgrPd"], ")"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"b\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Beta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Zeta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", "\[ExponentialE]", " ", "\[Zeta]", " ", 
       
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]], 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]], "\[Zeta]"}],
           "mgrPd"]}],
         "mgrPd"], ")"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", "\[Alpha]", " ",
        "\[Zeta]", " ", 
       RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{"18", " ", 
       SuperscriptBox["a", "4"], " ", "\[ExponentialE]", " ", 
       SuperscriptBox["\[Zeta]", "2"], " ", 
       RowBox[{"V", "[", "\[Phi]", "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.59256607655898*^9, 3.592566107542033*^9, 
  3.5925662383004627`*^9, 3.592566910169251*^9}]
}, Open  ]],

Cell["\<\
The first order action. Here OO[n] is defined in util.m, which collect order \
n terms w.r.t. Eps\
\>", "Text",
 CellChangeTimes->{{3.59256673780443*^9, 3.592566775771201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s1", "=", 
  RowBox[{"s012", "//", 
   RowBox[{"OO", "[", "1", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566089724766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Alpha]"}], "-", 
  RowBox[{"9", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Zeta]"}], "-", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
  RowBox[{
   FractionBox["3", "2"], " ", 
   SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
  RowBox[{"2", " ", "a", " ", "H", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"a\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], "\[Beta]"}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\<\"a\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], 
      TagBox[
       RowBox[{
        SubscriptBox["\[CapitalSampi]", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]], "\[Zeta]"}],
       "mgrPd"]}],
     "mgrPd"], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.5925660911681967`*^9, 3.592566111248671*^9}, 
   3.592566240943439*^9, 3.592566910527968*^9}]
}, Open  ]],

Cell["\<\
The background EoM is solved (by varying the 1st order action) and added into \
SimpHook.\
\>", "Text",
 CellChangeTimes->{{3.59256679734159*^9, 3.5925668247144623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpHook", "=", 
  RowBox[{"SimpHook", "~", "Union", "~", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SolveExpr", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"s1", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"IbpVariation", "[", 
             RowBox[{"s1", ",", "\[Zeta]"}], "]"}], ",", "\[Zeta]"}], "]"}], 
          "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "[", "\[Phi]", "]"}], ",", 
         RowBox[{
          RowBox[{"Pd", "[", 
           RowBox[{"\[Phi]", ",", 
            RowBox[{"DE", "@", "0"}]}], "]"}], "^", "2"}]}], "}"}]}], "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.5925661896593227`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DefaultDim", "\[Rule]", "3"}], ",", 
   RowBox[{
    OverscriptBox["a", "\[Bullet]"], "\[Rule]", 
    RowBox[{"a", " ", "H"}]}], ",", 
   RowBox[{
    OverscriptBox["H", "\[Bullet]"], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["H", "2"]}], " ", "\[Epsilon]"}]}], ",", 
   RowBox[{
    OverscriptBox["\[Epsilon]", "\[Bullet]"], "\[Rule]", 
    RowBox[{"H", " ", "\[Epsilon]", " ", "\[Eta]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["\[Phi]", "\[Bullet]"], "2"], "\[Rule]", 
    RowBox[{"2", " ", 
     SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}], ",", 
   RowBox[{
    RowBox[{"V", "[", "\[Phi]", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["H", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5925661330107822`*^9, 3.5925662430249662`*^9}, 
   3.592566910606022*^9}]
}, Open  ]],

Cell["The second order action.", "Text",
 CellChangeTimes->{{3.592566834006785*^9, 3.5925668382864532`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2", "=", 
  RowBox[{
   RowBox[{"s012", "//", 
    RowBox[{"OO", "[", "2", "]"}]}], "//", "Fourier2"}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566131041789*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"]}], "+", 
  RowBox[{"2", " ", "a", " ", "H", " ", 
   SuperscriptBox["k", "2"], " ", "\[Alpha]", " ", "\[Beta]"}], "+", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Epsilon]"}], "+", 
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["k", "2"], " ", "\[Alpha]", " ", "\[Zeta]"}], "-", 
  RowBox[{"27", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{"a", " ", 
   SuperscriptBox["k", "2"], " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Epsilon]", " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["k", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{
        AdjustmentBox["b",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], ")"}], "2"]}], 
   RowBox[{"4", " ", "a", " ", "\[ExponentialE]"}]], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", "\[Alpha]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["k", "2"], " ", "\[Beta]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"18", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", "\[Zeta]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox[
    OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}]}]], "Output",
 CellChangeTimes->{3.5925662466214867`*^9, 3.5925669107414913`*^9}]
}, Open  ]],

Cell["\<\
Solving constraints in the second order action.\
\>", "Text",
 CellChangeTimes->{{3.5925668477139378`*^9, 3.592566858279282*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solCons", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", "\[Beta]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", 
          RowBox[{"b", "[", 
           RowBox[{"DN", "@", "\"\<a\>\""}], "]"}]}], "]"}], "\[Equal]", 
        "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
       RowBox[{"b", "[", 
        RowBox[{"DN", "@", "\"\<a\>\""}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566117708316*^9}, {3.592566252107847*^9, 
   3.592566254434847*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     OverscriptBox["\[Zeta]", "\[Bullet]"], "H"]}], ",", 
   RowBox[{"\[Beta]", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["k", "2"], " ", "\[Zeta]"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "H", " ", "\[Epsilon]", " ", 
        OverscriptBox["\[Zeta]", "\[Bullet]"]}]}], 
      RowBox[{"H", " ", 
       SuperscriptBox["k", "2"]}]]}]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["b",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.592566255651764*^9, 3.5925669108105917`*^9}]
}, Open  ]],

Cell["\<\
Inserting the solved constraints, and do integration by parts, we get the \
desired second order action.\
\>", "Text",
 CellChangeTimes->{{3.5925668657837667`*^9, 3.5925668890597563`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2Solved", "=", 
  RowBox[{
   RowBox[{"s2", "/.", "solCons"}], "//", 
   RowBox[{
    RowBox[{"Ibp", "[", 
     RowBox[{"#", ",", "IbpStd2"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566117708316*^9}, {3.592566252107847*^9, 
   3.592566260591505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "a"}], " ", 
   SuperscriptBox["k", "2"], " ", "\[Epsilon]", " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", "\[Epsilon]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}]}]], "Output",
 CellChangeTimes->{3.5925662626264563`*^9, 3.592566911054432*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1366, 748},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 95, 1, 92, "Title"],
Cell[677, 25, 217, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[919, 33, 164, 2, 80, "Section"],
Cell[1086, 37, 372, 8, 55, "Input"],
Cell[CellGroupData[{
Cell[1483, 49, 107, 1, 44, "Subsection"],
Cell[1593, 52, 138, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[1756, 59, 323, 7, 32, "Input"],
Cell[2082, 68, 1139, 36, 36, "Output"]
}, Open  ]],
Cell[3236, 107, 1632, 29, 345, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4905, 141, 146, 3, 44, "Subsection"],
Cell[5054, 146, 9897, 324, 158, "Text"],
Cell[14954, 472, 2416, 82, 36, "Input"],
Cell[CellGroupData[{
Cell[17395, 558, 1482, 52, 36, "Input"],
Cell[18880, 612, 3182, 109, 36, "Output"]
}, Open  ]],
Cell[22077, 724, 179, 4, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22293, 733, 109, 1, 44, "Subsection"],
Cell[22405, 736, 201, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[22631, 744, 3226, 110, 36, "Input"],
Cell[25860, 856, 3197, 108, 36, "Output"]
}, Open  ]],
Cell[29072, 967, 222, 4, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29331, 976, 110, 1, 44, "Subsection"],
Cell[29444, 979, 291, 5, 49, "Text"],
Cell[29738, 986, 435, 10, 32, "Input"],
Cell[30176, 998, 132, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[30333, 1005, 2133, 70, 36, "Input"],
Cell[32469, 1077, 1281, 39, 36, "Output"]
}, Open  ]],
Cell[33765, 1119, 278, 7, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34080, 1131, 133, 2, 44, "Subsection"],
Cell[34216, 1135, 161, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[34402, 1143, 1155, 37, 36, "Input"],
Cell[35560, 1182, 1286, 43, 36, "Output"]
}, Open  ]],
Cell[36861, 1228, 148, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[37034, 1235, 235, 6, 32, "Input"],
Cell[37272, 1243, 847, 31, 32, "Output"]
}, Open  ]],
Cell[38134, 1277, 206, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[38365, 1285, 345, 10, 55, "Input"],
Cell[38713, 1297, 378, 12, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39140, 1315, 119, 1, 44, "Subsection"],
Cell[39262, 1318, 159, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[39446, 1325, 1496, 52, 36, "Input"],
Cell[40945, 1379, 1642, 55, 36, "Output"]
}, Open  ]],
Cell[42602, 1437, 286, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[42913, 1446, 1495, 52, 36, "Input"],
Cell[44411, 1500, 2428, 82, 36, "Output"]
}, Open  ]],
Cell[46854, 1585, 121, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[47000, 1592, 761, 26, 36, "Input"],
Cell[47764, 1620, 148, 2, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47961, 1628, 119, 1, 44, "Subsection"],
Cell[48083, 1631, 225, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[48333, 1639, 323, 7, 32, "Input"],
Cell[48659, 1648, 3517, 117, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52225, 1771, 162, 2, 44, "Subsection"],
Cell[52390, 1775, 320, 6, 51, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52747, 1786, 198, 4, 44, "Subsection"],
Cell[CellGroupData[{
Cell[52970, 1794, 813, 27, 36, "Input"],
Cell[53786, 1823, 1570, 53, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55393, 1881, 814, 27, 36, "Input"],
Cell[56210, 1910, 1547, 53, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[57818, 1970, 109, 1, 50, "Section"],
Cell[57930, 1973, 235, 4, 55, "Input"],
Cell[CellGroupData[{
Cell[58190, 1981, 101, 1, 44, "Subsection"],
Cell[58294, 1984, 259, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[58578, 1993, 884, 30, 36, "Input"],
Cell[59465, 2025, 4018, 133, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63520, 2163, 142, 3, 32, "Input"],
Cell[63665, 2168, 28145, 950, 84, "Output"]
}, Open  ]],
Cell[91825, 3121, 145, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[91995, 3128, 256, 6, 32, "Input"],
Cell[92254, 3136, 28142, 950, 84, "Output"]
}, Open  ]],
Cell[120411, 4089, 286, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[120722, 4098, 270, 7, 32, "Input"],
Cell[120995, 4107, 9442, 315, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130486, 4428, 109, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[130620, 4433, 288, 8, 32, "Input"],
Cell[130911, 4443, 8513, 291, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139473, 4740, 108, 1, 44, "Subsection"],
Cell[139584, 4743, 203, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[139812, 4751, 1492, 52, 36, "Input"],
Cell[141307, 4805, 1638, 55, 36, "Output"]
}, Open  ]],
Cell[142960, 4863, 329, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[143314, 4873, 468, 13, 32, "Input"],
Cell[143785, 4888, 3711, 124, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[147557, 5019, 115, 1, 50, "Section"],
Cell[147675, 5022, 229, 4, 55, "Input"],
Cell[147907, 5028, 186, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[148118, 5036, 591, 21, 32, "Input"],
Cell[148712, 5059, 264, 6, 32, "Output"]
}, Open  ]],
Cell[148991, 5068, 308, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[149324, 5079, 622, 22, 32, "Input"],
Cell[149949, 5103, 538, 17, 32, "Output"]
}, Open  ]],
Cell[150502, 5123, 454, 9, 68, "Text"],
Cell[150959, 5134, 162, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[151146, 5141, 403, 13, 32, "Input"],
Cell[151552, 5156, 602, 19, 32, "Output"]
}, Open  ]],
Cell[152169, 5178, 177, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[152371, 5186, 378, 12, 32, "Input"],
Cell[152752, 5200, 373, 13, 32, "Output"]
}, Open  ]],
Cell[153140, 5216, 145, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[153310, 5223, 605, 16, 44, "Input"],
Cell[153918, 5241, 859, 26, 52, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[154826, 5273, 229, 5, 50, "Section"],
Cell[155058, 5280, 398, 7, 99, "Input"],
Cell[155459, 5289, 517, 10, 70, "Text"],
Cell[155979, 5301, 411, 10, 55, "Input"],
Cell[156393, 5313, 665, 12, 90, "Text"],
Cell[157061, 5327, 25083, 728, 209, "Input"],
Cell[182147, 6057, 1409, 48, 143, "Input"],
Cell[183559, 6107, 104, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[183688, 6112, 269, 6, 32, "Input"],
Cell[183960, 6120, 9070, 307, 47, "Output"]
}, Open  ]],
Cell[193045, 6430, 205, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[193275, 6438, 3670, 110, 36, "Input"],
Cell[196948, 6550, 4282, 147, 47, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[201279, 6703, 185, 4, 50, "Section"],
Cell[201467, 6709, 462, 9, 90, "Text"],
Cell[CellGroupData[{
Cell[201954, 6722, 407, 6, 99, "Input"],
Cell[202364, 6730, 658, 13, 23, "Message"],
Cell[203025, 6745, 683, 13, 23, "Message"],
Cell[203711, 6760, 680, 13, 23, "Message"],
Cell[204394, 6775, 661, 13, 23, "Message"],
Cell[205058, 6790, 659, 13, 23, "Message"]
}, Open  ]],
Cell[205732, 6806, 340, 7, 70, "Text"],
Cell[206075, 6815, 659, 17, 77, "Input"],
Cell[206737, 6834, 310, 6, 31, "Text"],
Cell[CellGroupData[{
Cell[207072, 6844, 484, 13, 32, "Input"],
Cell[207559, 6859, 16331, 494, 197, "Output"]
}, Open  ]],
Cell[223905, 7356, 186, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[224116, 7364, 297, 6, 32, "Input"],
Cell[224416, 7372, 1999, 64, 47, "Output"]
}, Open  ]],
Cell[226430, 7439, 180, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[226635, 7447, 1061, 29, 32, "Input"],
Cell[227699, 7478, 976, 28, 45, "Output"]
}, Open  ]],
Cell[228690, 7509, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[228823, 7514, 330, 7, 32, "Input"],
Cell[229156, 7523, 2352, 66, 57, "Output"]
}, Open  ]],
Cell[231523, 7592, 139, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[231687, 7599, 1014, 27, 32, "Input"],
Cell[232704, 7628, 1251, 40, 56, "Output"]
}, Open  ]],
Cell[233970, 7671, 198, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[234193, 7679, 435, 10, 32, "Input"],
Cell[234631, 7691, 374, 10, 38, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
