(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    334474,      10317]
NotebookOptionsPosition[    295900,       9295]
NotebookOutlinePosition[    326697,      10061]
CellTagsIndexPosition[    326654,      10058]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MathGR Manual", "Title",
 CellChangeTimes->{{3.59238328321369*^9, 3.592383305878134*^9}}],

Cell["\<\
By Yi Wang, Centre for Theoretical Cosmology, DAMTP, University of Cambridge

You are welcome to report bug at https://github.com/tririver/MathGR/issues 

On the other hand, as part of GPLv3, the author has no responsibility for \
(though tries hard to achieve) the correctness of the code. If you use this \
package in your research, please do check the result using independent \
methods.\
\>", "Text",
 CellChangeTimes->{{3.5923833667872066`*^9, 3.592383374507791*^9}, {
   3.592383436526936*^9, 3.592383450426792*^9}, {3.592621662224024*^9, 
   3.592621663630933*^9}, {3.592621853994488*^9, 3.592621928421978*^9}, {
   3.592622007090208*^9, 3.592622009992198*^9}, {3.592622191808166*^9, 
   3.5926222773980503`*^9}, 3.592622313043351*^9, {3.5926242057213707`*^9, 
   3.59262420661043*^9}, {3.597390634879059*^9, 3.597390653094648*^9}}],

Cell[CellGroupData[{

Cell["Tensor Calculations (tensor.m)", "Section",
 CellChangeTimes->{{3.592383538641851*^9, 3.592383551837599*^9}, {
  3.592383748315991*^9, 3.592383764615114*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/tensor.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "to", " ", "typeset", " ", "the", " ", "output"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.592383563045433*^9, 3.592383575847917*^9}, {
  3.592383775936923*^9, 3.592383803780487*^9}}],

Cell[CellGroupData[{

Cell["Tensor convention", "Subsection",
 CellChangeTimes->{{3.592383814715877*^9, 3.5923838198210506`*^9}}],

Cell["\<\
Tensors in MathGR are expressed in the form, e.g.\
\>", "Text",
 CellChangeTimes->{{3.5923836026828337`*^9, 3.592383627927*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<a\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<b\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<c\>\""}], ",", 
   RowBox[{"UP", "@", "\"\<d\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5923836316735477`*^9, 3.59238367071555*^9}, {
  3.597390456778077*^9, 3.597390462114779*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["T",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\<\"a\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], "", "", 
       TagBox[
        StyleBox["\<\"d\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP]},
      {"", 
       TagBox[
        StyleBox["\<\"b\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], 
       TagBox[
        StyleBox["\<\"c\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], ""}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Output",
 CellChangeTimes->{{3.592383654594595*^9, 3.592383671271758*^9}, 
   3.592384665184346*^9, 3.5923848296110573`*^9, 3.592385543683503*^9, 
   3.59255224733722*^9, 3.592552483637986*^9, 3.592566903005534*^9, {
   3.5926233045092907`*^9, 3.592623325905444*^9}, {3.59262338491138*^9, 
   3.592623396618031*^9}, {3.592623442684757*^9, 3.5926234498436527`*^9}, 
   3.596958897190613*^9, 3.597390426412369*^9, 3.597390462651232*^9, 
   3.5973909826840754`*^9, 3.598258946533245*^9, 3.598263629261134*^9, 
   3.5987612289671*^9, 3.598852363959268*^9, 3.5988524375661793`*^9, 
   3.598852578668488*^9, 3.598870364755516*^9, 3.598897609873796*^9, 
   3.598942713715208*^9, 3.6082085694723454`*^9, 3.608208648245428*^9, 
   3.608209043063024*^9, 3.608209118969833*^9}]
}, Open  ]],

Cell[TextData[{
 "One can either input the tensors directly, or copy/modify the output as new \
input. \n\nWhen copying the tensor into input, please do pay attention that \
there are some invisible bound boxes thus please do copy the largest possible \
selection. Also it is helpful to test the copy-paste. Hopefully this \
inconvenience will be fixed after the package is updated to ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10. Also, this issue only affects the typeset form. The input form T[UP@\
\[CloseCurlyDoubleQuote]a\[CloseCurlyDoubleQuote],DN@\[CloseCurlyDoubleQuote]\
b\[CloseCurlyDoubleQuote],DN@\[CloseCurlyDoubleQuote]c\[CloseCurlyDoubleQuote]\
,UP@\[CloseCurlyDoubleQuote]d\[CloseCurlyDoubleQuote] has everything \
explicit, and is free from this problem.\n\nNote that the indices \
\[OpenCurlyDoubleQuote]a\[CloseCurlyDoubleQuote], ... are defined as strings. \
This is not necessary but it prohibits the possibility that \[Alpha] is set \
to a value such as a=1. In the output the doube quote sign is not displayed.\n\
\nHere the UP and DN are identifieres for upper and lower indices. They are \
predefined internally as\n\nDeclareIdx[{UP, DN}, DefaultDim, GreekIdx, Black]\
\n\nHere DefaultDim is spacetime dimension, used in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[Delta]", "a"], "a"], "=", "DefaultDim"}], 
   TraditionalForm]]],
 ". GreekIdx is the default indices to use for dummy indices: {\
\[OpenCurlyDoubleQuote]\[Alpha]\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]\[Beta]\[CloseCurlyDoubleQuote], ...}. One can either \
use LatinIdx, LatinCapitalIdx, or any user-defined set of strings.\n\nBlack \
is the color to display the indices {UP, DN}. Any other ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "-defined colors can be used.\n\nOne can also define upper and lower indices \
identifiers other than {UP, DN}. For example,\n\nDeclareIdx[{U2, D2}, Dim2, \
LatinIdx, Red]\n\nMore discussions are available when indroducing decomp.m "
}], "Text",
 CellChangeTimes->{{3.592383697590067*^9, 3.592383723490519*^9}, {
  3.592383905386013*^9, 3.5923842422548513`*^9}, {3.592384319619892*^9, 
  3.592384329855151*^9}, {3.592384365359956*^9, 3.592384421433889*^9}, {
  3.592535016857683*^9, 3.592535145456586*^9}, {3.5926223446990547`*^9, 
  3.592622569368891*^9}, {3.592622612834042*^9, 3.5926226234970016`*^9}, {
  3.592622864479847*^9, 3.592622918209013*^9}, {3.597390551394449*^9, 
  3.597390595038123*^9}, {3.597390697726178*^9, 3.597390736407987*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Einstein\[CloseCurlyQuote]s summation convention\
\>", "Subsection",
 CellChangeTimes->{{3.592547476879816*^9, 3.5925475145360126`*^9}}],

Cell[TextData[{
 "Dummy indices are considered summed. \n\nHowever, sometimes, dummy indices \
in one tensor may coincide with the dummy in another tensor. For example, ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " = ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 ", then what\[CloseCurlyQuote]s ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 "? We know it shouldn\[CloseCurlyQuote]t be\n",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " = ",
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Nu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 Cell[BoxData[
  TagBox[
   RowBox[{
    AdjustmentBox["T1",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<\[Rho]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<\[Mu]\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]], "Input",
  CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
   3.592535158349567*^9, 3.592535183994375*^9}}],
 " because it doesn\[CloseCurlyQuote]t make sense to have indice \[Rho] \
appear 4 times.\n\nTo make sure the above problem doesn\[CloseCurlyQuote]t \
happen, we make use of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s Unique[] function, to generate unique dummy indices. \
For example, one can define"
}], "Text",
 CellChangeTimes->{{3.592547488475833*^9, 3.592547782329068*^9}, {
  3.5925479021435432`*^9, 3.592547916818199*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T1", "[", 
   RowBox[{
    RowBox[{"UP", "@", "m_"}], ",", 
    RowBox[{"DN", "@", "n_"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"UP", "@", "m"}], ",", 
       RowBox[{"DN", "@", "#1"}]}], "]"}], 
     RowBox[{"T", "[", 
      RowBox[{
       RowBox[{"UP", "@", "#1"}], ",", 
       RowBox[{"DN", "@", "n"}]}], "]"}]}], "&"}], "@", 
   RowBox[{"Unique", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.597390845246422*^9, 3.597390896295413*^9}, 
   3.597390965176517*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T1", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<a\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<b\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5973909278591948`*^9, 3.5973909681072483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["$104",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["$104",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.5973909580877247`*^9, 3.597390988579556*^9}, 
   3.598258954540825*^9, 3.598263629277958*^9, 3.598761238200927*^9, 
   3.598852363990242*^9, 3.598852437599885*^9, 3.598852578735867*^9, 
   3.59887036477136*^9, 3.598897609893539*^9, 3.598942713732213*^9, 
   3.608208569688239*^9, 3.608208648295165*^9, 3.608209043094305*^9, 
   3.608209119020031*^9}]
}, Open  ]],

Cell["\<\
Now the dummy indices do not coincide. For multiple dummy indices, Uq[n] is \
defined, such that ...&@Uq[3] is equivalent to ...&[Unique[ ], Unique[ ], \
Unique[ ]].\
\>", "Text",
 CellChangeTimes->{{3.5925479995155993`*^9, 3.592548041999528*^9}, {
  3.592548400425274*^9, 3.592548404856921*^9}, {3.592623066900333*^9, 
  3.592623139252087*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor simplification", "Subsection",
 CellChangeTimes->{{3.592534897417115*^9, 3.592534905363347*^9}}],

Cell["\<\
Simp[expr] brings tensors into a unique forms. Thus cancellation between \
tensors are manifest. For example,\
\>", "Text",
 CellChangeTimes->{{3.5925352061125193`*^9, 3.592535272052431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<m\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<l\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<l\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<n\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}], "+", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<m\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<r\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\"\<r\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], ""},
         {"", 
          TagBox[
           StyleBox["\"\<n\>\"",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}]}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592534924696567*^9, 3.59253498255129*^9}, {
  3.592535158349567*^9, 3.592535183994375*^9}, {3.592623478238757*^9, 
  3.592623480897429*^9}, {3.597391002764501*^9, 3.5973910203660727`*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"n\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"m\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592534956775133*^9, 3.592534977721964*^9}, 
   3.592535185288974*^9, 3.592552247541443*^9, 3.59255248384684*^9, 
   3.592566903190234*^9, {3.592623304737172*^9, 3.59262332623808*^9}, {
   3.5926233851942863`*^9, 3.592623397201036*^9}, {3.592623442812731*^9, 
   3.592623450002203*^9}, 3.5969589088248377`*^9, 3.5973904372146*^9, 
   3.597391020892139*^9, 3.598258959231984*^9, 3.598263629311452*^9, 
   3.598761239551923*^9, 3.598852364030423*^9, 3.59885243764329*^9, 
   3.5988525787815332`*^9, 3.598870364801642*^9, 3.5988976099261703`*^9, 
   3.598942713764304*^9, 3.608208569713068*^9, 3.608208648345456*^9, 
   3.608209043131768*^9, 3.608209119073906*^9}]
}, Open  ]],

Cell["\<\
In this example, dummy variables are renamed. Simp can also take care of \
tensor symmetries, as long as you define them (as below).\
\>", "Text",
 CellChangeTimes->{{3.592535285161714*^9, 3.592535351508684*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Declare tensor symmetry", "Subsection",
 CellChangeTimes->{{3.592383814715877*^9, 3.59238383651434*^9}}],

Cell["\<\
If a tensor is known to have some symmetries (or anti-symmetries), one had \
better to declare them, so that the symmetries are taken into consideration \
when doing tensor simplification. For example,\
\>", "Text",
 CellChangeTimes->{{3.592384546085244*^9, 3.592384610593562*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeclareSym", "[", 
  RowBox[{"T", ",", 
   RowBox[{"{", 
    RowBox[{"UP", ",", "DN", ",", "DN", ",", "UP"}], "}"}], ",", 
   RowBox[{"Antisymmetric", "[", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5923838396306553`*^9, 3.5923838789715548`*^9}, {
  3.5923849367511253`*^9, 3.5923849474808197`*^9}, {3.592535493008594*^9, 
  3.5925354942764053`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Antisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.608208569730959*^9, 3.608208648382534*^9, 
  3.608209043160068*^9, 3.608209119129592*^9}]
}, Open  ]],

Cell["\<\
Now MathGR can make use of the symmetry:\
\>", "Text",
 CellChangeTimes->{{3.5923846959820957`*^9, 3.592384713671777*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<a\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<d\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<b\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<c\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], "-", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<a\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<d\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<c\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<b\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"]}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592384727308025*^9, 3.5923847379444313`*^9}, {
  3.592384865716988*^9, 3.592384868883602*^9}, {3.597391032023611*^9, 
  3.597391056110999*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\<\"d\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"c\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.5923847384557257`*^9, 3.592384754042075*^9}, 
   3.592384829764579*^9, {3.592384866520507*^9, 3.592384869487259*^9}, 
   3.5923855441215277`*^9, 3.592552247652443*^9, 3.592552483954777*^9, 
   3.592566903273094*^9, {3.592623304831995*^9, 3.592623326575317*^9}, {
   3.592623385270816*^9, 3.592623397340296*^9}, {3.592623442884169*^9, 
   3.592623450099037*^9}, 3.59695891310843*^9, {3.597391056576263*^9, 
   3.597391060401595*^9}, 3.598258963620727*^9, 3.598263629337042*^9, 
   3.598761243215576*^9, 3.598852364065981*^9, 3.598852437685389*^9, 
   3.5988525788186827`*^9, 3.598870364843792*^9, 3.598897609950099*^9, 
   3.59894271379018*^9, 3.608208569753915*^9, 3.608208648429751*^9, 
   3.60820904320301*^9, 3.608209119191627*^9}]
}, Open  ]],

Cell[TextData[{
 "Other available symmetries include Symmetric and Cycles. Those functions \
are ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " builtin functions with manual available therein."
}], "Text",
 CellChangeTimes->{{3.592535500525838*^9, 3.59253558416088*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial derivatives", "Subsection",
 CellChangeTimes->{{3.592535477851265*^9, 3.592535481559907*^9}, 
   3.592535707711619*^9}],

Cell["Partial derivatives in MathGR is defined as", "Text",
 CellChangeTimes->{{3.592535656552045*^9, 3.592535674260539*^9}, 
   3.5925357065087233`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pd", "[", 
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\"\<a\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\"\<d\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\"\<b\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\"\<c\>\"",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ",", 
   RowBox[{"DN", "@", "\"\<e\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592535622874538*^9, 3.592535640015697*^9}, {
  3.597391077637965*^9, 3.5973910934315977`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   TagBox[
    RowBox[{
     AdjustmentBox["\[CapitalSampi]",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {""},
        {
         TagBox[
          StyleBox["\<\"e\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", "", 
         TagBox[
          StyleBox["\<\"d\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"c\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"]}],
  "mgrPdT"]], "Output",
 CellChangeTimes->{
  3.5925356431472683`*^9, 3.592552247739015*^9, 3.592552484043466*^9, 
   3.592566903283193*^9, {3.5926233048439283`*^9, 3.5926233267499323`*^9}, {
   3.5926233852782383`*^9, 3.5926233973530912`*^9}, {3.592623442894405*^9, 
   3.592623450111801*^9}, 3.5969589177626867`*^9, 3.597391093883931*^9, 
   3.598258966625681*^9, 3.598263629352427*^9, 3.5987612484249067`*^9, 
   3.598852364091756*^9, 3.598852437718042*^9, 3.59885257885104*^9, 
   3.598870364857356*^9, 3.598897609964715*^9, 3.598942713802483*^9, 
   3.60820856976926*^9, 3.6082086484675703`*^9, 3.6082090432422953`*^9, 
   3.608209119247485*^9}]
}, Open  ]],

Cell["\<\
Partial derivatives are linear and obeys the Leibniz rule:\
\>", "Text",
 CellChangeTimes->{{3.592535698172316*^9, 3.592535749523859*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pd", "[", 
  RowBox[{
   RowBox[{"x", "+", 
    RowBox[{"y", " ", "z"}]}], ",", 
   RowBox[{"DN", "@", "\"\<a\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925357531868677`*^9, 3.592535766545393*^9}, {
  3.597391097040703*^9, 3.597391097102495*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalSampi]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "x"}],
   "mgrPdT"], "+", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "y"}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "z"}],
     "mgrPdT"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.5925357669684277`*^9, 3.592552247753811*^9, 3.5925524840575438`*^9, 
   3.592566903528707*^9, {3.592623304921487*^9, 3.592623326900395*^9}, {
   3.592623385366194*^9, 3.592623397635202*^9}, {3.592623442933345*^9, 
   3.592623450189477*^9}, 3.5969589192997913`*^9, 3.597391097473832*^9, 
   3.5982589680979567`*^9, 3.598263629355565*^9, 3.5987612520877857`*^9, 
   3.59885236409525*^9, 3.5988524377506857`*^9, 3.5988525788837748`*^9, 
   3.5988703648713427`*^9, 3.598897609978683*^9, 3.59894271380709*^9, 
   3.60820856978767*^9, 3.608208648506153*^9, 3.608209043285213*^9, 
   3.608209119325019*^9}]
}, Open  ]],

Cell["\<\
As shown above, undeclared quantities are not assumed as constant. Rather, \
one has to define constants explicitly:\
\>", "Text",
 CellChangeTimes->{{3.592535785052247*^9, 3.592535836411697*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pd", "[", 
    RowBox[{"const", ",", "_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Pd", "[", 
  RowBox[{
   RowBox[{"const", "*", "x"}], ",", 
   RowBox[{"DN", "@", "\"\<a\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.592535837904208*^9, 3.592535866796677*^9}, {
  3.597391101625758*^9, 3.59739110181456*^9}}],

Cell[BoxData[
 RowBox[{"const", " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[CapitalSampi]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {""},
          {
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], "x"}],
    "mgrPdT"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.592535860337606*^9, 3.592552247837673*^9, 3.592552484131105*^9, 
   3.592566903945957*^9, {3.59262330492708*^9, 3.592623327040902*^9}, {
   3.592623385380733*^9, 3.59262339764351*^9}, {3.592623443010791*^9, 
   3.592623450236676*^9}, 3.596958920835064*^9, 3.597391102162075*^9, 
   3.598258969427919*^9, 3.598263629367498*^9, 3.598761256651739*^9, 
   3.598852364121149*^9, 3.598852437783243*^9, 3.59885257891586*^9, 
   3.598870364884716*^9, 3.598897609992073*^9, 3.598942713822611*^9, 
   3.608208569805201*^9, 3.608208648553712*^9, 3.6082090433117332`*^9, 
   3.6082091193679113`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Kronecker \[Delta] symbol", "Subsection",
 CellChangeTimes->{{3.592535931013461*^9, 3.5925359577796497`*^9}}],

Cell["\<\
The Kronecker \[Delta] symbol will evaluate contraction automatically\
\>", "Text",
 CellChangeTimes->{{3.592536192699143*^9, 3.592536212260251*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["Dta",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<a\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<c\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592536000839815*^9, 3.5925360486091413`*^9}, {
  3.597391110733033*^9, 3.597391119135653*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["T",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\<\"a\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], ""},
      {"", 
       TagBox[
        StyleBox["\<\"c\"\>",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Output",
 CellChangeTimes->{{3.592536030710761*^9, 3.592536049409071*^9}, 
   3.592552247927678*^9, 3.5925524842322607`*^9, 3.592566904046266*^9, {
   3.592623305128131*^9, 3.5926233273488483`*^9}, {3.5926233854831944`*^9, 
   3.592623397749036*^9}, {3.592623443017017*^9, 3.592623450310655*^9}, 
   3.596958925685793*^9, 3.5973911195747347`*^9, 3.598258973674271*^9, 
   3.598263629380331*^9, 3.598761259460897*^9, 3.5988523641508703`*^9, 
   3.59885243781524*^9, 3.598852578974181*^9, 3.598870364897863*^9, 
   3.598897610006222*^9, 3.5989427138358097`*^9, 3.608208569822007*^9, 
   3.608208648598076*^9, 3.608209043339958*^9, 3.608209119430623*^9}]
}, Open  ]],

Cell["\<\
If no contraction in \[Delta] is found, Dta is held to prevent searching for \
contractions all the time. This Hold[Dta] is released when Simp is called, \
where new contractions are searched for.\
\>", "Text",
 CellChangeTimes->{{3.592536290281402*^9, 3.592536366758533*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["Dta",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<a\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<c\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], ""},
       {"", 
        TagBox[
         StyleBox["\"\<d\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592536219664036*^9, 3.592536270423643*^9}, {
  3.59739112305239*^9, 3.597391131902866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["Dta",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"c\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], ""},
        {"", 
         TagBox[
          StyleBox["\<\"d\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592536235469802*^9, 3.592536270877605*^9}, 
   3.592552247936401*^9, 3.592552484248513*^9, 3.592566904088455*^9, {
   3.5926233054044952`*^9, 3.5926233274633303`*^9}, {3.592623385574839*^9, 
   3.592623398158699*^9}, {3.592623443074771*^9, 3.592623450323901*^9}, 
   3.5969589277917747`*^9, 3.597391133199937*^9, 3.598258975171687*^9, 
   3.598263629393647*^9, 3.598761261138545*^9, 3.598852364175591*^9, 
   3.598852437848032*^9, 3.598852579032526*^9, 3.598870364911552*^9, 
   3.598897610020252*^9, 3.5989427138502073`*^9, 3.608208569839115*^9, 
   3.608208648635292*^9, 3.6082090433758574`*^9, 3.608209119498844*^9}]
}, Open  ]],

Cell["\<\
This gives spacetime dimension:\
\>", "Text",
 CellChangeTimes->{{3.592536389123045*^9, 3.592536394266321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["Dta",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], ""},
      {"", 
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Input",
 CellChangeTimes->{{3.592536378134956*^9, 3.59253637854865*^9}, {
  3.597391137644698*^9, 3.597391140297805*^9}}],

Cell[BoxData["DefaultDim"], "Output",
 CellChangeTimes->{
  3.592536379129898*^9, 3.592552248000677*^9, 3.592552484323791*^9, 
   3.592566904128502*^9, {3.592623305417657*^9, 3.592623327562953*^9}, {
   3.592623385686133*^9, 3.592623398534938*^9}, {3.5926234433740463`*^9, 
   3.592623450371579*^9}, 3.59695893088735*^9, 3.597391140754752*^9, 
   3.598258978244679*^9, 3.598263629406213*^9, 3.598761262818013*^9, 
   3.598852364200838*^9, 3.598852437881073*^9, 3.598852579070436*^9, 
   3.598870364923853*^9, 3.5988976100337257`*^9, 3.598942713854238*^9, 
   3.608208569855297*^9, 3.608208648686851*^9, 3.608209043411261*^9, 
   3.60820911956628*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The generalized \[Delta] symbol", "Subsection",
 CellChangeTimes->{{3.5925364173722467`*^9, 3.5925364232924*^9}}],

Cell["\<\
The generalized \[Delta] symbol is defined as a product of \[Delta]\
\[CloseCurlyQuote]s, with lower indices perfectly antisymmetrized:\
\>", "Text",
 CellChangeTimes->{{3.592536563396202*^9, 3.592536598966343*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DtaGen", "[", 
  RowBox[{
   RowBox[{"UP", "@", "\"\<a\>\""}], ",", 
   RowBox[{"UP", "@", "\"\<b\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<m\>\""}], ",", 
   RowBox[{"DN", "@", "\"\<n\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925364331188517`*^9, 3.592536498293972*^9}, {
  3.597391152329774*^9, 3.597391159414873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       AdjustmentBox["Dta",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {"", 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP]},
          {
           TagBox[
            StyleBox["\<\"m\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN], ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], ")"}]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["Dta",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"n\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["Dta",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"m\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["Dta",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {
          TagBox[
           StyleBox["\<\"n\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.592536468066381*^9, 3.592536498822962*^9}, 
   3.592552248089136*^9, 3.5925524843714733`*^9, 3.5925669041600018`*^9, {
   3.592623305540909*^9, 3.592623327706264*^9}, {3.592623385701824*^9, 
   3.592623398693427*^9}, {3.592623443438369*^9, 3.59262345044751*^9}, 
   3.596958935746752*^9, 3.597391159972927*^9, 3.598258980002915*^9, 
   3.5982636294195127`*^9, 3.5987612691155567`*^9, 3.5988523642262497`*^9, 
   3.598852437914225*^9, 3.5988525791076307`*^9, 3.5988703649369183`*^9, 
   3.598897610047696*^9, 3.5989427138700247`*^9, 3.6082085698735943`*^9, 
   3.608208648726622*^9, 3.608209043440763*^9, 3.608209119634117*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Levi-Civita symbol", "Subsection",
 CellChangeTimes->{{3.5925366489484243`*^9, 3.592536675458056*^9}, {
  3.5925367565240602`*^9, 3.59253675689246*^9}}],

Cell["\<\
If spacetime dimension is given explicitly as a number, the Levi-Civita \
symbol is defined as LeviCivita[...], which is totally anti-symmetric. A \
product ot two Levi-Civita tensors is reduced to generalized \[Delta] symbol.\
\
\>", "Text",
 CellChangeTimes->{{3.5925367343662148`*^9, 3.592536833037497*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Symmetrization or anti-symmetrization of free indices\
\>", "Subsection",
 CellChangeTimes->{{3.592536937062154*^9, 3.592536944844756*^9}, {
  3.592536977316908*^9, 3.592536979794327*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<a\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "//", "Sym"}]], "Input",
 CellChangeTimes->{{3.5925369622405787`*^9, 3.5925369739790077`*^9}, {
  3.597391171876135*^9, 3.597391174853938*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"a\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"b\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "+", 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"b\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"a\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Output",
 CellChangeTimes->{{3.592536964233883*^9, 3.592536974448186*^9}, 
   3.5925522481574783`*^9, 3.592552484448515*^9, 3.592566904171669*^9, {
   3.5926233057832747`*^9, 3.592623327719996*^9}, {3.592623385798024*^9, 
   3.592623398969266*^9}, {3.592623443453079*^9, 3.592623450518778*^9}, 
   3.596958937453475*^9, 3.597391175813857*^9, 3.598258981719084*^9, 
   3.5982636294319897`*^9, 3.598761271826584*^9, 3.598852364252036*^9, 
   3.598852437947706*^9, 3.598852579137474*^9, 3.598870364950354*^9, 
   3.598897610052335*^9, 3.598942713874651*^9, 3.608208569891176*^9, 
   3.608208648764298*^9, 3.6082090434713793`*^9, 3.608209119637198*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<a\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "//", "AntiSym"}]], "Input",
 CellChangeTimes->{{3.5925369622405787`*^9, 3.5925369635711527`*^9}, {
  3.597391178077269*^9, 3.5973911848216743`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"a\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"b\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], "-", 
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\<\"b\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\<\"a\"\>",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Output",
 CellChangeTimes->{
  3.592536964233883*^9, 3.592552248399541*^9, 3.5925524845297613`*^9, 
   3.5925669042067947`*^9, {3.592623305902053*^9, 3.592623327837315*^9}, {
   3.592623385906249*^9, 3.5926233989842567`*^9}, {3.59262344352314*^9, 
   3.592623450635056*^9}, 3.5969589384917917`*^9, 3.5973911853635197`*^9, 
   3.598258984628199*^9, 3.598263629444413*^9, 3.598761273021254*^9, 
   3.598852364276538*^9, 3.5988524379513893`*^9, 3.598852579169999*^9, 
   3.598870364963135*^9, 3.598897610064394*^9, 3.5989427138882437`*^9, 
   3.608208569907144*^9, 3.6082086488023787`*^9, 3.6082090435071507`*^9, 
   3.608209119704715*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GR calculations (gr.m)", "Section",
 CellChangeTimes->{{3.5925368757140913`*^9, 3.592536880888844*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/gr.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592536994899125*^9, 3.5925369988552027`*^9}, {
  3.592563328542149*^9, 3.592563328880149*^9}}],

Cell[CellGroupData[{

Cell["GR quantities", "Subsection",
 CellChangeTimes->{{3.592547212008951*^9, 3.592547214769696*^9}}],

Cell["\<\
Quantities Affine[UP,DN,DN], R[UP,DN,DN,DN], R[DN,DN,DN,DN], R[DN,DN], R[] \
are calculated with a default metric g.\
\>", "Text",
 CellChangeTimes->{{3.5925370779739723`*^9, 3.592537093269932*^9}, {
  3.592547082198957*^9, 3.5925471288318357`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   AdjustmentBox["Affine",
    BoxMargins->{{0, -0.2}, {0, 0}}], 
   StyleBox[GridBox[{
      {
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`UP], "", ""},
      {"", 
       TagBox[
        StyleBox["\"\<b\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN], 
       TagBox[
        StyleBox["\"\<c\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]}
     },
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    FontSize->10]}],
  "mgrTsr"]], "Input",
 CellChangeTimes->{{3.5925370563040752`*^9, 3.59253705636567*^9}, {
  3.5973911957935658`*^9, 3.5973912004274187`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["$105",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      TagBox[
       RowBox[{
        TagBox[
         RowBox[{
          AdjustmentBox["\[CapitalSampi]",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {""},
             {
              TagBox[
               StyleBox["$105",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"], 
        TagBox[
         RowBox[{
          AdjustmentBox["g",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\<\"b\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN], 
              TagBox[
               StyleBox["\<\"c\"\>",
                FontColor->GrayLevel[0]],
               MathGR`tensor`DN]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"]}],
       "mgrPdT"], ")"}]}], "+", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["$105",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], "+", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["$105",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.592537057975049*^9, 3.592552248506106*^9, 3.5925524848068113`*^9, 
   3.592566904283984*^9, {3.592623306014205*^9, 3.592623328005434*^9}, {
   3.5926233859921827`*^9, 3.592623399169107*^9}, {3.592623443706889*^9, 
   3.5926234508212147`*^9}, 3.5969589459038*^9, 3.597391200818638*^9, 
   3.5982589907170143`*^9, 3.5982636294854803`*^9, 3.598761276367779*^9, 
   3.5988523643703537`*^9, 3.5988524381298447`*^9, 3.5988525793055573`*^9, 
   3.598870365031693*^9, 3.5988976101188297`*^9, 3.598942713944325*^9, 
   3.608208570015005*^9, 3.608208648903514*^9, 3.6082090437160177`*^9, 
   3.6082091200268927`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547067850177*^9, 3.592547071015139*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       AdjustmentBox["g",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP], 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], ")"}]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.592547071880156*^9, 3.5925522487292633`*^9, 3.592552485063575*^9, 
   3.592566904534931*^9, {3.592623306337317*^9, 3.592623328268077*^9}, {
   3.59262338608315*^9, 3.592623399308264*^9}, {3.592623443983449*^9, 
   3.5926234509590273`*^9}, 3.596958958321105*^9, 3.5973912074531097`*^9, 
   3.598258992248263*^9, 3.598263629595998*^9, 3.598761283386765*^9, 
   3.5988523644742327`*^9, 3.5988524382323847`*^9, 3.598852579410365*^9, 
   3.5988703652048798`*^9, 3.59889761031647*^9, 3.5989427141189137`*^9, 
   3.608208570266757*^9, 3.6082086489858637`*^9, 3.608209043792934*^9, 
   3.608209120176743*^9}]
}, Open  ]],

Cell["\<\
Quantities can be calculated using alternative metric\
\>", "Text",
 CellChangeTimes->{{3.5925471843529243`*^9, 3.592547192722919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"WithMetric", "[", 
   RowBox[{"h", ",", 
    RowBox[{"R", "[", "]"}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547133961891*^9, 3.5925471362395353`*^9}, {
  3.592547167272147*^9, 3.592547172530463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     TagBox[
      RowBox[{
       AdjustmentBox["h",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP], 
           TagBox[
            StyleBox["\<\"b\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`UP]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], ")"}]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{
   FractionBox["3", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["h",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"e\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"f\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"f\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["h",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"e\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.592547173228063*^9, 3.592552249008205*^9, 3.592552485285125*^9, 
   3.59256690498538*^9, {3.592623306588084*^9, 3.592623328586069*^9}, {
   3.592623386289989*^9, 3.592623399616419*^9}, {3.592623444224001*^9, 
   3.592623451195444*^9}, 3.596958963022174*^9, 3.597391210265374*^9, 
   3.598258994232566*^9, 3.5982636297127943`*^9, 3.598761291860692*^9, 
   3.598852364580735*^9, 3.598852438364521*^9, 3.59885257954354*^9, 
   3.5988703653267183`*^9, 3.598897610426116*^9, 3.5989427142380342`*^9, 
   3.6082085703405247`*^9, 3.608208649047778*^9, 3.6082090438550243`*^9, 
   3.608209120306653*^9}]
}, Open  ]],

Cell["\<\
Quantities can be calculated in terms of, say, affine instead of metric. One \
can also define new metrics using UseMetric[metric, {upIdx, dnIdx}].\
\>", "Text",
 CellChangeTimes->{{3.592547227071014*^9, 3.592547253505663*^9}, {
  3.592548150629743*^9, 3.592548205934392*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Affine", "=", "\[CapitalGamma]"}], "}"}], ",", 
    RowBox[{"R", "[", "]"}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547255102035*^9, 3.592547268084371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalGamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], "", ""},
           {"", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalGamma]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`UP], "", ""},
           {"", 
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalGamma]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], "", ""},
         {"", 
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5925472648246927`*^9, 3.592547268607706*^9}, 
   3.592552249060154*^9, 3.592552485354107*^9, 3.592566905113068*^9, {
   3.592623306819353*^9, 3.592623328669876*^9}, {3.5926233864188128`*^9, 
   3.5926233999672537`*^9}, {3.592623444288439*^9, 3.592623451239603*^9}, 
   3.5969589643442497`*^9, 3.59739121314824*^9, 3.598258998490423*^9, 
   3.5982636297381067`*^9, 3.59876129694363*^9, 3.598852364623652*^9, 
   3.5988524384103518`*^9, 3.598852579574909*^9, 3.59887036535219*^9, 
   3.598897610451956*^9, 3.598942714267271*^9, 3.608208570370596*^9, 
   3.6082086490897703`*^9, 3.608209043893263*^9, 3.608209120349063*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariant derivatives", "Subsection",
 CellChangeTimes->{{3.592547378393669*^9, 3.592547381310028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CovD", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"DN", "@", "\"\<a\>\""}], "]"}], ",", 
    RowBox[{"DN", "@", "\"\<b\>\""}]}], "]"}], "//", "Simp"}]], "Input",
 CellChangeTimes->{{3.592547383447771*^9, 3.592547406346381*^9}, {
  3.5973912203552513`*^9, 3.597391223220797*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[CapitalSampi]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"b\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}],
   "mgrPdT"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"d\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["g",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"c\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`UP]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["g",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {"", ""},
           {
            TagBox[
             StyleBox["\<\"b\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN], 
            TagBox[
             StyleBox["\<\"c\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["T",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"d\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5925474034058857`*^9, 3.59254740694311*^9}, 
   3.592552249129002*^9, 3.592552485420312*^9, 3.592566905308597*^9, {
   3.592623306951138*^9, 3.592623328768993*^9}, {3.592623386544668*^9, 
   3.592623400123444*^9}, {3.592623444341186*^9, 3.592623451293209*^9}, 
   3.596958973632131*^9, 3.597391223525185*^9, 3.598258999810625*^9, 
   3.598263629758267*^9, 3.5987612998013763`*^9, 3.5988523646643457`*^9, 
   3.598852438460767*^9, 3.598852579654231*^9, 3.598870365379717*^9, 
   3.598897610479357*^9, 3.5989427142962313`*^9, 3.6082085704164133`*^9, 
   3.608208649164977*^9, 3.60820904393495*^9, 3.608209120390605*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric contraction", "Subsection",
 CellChangeTimes->{{3.5925474397619267`*^9, 3.592547443760118*^9}}],

Cell["\<\
One can definitely contract tensors with metric directly, such as\
\>", "Text",
 CellChangeTimes->{{3.592548116508953*^9, 3.59254812659149*^9}, {
  3.592548252221116*^9, 3.592548253245625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{
    AdjustmentBox["T",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {"", ""},
       {
        TagBox[
         StyleBox["\"\<a\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN], 
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`DN]}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"], 
  TagBox[
   RowBox[{
    AdjustmentBox["g",
     BoxMargins->{{0, -0.2}, {0, 0}}], 
    StyleBox[GridBox[{
       {
        TagBox[
         StyleBox["\"\<a\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP], 
        TagBox[
         StyleBox["\"\<b\>\"",
          FontColor->GrayLevel[0]],
         MathGR`tensor`UP]},
       {"", ""}
      },
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     FontSize->10]}],
   "mgrTsr"]}]], "Input",
 CellChangeTimes->{{3.592548260558618*^9, 3.592548275768819*^9}, {
  3.597391228331066*^9, 3.597391235034564*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{
  3.592548281246608*^9, 3.592552249196795*^9, 3.592552485438751*^9, 
   3.59256690540143*^9, {3.592623307075439*^9, 3.5926233287779293`*^9}, {
   3.592623386693965*^9, 3.592623400263131*^9}, {3.592623444354697*^9, 
   3.5926234513101797`*^9}, 3.596958977240753*^9, 3.597391235523432*^9, 
   3.598259003164502*^9, 3.598263629774852*^9, 3.598761307562756*^9, 
   3.598852364692871*^9, 3.598852438514769*^9, 3.598852579721418*^9, 
   3.5988703653948793`*^9, 3.598897610494258*^9, 3.598942714313509*^9, 
   3.60820857043297*^9, 3.608208649245887*^9, 3.608209043997514*^9, 
   3.608209120420789*^9}]
}, Open  ]],

Cell["\<\
However, if there are lots of metric contractions, it is useful to introduce \
the following short hand. Here UG and DG are upper and lower indices which \
are to be contracted with metric.\
\>", "Text",
 CellChangeTimes->{{3.59254828328295*^9, 3.5925483174251413`*^9}, {
  3.592548350897723*^9, 3.592548367882963*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{
     RowBox[{"DG", "@", "1"}], ",", 
     RowBox[{"DG", "@", "1"}], ",", 
     RowBox[{"UG", "@", "2"}], ",", 
     RowBox[{"UG", "@", "2"}], ",", 
     RowBox[{"DG", "@", "3"}], ",", 
     RowBox[{"DG", "@", "3"}]}], "]"}], "//", "MetricContract"}], "//", 
  "Simp"}]], "Input",
 CellChangeTimes->{{3.5925483207485228`*^9, 3.592548343651291*^9}, {
  3.5925483756902027`*^9, 3.592548379270257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", ""},
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"c\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"d\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["g",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"e\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"f\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["T",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {"", "", 
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], 
         TagBox[
          StyleBox["\<\"b\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`UP], "", ""},
        {
         TagBox[
          StyleBox["\<\"c\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"d\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], "", "", 
         TagBox[
          StyleBox["\<\"e\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN], 
         TagBox[
          StyleBox["\<\"f\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`DN]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.59254833286753*^9, 3.592548344066506*^9}, 
   3.592548380063374*^9, 3.592552249428406*^9, 3.592552485520343*^9, 
   3.5925669054717073`*^9, {3.592623307227124*^9, 3.59262332886201*^9}, {
   3.592623386834155*^9, 3.5926234004246264`*^9}, {3.5926234444013653`*^9, 
   3.592623451381364*^9}, 3.596958978885734*^9, 3.597391238096994*^9, 
   3.5982590055740223`*^9, 3.598263629787696*^9, 3.5987613094807367`*^9, 
   3.598852364742248*^9, 3.598852438599515*^9, 3.59885257982894*^9, 
   3.598870365407013*^9, 3.598897610510921*^9, 3.5989427143316793`*^9, 
   3.608208570452586*^9, 3.6082086492811117`*^9, 3.608209044068286*^9, 
   3.608209120467862*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integration by parts (ibp.m)", "Section",
 CellChangeTimes->{{3.592548872819849*^9, 3.5925488986372433`*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/ibp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592548883231072*^9, 3.592548885423325*^9}, {
  3.592563333218902*^9, 3.5925633340647087`*^9}, {3.596958991814237*^9, 
  3.596958993329874*^9}}],

Cell["\<\
This module tries to rewrite an expression into a total derivative, possibly \
with a rest part.\
\>", "Text",
 CellChangeTimes->{{3.592548892759857*^9, 3.592548957858235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], "+", 
   RowBox[{"y", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925491001828203`*^9, 3.592549147025807*^9}, {
  3.597391251051429*^9, 3.597391254290576*^9}}],

Cell[BoxData[
 RowBox[{"PdHold", "[", 
  RowBox[{
   RowBox[{"x", " ", "y"}], ",", 
   RowBox[{"DN", "[", "\<\"a\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.59254914769416*^9, 3.5925522495365133`*^9, 3.592552485632535*^9, 
   3.592566905558329*^9, {3.592623307827752*^9, 3.5926233293657312`*^9}, {
   3.5926233875573587`*^9, 3.592623400902482*^9}, {3.592623444504614*^9, 
   3.592623451460738*^9}, 3.596958995398645*^9, {3.597391254649465*^9, 
   3.597391262322075*^9}, 3.598259010611229*^9, 3.5982636298256397`*^9, 
   3.598761314083675*^9, 3.5988523648427887`*^9, 3.598852438790696*^9, 
   3.5988525799696836`*^9, 3.5988703654902277`*^9, 3.598897610621355*^9, 
   3.598942714453306*^9, 3.608208570597376*^9, 3.608208649437888*^9, 
   3.608209044201078*^9, 3.608209120679738*^9}]
}, Open  ]],

Cell["\<\
Here we have renamed Pd into PdHold. Otherwise Pd will automatically be \
calculated via Leibniz rule.

Note that expressions cannot always be written as total derivatives. For \
example, the following has a rest part:\
\>", "Text",
 CellChangeTimes->{{3.592549152149476*^9, 3.592549384734662*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], "+", 
   RowBox[{"2", "y", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<\[Alpha]\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "x"}],
     "mgrPd"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5925491001828203`*^9, 3.592549147025807*^9}, 
   3.592549318260007*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"x", " ", "y"}], ",", 
    RowBox[{"DN", "[", "\<\"\[Alpha]\"\>", "]"}]}], "]"}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "x"}],
     "mgrPdT"], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.5925493186860323`*^9, 3.5925522496984177`*^9, 3.592552485959116*^9, 
   3.592566905974062*^9, {3.592623308144906*^9, 3.592623329538454*^9}, {
   3.592623387885622*^9, 3.5926234014085608`*^9}, {3.592623444637096*^9, 
   3.5926234516025667`*^9}, 3.5969589978002987`*^9, 3.597391271581978*^9, 
   3.598259012075303*^9, 3.5982636298579817`*^9, 3.598761321002619*^9, 
   3.598852364963044*^9, 3.598852438871471*^9, 3.598852580068233*^9, 
   3.598870365528449*^9, 3.598897610660989*^9, 3.5989427144940243`*^9, 
   3.6082085706467867`*^9, 3.6082086495564547`*^9, 3.6082090442941732`*^9, 
   3.6082091207786922`*^9}]
}, Open  ]],

Cell["\<\
Also, Ibp[expr] may fail to find the total derivative even if it exists.

Sometimes one wants finer control. For example, what kind of rest part is \
considered to be simpler. In this case, one can specify the measure function \
explicitly. Here are a few examples:\
\>", "Text",
 CellChangeTimes->{{3.592549152149476*^9, 3.59254931134094*^9}, {
  3.5925493916620607`*^9, 3.592549462860622*^9}, {3.592549500998979*^9, 
  3.592549506625141*^9}}],

Cell["\<\
(1) Get rid of derivative on specified variable (y in the below example)\
\>", "Text",
 CellChangeTimes->{{3.592549515406789*^9, 3.592549539574801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], ",", 
   RowBox[{"\"\<Rank\>\"", "\[Rule]", 
    RowBox[{"IbpVar", "[", "y", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592549475194147*^9, 3.5925494939242697`*^9}, {
  3.597391290979747*^9, 3.5973912910757313`*^9}, {3.598852319090728*^9, 
  3.598852323434369*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{"x", " ", "y"}], ",", 
    RowBox[{"DN", "[", "\<\"a\"\>", "]"}]}], "]"}], "-", 
  RowBox[{"y", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "x"}],
     "mgrPdT"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.59254948607865*^9, 3.592549494391553*^9}, 
   3.59255224984006*^9, 3.592552486132552*^9, 3.592556972679886*^9, 
   3.592566906109055*^9, {3.5926233086061697`*^9, 3.5926233297078323`*^9}, {
   3.592623388380424*^9, 3.592623401750649*^9}, {3.5926234448350697`*^9, 
   3.592623451727701*^9}, 3.59695900272034*^9, {3.597391273395215*^9, 
   3.597391291355946*^9}, 3.598259015377441*^9, 3.598263629878965*^9, 
   3.598761326765253*^9, 3.59885236507087*^9, 3.598852438948307*^9, 
   3.598852580158092*^9, 3.598870365556369*^9, 3.598897610697668*^9, 
   3.5989427145242157`*^9, 3.608208570695128*^9, 3.6082086496591253`*^9, 
   3.608209044385023*^9, 3.608209120870633*^9}]
}, Open  ]],

Cell["\<\
A more efficient version of this function (and setting boundary term to be \
zero) is\
\>", "Text",
 CellChangeTimes->{{3.592556915990922*^9, 3.5925569645030823`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IbpVariation", "[", 
  RowBox[{
   RowBox[{"x", " ", 
    TagBox[
     RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\<a\>\"",
         FontColor->GrayLevel[0]],
        MathGR`tensor`DN]], "y"}],
     "mgrPd"]}], ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.5925569388245983`*^9, 3.592556951119632*^9}, {
  3.597391295732912*^9, 3.597391295830359*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "y"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[CapitalSampi]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {""},
          {
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`DN]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], "x"}],
    "mgrPdT"], ")"}]}]], "Output",
 CellChangeTimes->{{3.592556951526786*^9, 3.592556973943396*^9}, 
   3.592566906146654*^9, {3.592623308760557*^9, 3.592623329798568*^9}, {
   3.592623388544425*^9, 3.592623401932147*^9}, {3.5926234448862133`*^9, 
   3.592623451874774*^9}, 3.5969590039714193`*^9, {3.597391275593852*^9, 
   3.5973912969060183`*^9}, 3.598259016658906*^9, 3.598263629890668*^9, 
   3.5987613325953712`*^9, 3.598852365097164*^9, 3.5988524389765472`*^9, 
   3.5988525801874657`*^9, 3.598870365567543*^9, 3.5988976107121*^9, 
   3.598942714539308*^9, 3.608208570710668*^9, 3.608208649819497*^9, 
   3.608209044419407*^9, 3.6082091208998938`*^9}]
}, Open  ]],

Cell["\<\
(2) Rules to write second order action in standard form\
\>", "Text",
 CellChangeTimes->{{3.592549546714025*^9, 3.592549582835376*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ibp", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"(", 
       OverscriptBox["\[Phi]", "\[Bullet]"], ")"}], "2"]}], "+", " ", 
    RowBox[{"\[Phi]", " ", 
     OverscriptBox["\[Phi]", "\[Bullet]\[Bullet]"]}], "+", 
    RowBox[{"m", " ", "\[Phi]", 
     OverscriptBox["\[Phi]", "\[Bullet]"]}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox["M", "2"], 
     SuperscriptBox["\[Phi]", "2"]}]}], ",", 
   RowBox[{"\"\<Rank\>\"", "\[Rule]", "IbpStd2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592556785759036*^9, 3.592556870702876*^9}, {
  3.592557000430122*^9, 3.592557042034514*^9}, {3.59885233199778*^9, 
  3.598852335299323*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["M", "2"], " ", 
   SuperscriptBox["\[Phi]", "2"]}], "+", 
  RowBox[{"PdHold", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"m", " ", 
       SuperscriptBox["\[Phi]", "2"]}], "2"], "+", 
     RowBox[{"\[Phi]", " ", 
      OverscriptBox["\[Phi]", "\[Bullet]"]}]}], ",", 
    RowBox[{"DE", "[", "0", "]"}]}], "]"}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Phi]", "2"], " ", 
    OverscriptBox["m", "\[Bullet]"]}], "2"], "+", 
  SuperscriptBox[
   OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}]], "Output",
 CellChangeTimes->{
  3.592556871506406*^9, {3.592557007787573*^9, 3.592557042543975*^9}, 
   3.5925669062559977`*^9, {3.5926233094346523`*^9, 3.592623330048965*^9}, {
   3.592623389045257*^9, 3.5926234024698257`*^9}, {3.592623445054178*^9, 
   3.5926234520561447`*^9}, 3.59695900492488*^9, {3.597391283523058*^9, 
   3.597391299939764*^9}, 3.598259017635803*^9, 3.598263629921014*^9, 
   3.5987613347057*^9, 3.598852365191126*^9, 3.598852439086025*^9, 
   3.598852580295032*^9, 3.598870365617406*^9, 3.5988976107585278`*^9, 
   3.598942714585249*^9, 3.608208570766431*^9, 3.608208649970319*^9, 
   3.608209044539588*^9, 3.608209121007848*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Decomposition of dimensions (decomp.m)\
\>", "Section",
 CellChangeTimes->{{3.592557249590426*^9, 3.592557252593915*^9}, {
  3.592557467915167*^9, 3.592557468950857*^9}, {3.592557507780242*^9, 
  3.592557509644903*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "MathGR/gr.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/decomp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/ibp.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MathGR/typeset.m"}]}], "Input",
 CellChangeTimes->{{3.592557441459054*^9, 3.59255745414318*^9}, {
  3.592563340824881*^9, 3.592563355889909*^9}, {3.592565088523473*^9, 
  3.592565092333067*^9}}],

Cell["\<\
In decomp.m, three additional set of indices ({UTot, DTot}, {U1, D1}, {U2, \
D2}), together with decomposition rules are defined. Here we show the usage \
of decomp.m by going through an example.

First we define metric in the total dimensions, and the \
\[OpenCurlyDoubleQuote]compactified\[CloseCurlyDoubleQuote] dimensions. The \
3+1 dim metric is pre-defined as usual, denoted by g.\
\>", "Text",
 CellChangeTimes->{{3.592557463132421*^9, 3.5925575430470743`*^9}, {
  3.5925576214368973`*^9, 3.592557679319751*^9}, {3.608208754354096*^9, 
  3.6082087682731333`*^9}}],

Cell[BoxData[{
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[DoubleStruckG]", ",", 
   RowBox[{"{", 
    RowBox[{"UTot", ",", " ", "DTot"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[Eta]", ",", 
   RowBox[{"{", 
    RowBox[{"U1", ",", " ", "D1"}], "}"}], ",", 
   RowBox[{"\"\<SetAsDefault\>\"", "\[Rule]", "False"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"UseMetric", "[", 
  RowBox[{"\[Gamma]", ",", 
   RowBox[{"{", 
    RowBox[{"U2", ",", "D2"}], "}"}], ",", 
   RowBox[{"\"\<SetAsDefault\>\"", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.592557441459054*^9, 3.59255745414318*^9}, 
   3.592557547534232*^9, {3.597391314773698*^9, 3.597391321930501*^9}, {
   3.597391959743284*^9, 3.597391987701539*^9}, {3.5973997302591677`*^9, 
   3.5973997477571287`*^9}, {3.597399904009712*^9, 3.5973999057202682`*^9}, {
   3.597399961551422*^9, 3.5973999625446177`*^9}, 3.597402172094002*^9, {
   3.597403271705062*^9, 3.5974032720473957`*^9}}],

Cell["\<\
Here for illustration purpose, we compactify Einstein gravity on n-torus. The \
non-compact dimensions are assumed Minkowski and the internal dimensions also \
has no curvature. There are n constant teleparallel killing vectors (denoted \
by V here) on n-torus. The off-diag components of the metric is expanded \
using this killing vector basis, with coefficients as gauge fields A.

The followings are the form of the metric and definition of their partial \
derivatives.\
\>", "Text",
 CellChangeTimes->{{3.592565424747127*^9, 3.592565484159156*^9}, {
  3.5925655974296083`*^9, 3.592565682069167*^9}, {3.592565746190011*^9, 
  3.5925657686960583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DecompHook", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[DoubleStruckG]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {"", ""},
          {
           TagBox[
            StyleBox["\[Alpha]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`D1], 
           TagBox[
            StyleBox["\[Beta]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`D1]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], " ", "\[RuleDelayed]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[Eta]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {"", ""},
              {
               TagBox[
                StyleBox["\[Alpha]",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`D1], 
               TagBox[
                StyleBox["\[Beta]",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`D1]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
               "ItemsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#1",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`tensor`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["\[Alpha]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`D1]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                 "ItemsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#1",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`tensor`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["\[Beta]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`D1]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                 "ItemsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}]}], " ", "&"}], ")"}], "[", 
      RowBox[{"Uq", "[", "1", "]"}], "]"}]}], ",", "\n", "  ", 
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[DoubleStruckG]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {"", ""},
          {
           TagBox[
            StyleBox["\[Alpha]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`D1], 
           TagBox[
            StyleBox["b_",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`D2]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], " ", "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["b",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`tensor`U2], ""},
           {"", 
            TagBox[
             StyleBox["\[Alpha]",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
            "ItemsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], ")"}]}], ",", "\n", "  ", 
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[DoubleStruckG]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\[Alpha]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`U1], 
           TagBox[
            StyleBox["\[Beta]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`U1]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], " ", "\[RuleDelayed]", " ", 
     TagBox[
      RowBox[{
       AdjustmentBox["\[Eta]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\[Alpha]",
             FontColor->GrayLevel[0]],
            MathGR`tensor`U1], 
           TagBox[
            StyleBox["\[Beta]",
             FontColor->GrayLevel[0]],
            MathGR`tensor`U1]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}], ",", "\n", "  ", 
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[DoubleStruckG]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\[Alpha]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`U1], 
           TagBox[
            StyleBox["b_",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`U2]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], " ", "\[RuleDelayed]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["\[Eta]",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["\[Alpha]",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`U1], 
                 TagBox[
                  StyleBox["#1",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`U1]},
                {"", ""}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                 "ItemsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}], " ", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["A",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["b",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], ""},
               {"", 
                TagBox[
                 StyleBox["#1",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                "ItemsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}]}], " ", "&"}], ")"}], "[", 
      RowBox[{"Uq", "[", "1", "]"}], "]"}]}], ",", "\n", "  ", 
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[DoubleStruckG]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["a_",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`U2], 
           TagBox[
            StyleBox["b_",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`U2]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], " ", "\[RuleDelayed]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["Dta",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {
               TagBox[
                StyleBox["a",
                 FontColor->RGBColor[1, 0, 0]],
                MathGR`tensor`U2], 
               TagBox[
                StyleBox["b",
                 FontColor->RGBColor[1, 0, 0]],
                MathGR`tensor`U2]},
              {"", ""}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
               "ItemsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["\[Eta]",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["#1",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`U1], 
                 TagBox[
                  StyleBox["#2",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`U1]},
                {"", ""}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                 "ItemsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["a",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`tensor`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#1",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`D1]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                 "ItemsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}], " ", 
          RowBox[{"(", 
           TagBox[
            RowBox[{
             AdjustmentBox["A",
              BoxMargins->{{0, -0.2}, {0, 0}}], 
             StyleBox[GridBox[{
                {
                 TagBox[
                  StyleBox["b",
                   FontColor->RGBColor[1, 0, 0]],
                  MathGR`tensor`U2], ""},
                {"", 
                 TagBox[
                  StyleBox["#2",
                   FontColor->GrayLevel[0]],
                  MathGR`tensor`D1]}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                 "ItemsIndexed" -> {}}],
              FontSize->10]}],
            "mgrTsr"], ")"}]}]}], " ", "&"}], ")"}], "[", 
      RowBox[{"Uq", "[", "2", "]"}], "]"}]}], ",", "\n", "  ", 
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[DoubleStruckG]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {"", ""},
          {
           TagBox[
            StyleBox["a_",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`D2], 
           TagBox[
            StyleBox["b_",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`D2]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], " ", "\[RuleDelayed]", " ", 
     TagBox[
      RowBox[{
       AdjustmentBox["Dta",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["a",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`U2], 
           TagBox[
            StyleBox["b",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`U2]},
          {"", ""}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
           "ItemsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6082090207352943`*^9, 3.608209031779766*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[DoubleStruckG]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["\[Alpha]_",
            FontColor->GrayLevel[0]],
           MathGR`tensor`D1], 
          TagBox[
           StyleBox["\[Beta]_",
            FontColor->GrayLevel[0]],
           MathGR`tensor`D1]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        TagBox[
         RowBox[{
          AdjustmentBox["\[Eta]",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {"", ""},
             {
              TagBox[
               StyleBox["\[Alpha]",
                FontColor->GrayLevel[0]],
               MathGR`tensor`D1], 
              TagBox[
               StyleBox["\[Beta]",
                FontColor->GrayLevel[0]],
               MathGR`tensor`D1]}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"], "+", 
        RowBox[{
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["A",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["#1",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], ""},
               {"", 
                TagBox[
                 StyleBox["\[Alpha]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}], " ", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["A",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["#1",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], ""},
               {"", 
                TagBox[
                 StyleBox["\[Beta]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}]}]}], "&"}], ")"}], "[", 
     RowBox[{"Uq", "[", "1", "]"}], "]"}]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[DoubleStruckG]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["\[Alpha]_",
            FontColor->GrayLevel[0]],
           MathGR`tensor`D1], 
          TagBox[
           StyleBox["b_",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`D2]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[RuleDelayed]", 
    TagBox[
     RowBox[{
      AdjustmentBox["A",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["b",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`U2], ""},
         {"", 
          TagBox[
           StyleBox["\[Alpha]",
            FontColor->GrayLevel[0]],
           MathGR`tensor`D1]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[DoubleStruckG]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\[Alpha]_",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\[Beta]_",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[RuleDelayed]", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Eta]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\[Alpha]",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\[Beta]",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[DoubleStruckG]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\[Alpha]_",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["b_",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`U2]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["\[Eta]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["\[Alpha]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`U1], 
                TagBox[
                 StyleBox["#1",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`U1]},
               {"", ""}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}]}], " ", 
        RowBox[{"(", 
         TagBox[
          RowBox[{
           AdjustmentBox["A",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {
               TagBox[
                StyleBox["b",
                 FontColor->RGBColor[1, 0, 0]],
                MathGR`tensor`U2], ""},
              {"", 
               TagBox[
                StyleBox["#1",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`D1]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], ")"}]}], "&"}], ")"}], "[", 
     RowBox[{"Uq", "[", "1", "]"}], "]"}]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[DoubleStruckG]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["a_",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`U2], 
          TagBox[
           StyleBox["b_",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`U2]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        TagBox[
         RowBox[{
          AdjustmentBox["Dta",
           BoxMargins->{{0, -0.2}, {0, 0}}], 
          StyleBox[GridBox[{
             {
              TagBox[
               StyleBox["a",
                FontColor->RGBColor[1, 0, 0]],
               MathGR`tensor`U2], 
              TagBox[
               StyleBox["b",
                FontColor->RGBColor[1, 0, 0]],
               MathGR`tensor`U2]},
             {"", ""}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           FontSize->10]}],
         "mgrTsr"], "+", 
        RowBox[{
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["\[Eta]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["#1",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`U1], 
                TagBox[
                 StyleBox["#2",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`U1]},
               {"", ""}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}], " ", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["A",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["a",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], ""},
               {"", 
                TagBox[
                 StyleBox["#1",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}], " ", 
         RowBox[{"(", 
          TagBox[
           RowBox[{
            AdjustmentBox["A",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["b",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], ""},
               {"", 
                TagBox[
                 StyleBox["#2",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], ")"}]}]}], "&"}], ")"}], "[", 
     RowBox[{"Uq", "[", "2", "]"}], "]"}]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["\[DoubleStruckG]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {"", ""},
         {
          TagBox[
           StyleBox["a_",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`D2], 
          TagBox[
           StyleBox["b_",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`D2]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[RuleDelayed]", 
    TagBox[
     RowBox[{
      AdjustmentBox["Dta",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["a",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`U2], 
          TagBox[
           StyleBox["b",
            FontColor->RGBColor[1, 0, 0]],
           MathGR`tensor`U2]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6082090446221323`*^9, 3.608209121174518*^9, {3.608209216198552*^9, 
   3.608209229265085*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Pd", "[", 
     RowBox[{
      RowBox[{"\[Eta]", "[", "__", "]"}], ",", "_"}], "]"}], "]"}], ":=", 
   "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Pd", "[", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", "__", "]"}], ",", "_"}], "]"}], "]"}], ":=", 
   "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Pd", "[", 
     RowBox[{
      RowBox[{"A", "[", "__", "]"}], ",", "_D2"}], "]"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Pd", "[", 
     RowBox[{
      RowBox[{"Pd", "[", 
       RowBox[{
        RowBox[{"A", "[", "__", "]"}], ",", "_"}], "]"}], ",", "_D2"}], "]"}],
     "]"}], ":=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5925628452449293`*^9, 3.592562850285047*^9}, {
  3.592565017843031*^9, 3.592565018574593*^9}, {3.592565716957241*^9, 
  3.592565728752329*^9}, {3.5973999375013027`*^9, 3.59739994776685*^9}, {
  3.5973999870445127`*^9, 3.597399987232614*^9}, {3.597400274152153*^9, 
  3.597400280563019*^9}, {3.597403288810761*^9, 3.597403289152582*^9}, {
  3.598761361865637*^9, 3.598761383182871*^9}}],

Cell["Now we decompose R[ ].", "Text",
 CellChangeTimes->{{3.592565784202579*^9, 3.592565807553802*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R\[Bullet]decomp", "=", 
  RowBox[{
   RowBox[{"DecompSe", "[", 
    RowBox[{
     RowBox[{"R", "[", "]"}], "//", "Simp"}], "]"}], "//", 
   "Simp"}]}]], "Input",
 CellChangeTimes->{{3.592563845504451*^9, 3.592563848330171*^9}, {
  3.5925650272364273`*^9, 3.592565061191041*^9}, {3.597392818949726*^9, 
  3.597392823717999*^9}, {3.608209173122005*^9, 3.608209173862835*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`tensor`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`tensor`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Eta]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Eta]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"\[Gamma]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`tensor`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Alpha]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"\[Beta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["A",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->RGBColor[1, 0, 0]],
             MathGR`tensor`U2], ""},
           {"", 
            TagBox[
             StyleBox["\<\"\[Delta]\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`D1]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"]}],
     "mgrPdT"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Eta]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Alpha]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\<\"\[Beta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}], " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      AdjustmentBox["\[Eta]",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"\[Gamma]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\<\"\[Delta]\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`U1]},
         {"", ""}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.597392820463347*^9, 3.597392830233582*^9}, {
   3.597392878962429*^9, 3.597392885580761*^9}, {3.5973996592062683`*^9, 
   3.597399693669379*^9}, 3.597399787057651*^9, {3.5974000019285383`*^9, 
   3.597400024537915*^9}, 3.597400301262657*^9, 3.59740037355904*^9, 
   3.597400416937289*^9, 3.597401703997827*^9, 3.5974018561457853`*^9, 
   3.597402192218401*^9, 3.597402252807878*^9, 3.597402704589501*^9, 
   3.59740325843814*^9, 3.597403291760811*^9, {3.5974033569051027`*^9, 
   3.597403360080337*^9}, 3.597403445637781*^9, 3.597404194302657*^9, 
   3.5974042247010117`*^9, {3.5974048790002947`*^9, 3.5974048937843943`*^9}, {
   3.597404958855558*^9, 3.5974049613426733`*^9}, {3.5974050292030487`*^9, 
   3.597405032306522*^9}, 3.597406190535117*^9, {3.5974066348413677`*^9, 
   3.597406663979579*^9}, 3.597407424004333*^9, 3.597407982941352*^9, 
   3.5974080759018927`*^9, 3.597408271769603*^9, 3.597409175868773*^9, 
   3.597409256834408*^9, 3.597409297412675*^9, 3.597409360274295*^9, 
   3.597413067464963*^9, 3.598259030956201*^9, 3.598263630116592*^9, 
   3.598761353546667*^9, 3.598761387409399*^9, 3.598852365427487*^9, 
   3.5988524393738947`*^9, 3.5988525805297127`*^9, 3.598870365880904*^9, 
   3.598897611034486*^9, {3.598942714916583*^9, 3.598942742381261*^9}, 
   3.60820857150176*^9, 3.608208650552773*^9, 3.608209044793696*^9, 
   3.608209121343795*^9, 3.608209174321377*^9, 3.608209231942994*^9}]
}, Open  ]],

Cell["\<\
To find the result in covariant form, we try to rewrite A in terms of F. The \
TrySimp utility is provided in ibp.m\
\>", "Text",
 CellChangeTimes->{{3.592565814753924*^9, 3.592565850559642*^9}, {
  3.597400025892536*^9, 3.597400028016588*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R\[Bullet]decomp\[Bullet]final", "=", 
  RowBox[{"TrySimp", "[", 
   RowBox[{"R\[Bullet]decomp", ",", " ", 
    RowBox[{
     RowBox[{"a_.", " ", "+", " ", 
      RowBox[{"b_.", " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          SubscriptBox["\[CapitalSampi]", 
           TagBox[
            StyleBox["\[Beta]_",
             FontColor->GrayLevel[0]],
            MathGR`tensor`D1]], 
          TagBox[
           RowBox[{
            AdjustmentBox["A",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["m_",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], ""},
               {"", 
                TagBox[
                 StyleBox["\[Alpha]_",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                "ItemsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPd"], ")"}]}]}], " ", ":>", " ", 
     RowBox[{"a", " ", "+", " ", 
      RowBox[{"Simp", "[", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["F",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {
                TagBox[
                 StyleBox["m",
                  FontColor->RGBColor[1, 0, 0]],
                 MathGR`tensor`U2], "", ""},
               {"", 
                TagBox[
                 StyleBox["\[Alpha]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1], 
                TagBox[
                 StyleBox["\[Beta]",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`D1]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                "ItemsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], " ", "+", " ", 
          TagBox[
           RowBox[{
            SubscriptBox["\[CapitalSampi]", 
             TagBox[
              StyleBox["\[Alpha]",
               FontColor->GrayLevel[0]],
              MathGR`tensor`D1]], 
            TagBox[
             RowBox[{
              AdjustmentBox["A",
               BoxMargins->{{0, -0.2}, {0, 0}}], 
              StyleBox[GridBox[{
                 {
                  TagBox[
                   StyleBox["m",
                    FontColor->RGBColor[1, 0, 0]],
                   MathGR`tensor`U2], ""},
                 {"", 
                  TagBox[
                   StyleBox["\[Beta]",
                    FontColor->GrayLevel[0]],
                   MathGR`tensor`D1]}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                  "Rows" -> {
                    Offset[0.2], {
                    Offset[0.]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}, "Items" -> {}, 
                  "ItemsIndexed" -> {}}],
               FontSize->10]}],
             "mgrTsr"]}],
           "mgrPd"]}], ")"}]}], "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.592565067138731*^9, 3.592565134473177*^9}, {
   3.59256527458284*^9, 3.59256527691647*^9}, {3.592565368948697*^9, 
   3.592565371508411*^9}, {3.5973914782367163`*^9, 3.597391485136815*^9}, {
   3.597392955179027*^9, 3.597392955405405*^9}, {3.598942730767929*^9, 
   3.598942734118586*^9}, {3.598942822540876*^9, 3.598942875152926*^9}, 
   3.598942912590366*^9, {3.6082091034374847`*^9, 3.608209107031839*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["F",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"a\"\>",
           FontColor->RGBColor[1, 0, 0]],
          MathGR`tensor`U2], "", ""},
        {"", 
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`D1], 
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`D1]}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     TagBox[
      RowBox[{
       AdjustmentBox["\[CapitalSampi]",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {""},
          {
           TagBox[
            StyleBox["\<\"\[Delta]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`D1]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"], 
     TagBox[
      RowBox[{
       AdjustmentBox["A",
        BoxMargins->{{0, -0.2}, {0, 0}}], 
       StyleBox[GridBox[{
          {
           TagBox[
            StyleBox["\<\"a\"\>",
             FontColor->RGBColor[1, 0, 0]],
            MathGR`tensor`U2], ""},
          {"", 
           TagBox[
            StyleBox["\<\"\[Gamma]\"\>",
             FontColor->GrayLevel[0]],
            MathGR`tensor`D1]}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        FontSize->10]}],
      "mgrTsr"]}],
    "mgrPdT"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["\[Eta]",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Alpha]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`U1], 
         TagBox[
          StyleBox["\<\"\[Gamma]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`U1]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}], " ", 
  RowBox[{"(", 
   TagBox[
    RowBox[{
     AdjustmentBox["\[Eta]",
      BoxMargins->{{0, -0.2}, {0, 0}}], 
     StyleBox[GridBox[{
        {
         TagBox[
          StyleBox["\<\"\[Beta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`U1], 
         TagBox[
          StyleBox["\<\"\[Delta]\"\>",
           FontColor->GrayLevel[0]],
          MathGR`tensor`U1]},
        {"", ""}
       },
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      FontSize->10]}],
    "mgrTsr"], ")"}]}]], "Output",
 CellChangeTimes->{{3.608209109649824*^9, 3.6082091223364983`*^9}, 
   3.608209176390728*^9, 3.608209234505225*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R\[Bullet]decomp\[Bullet]final", "//", "ToTeX"}]], "Input",
 CellChangeTimes->{{3.5989427475875597`*^9, 3.598942753109572*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Hint: set ToTexTemplate = False to output equation \
only.\"\>"], "Print",
 CellChangeTimes->{3.608208573191805*^9, 3.608208652081532*^9, 
  3.608209045131516*^9, 3.608209122700591*^9, 3.608209236366522*^9}],

Cell[BoxData["\<\"%Generated by MathGR/typeset.m, Sun 4 May 2014 17:20:36.\\n\
\\\\documentclass{revtex4}\\n\\\\usepackage{breqn}\\n\\\\begin{document}\\n\\\
\\begin{dmath}\\n-\\\\frac{1}{2} F{}^a{}_{\\\\alpha }{}_{\\\\beta } \
\\\\partial_{\\\\delta }A{}^a{}_{\\\\gamma } \\\\eta {}^{\\\\alpha \
}{}^{\\\\gamma } \\\\eta {}^{\\\\beta }{}^{\\\\delta \
}\\n\\\\end{dmath}\\n\\\\end{document}\\n\"\>"], "Print",
 CellChangeTimes->{3.608208573191805*^9, 3.608208652081532*^9, 
  3.608209045131516*^9, 3.608209122700591*^9, 3.60820923637329*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
ADM decomposition of FRW universe (frwadm.m)\
\>", "Section",
 CellChangeTimes->{{3.59255725693364*^9, 3.592557271115985*^9}, {
  3.592566322322671*^9, 3.592566326371385*^9}}],

Cell["\<\
The frwadm.m is the setup for FRW universe with ADM type perturbations. Here \
we illuatrate the usage of this module by calculating second order \
cosmological perturbations.\
\>", "Text",
 CellChangeTimes->{{3.5925663283418407`*^9, 3.592566526740505*^9}, {
  3.592623248046653*^9, 3.5926232487204943`*^9}}],

Cell[BoxData[{
 RowBox[{"Remove", "[", 
  RowBox[{
  "a", ",", "\[Alpha]", ",", "\[Beta]", ",", "b", ",", "h", ",", "\[Eta]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/util.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/ibp.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/frwadm.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<MathGR/typeset.m\>\""}]}], "Input",
 CellChangeTimes->{{3.592565911778283*^9, 3.592565950142881*^9}, {
   3.592566071705748*^9, 3.592566103393549*^9}, 3.592566541700692*^9, {
   3.592623230329701*^9, 3.592623238765238*^9}, {3.5926232900686293`*^9, 
   3.5926232921910667`*^9}, {3.598263620644392*^9, 3.59826362508084*^9}, 
   3.598852496071621*^9}],

Cell["\<\
Here we define the indices explicitly, because we want to use LatinIdx \
instead of GreekIdx for 3 spatial dimensions. 

We neglect boundary terms. Also \[Phi] is set to be homogeneous and isotropic \
(i.e. the calculation is done in \[Zeta]-gauge). \
\>", "Text",
 CellChangeTimes->{{3.592566547259996*^9, 3.592566620248598*^9}}],

Cell[BoxData[{
 RowBox[{"DeclareIdx", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"UP", ",", "DN"}], "}"}], ",", "DefaultDim", ",", "LatinIdx", ",",
    "Black"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PdHold", "[", "__", "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PdT", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"PdVars", "[", 
     RowBox[{"_DN", ",", " ", "___"}], "]"}]}], "]"}], ":=", "0"}]}], "Input",\

 CellChangeTimes->{{3.592565911778283*^9, 3.592565950142881*^9}, {
   3.592566071705748*^9, 3.592566103393549*^9}, 3.592566541700692*^9, {
   3.59262325768673*^9, 3.592623284368868*^9}, {3.598759021892828*^9, 
   3.598759029035727*^9}, {3.598852413428625*^9, 3.598852429195911*^9}}],

Cell["\<\
The action is calculated using the ADM curvature, and the decomposed scalar \
field. DecompG2H is a helper function to decompose 3+1 dimensional quantities \
into 3 and 1.\
\>", "Text",
 CellChangeTimes->{{3.592566633154161*^9, 3.592566633519821*^9}, {
  3.592566666147599*^9, 3.592566722486635*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s012", "=", 
  RowBox[{
   RowBox[{"Sqrtg", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"RADM", "[", "]"}], "/", "2"}], "+", 
      RowBox[{"DecompG2H", "[", 
       RowBox[{"X", "[", "\[Phi]", "]"}], "]"}], "-", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], ")"}]}], "//", 
   RowBox[{"SS", "[", "2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592565970960834*^9, 3.59256597896949*^9}, {
  3.5925660621883097`*^9, 3.592566079499516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}], "+", 
  RowBox[{"Eps", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Alpha]"}], "-", 
     RowBox[{"9", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Zeta]"}], "+", 
     RowBox[{"2", " ", "a", " ", "H", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Beta]"}],
        "mgrPdT"], ")"}]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["a", "3"], " ", "H", " ", 
      OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
     RowBox[{"2", " ", "a", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Zeta]"}],
        "mgrPdT"], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{
      FractionBox["3", "2"], " ", 
      SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
     RowBox[{
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["Eps", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", "\[Alpha]", " ", "\[Zeta]"}], "-", 
     RowBox[{
      FractionBox["27", "2"], " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["H", "2"], " ", 
      SuperscriptBox["\[Zeta]", "2"]}], "-", 
     RowBox[{"2", " ", "a", " ", "H", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Beta]"}],
        "mgrPdT"], ")"}]}], "+", 
     RowBox[{"2", " ", "a", " ", "H", " ", "\[Zeta]", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Beta]"}],
        "mgrPdT"], ")"}]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "\[Beta]"}],
         "mgrPdT"], ")"}], "2"], 
      RowBox[{"2", " ", "a"}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "\[Beta]"}],
         "mgrPdT"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "\[Beta]"}],
         "mgrPdT"], ")"}]}], 
      RowBox[{"2", " ", "a"}]], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["a", "3"], " ", "H", " ", "\[Alpha]", " ", 
      OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
     RowBox[{"18", " ", 
      SuperscriptBox["a", "3"], " ", "H", " ", "\[Zeta]", " ", 
      OverscriptBox["\[Zeta]", "\[Bullet]"]}], "+", 
     RowBox[{"2", " ", "a", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Beta]"}],
        "mgrPdT"], ")"}], " ", 
      OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox[
       OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{"2", " ", "a", " ", "H", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         AdjustmentBox["b",
          BoxMargins->{{0, -0.2}, {0, 0}}], 
         StyleBox[GridBox[{
            {""},
            {
             TagBox[
              StyleBox["\<\"a\"\>",
               FontColor->GrayLevel[0]],
              MathGR`tensor`DN]}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}],
          FontSize->10]}],
        "mgrTsr"], ")"}], " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Zeta]"}],
        "mgrPdT"], ")"}]}], "+", 
     RowBox[{"2", " ", "a", " ", "H", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Beta]"}],
        "mgrPdT"], ")"}], " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Zeta]"}],
        "mgrPdT"], ")"}]}], "-", 
     RowBox[{"a", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "\[Zeta]"}],
         "mgrPdT"], ")"}], "2"]}], "-", 
     RowBox[{"2", " ", "a", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Zeta]"}],
        "mgrPdT"], ")"}]}], "-", 
     RowBox[{"2", " ", "a", " ", "\[Zeta]", " ", 
      RowBox[{"(", 
       TagBox[
        RowBox[{
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], 
         TagBox[
          RowBox[{
           AdjustmentBox["\[CapitalSampi]",
            BoxMargins->{{0, -0.2}, {0, 0}}], 
           StyleBox[GridBox[{
              {""},
              {
               TagBox[
                StyleBox["\<\"a\"\>",
                 FontColor->GrayLevel[0]],
                MathGR`tensor`DN]}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            FontSize->10]}],
          "mgrTsr"], "\[Zeta]"}],
        "mgrPdT"], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["\[Alpha]", "2"], " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
     RowBox[{
      FractionBox["3", "2"], " ", 
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", "\[Zeta]", " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     RowBox[{
      FractionBox["9", "4"], " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["\[Zeta]", "2"], " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], "\[Beta]"}],
         "mgrPdT"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPdT"], ")"}]}], "a"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPdT"], ")"}], "2"], 
      RowBox[{"4", " ", "a"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPdT"], ")"}], " ", 
       RowBox[{"(", 
        TagBox[
         RowBox[{
          TagBox[
           RowBox[{
            AdjustmentBox["\[CapitalSampi]",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"a\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"], 
          TagBox[
           RowBox[{
            AdjustmentBox["b",
             BoxMargins->{{0, -0.2}, {0, 0}}], 
            StyleBox[GridBox[{
               {""},
               {
                TagBox[
                 StyleBox["\<\"b\"\>",
                  FontColor->GrayLevel[0]],
                 MathGR`tensor`DN]}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             FontSize->10]}],
           "mgrTsr"]}],
         "mgrPdT"], ")"}]}], 
      RowBox[{"4", " ", "a"}]], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", "\[Zeta]", " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
     RowBox[{
      FractionBox["9", "2"], " ", 
      SuperscriptBox["a", "3"], " ", 
      SuperscriptBox["\[Zeta]", "2"], " ", 
      RowBox[{"V", "[", "\[Phi]", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.59256607655898*^9, 3.592566107542033*^9, 3.5925662383004627`*^9, 
   3.592566910169251*^9, {3.592623312401331*^9, 3.592623332656321*^9}, {
   3.592623392050716*^9, 3.592623405163845*^9}, {3.592623447108526*^9, 
   3.592623454072809*^9}, 3.596959044261691*^9, 3.598259052075189*^9, 
   3.598263630515209*^9, 3.598759050921363*^9, 3.598761399927432*^9, 
   3.598852365900182*^9, 3.598852439786846*^9, 3.598852581019349*^9, 
   3.598870366303442*^9, 3.598897611500044*^9, 3.598942715421636*^9, 
   3.598942961060727*^9, 3.598943002025024*^9, 3.608208573829883*^9, 
   3.6082086526679068`*^9, 3.60820904560439*^9, 3.6082091232003727`*^9}]
}, Open  ]],

Cell["\<\
The first order action. Here OO[n] is defined in util.m, which collect order \
n terms w.r.t. Eps\
\>", "Text",
 CellChangeTimes->{{3.59256673780443*^9, 3.592566775771201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s1", "=", 
  RowBox[{"s012", "//", 
   RowBox[{"OO", "[", "1", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566089724766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Alpha]"}], "-", 
  RowBox[{"9", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", "\[Zeta]"}], "+", 
  RowBox[{"2", " ", "a", " ", "H", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[Beta]"}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    TagBox[
     RowBox[{
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], 
      TagBox[
       RowBox[{
        AdjustmentBox["\[CapitalSampi]",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], "\[Zeta]"}],
     "mgrPdT"], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "+", 
  RowBox[{
   FractionBox["3", "2"], " ", 
   SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "\[Bullet]"], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", "\[Alpha]", " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", "\[Zeta]", " ", 
   RowBox[{"V", "[", "\[Phi]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.5925660911681967`*^9, 3.592566111248671*^9}, 
   3.592566240943439*^9, 3.592566910527968*^9, {3.592623312650408*^9, 
   3.592623333084898*^9}, {3.5926233924729033`*^9, 3.592623405552698*^9}, {
   3.592623447314098*^9, 3.5926234542888308`*^9}, 3.596959044307406*^9, 
   3.59825905632586*^9, 3.5982636305840473`*^9, 3.598759054722919*^9, 
   3.598761404702606*^9, 3.5988523659440737`*^9, 3.5988524398641367`*^9, 
   3.598852581061274*^9, 3.598870366347126*^9, 3.598897611549605*^9, 
   3.598942715466284*^9, 3.5989429611019983`*^9, 3.598943002064163*^9, 
   3.608208573862389*^9, 3.6082086526999903`*^9, 3.60820904565841*^9, 
   3.608209123250404*^9}]
}, Open  ]],

Cell["\<\
The background EoM is solved (by varying the 1st order action) and added into \
SimpHook.\
\>", "Text",
 CellChangeTimes->{{3.59256679734159*^9, 3.5925668247144623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimpHook", "=", 
  RowBox[{"SimpHook", "~", "Union", "~", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SolveExpr", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"s1", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"IbpVariation", "[", 
             RowBox[{"s1", ",", "\[Zeta]"}], "]"}], ",", "\[Zeta]"}], "]"}], 
          "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "[", "\[Phi]", "]"}], ",", 
         RowBox[{
          RowBox[{"Pd", "[", 
           RowBox[{"\[Phi]", ",", 
            RowBox[{"DE", "@", "0"}]}], "]"}], "^", "2"}]}], "}"}]}], "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.5925661896593227`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DefaultDim", "\[Rule]", "3"}], ",", 
   RowBox[{
    OverscriptBox["a", "\[Bullet]"], "\[Rule]", 
    RowBox[{"a", " ", "H"}]}], ",", 
   RowBox[{
    OverscriptBox["a", "\[Bullet]\[Bullet]"], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", 
      SuperscriptBox["H", "2"]}], "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{
    OverscriptBox["H", "\[Bullet]"], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["H", "2"]}], " ", "\[Epsilon]"}]}], ",", 
   RowBox[{
    OverscriptBox["H", "\[Bullet]\[Bullet]"], "\[Rule]", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["H", "3"], " ", 
      SuperscriptBox["\[Epsilon]", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["H", "3"], " ", "\[Epsilon]", " ", "\[Eta]"}]}]}], ",", 
   RowBox[{
    OverscriptBox["H", "\[Bullet]\[Bullet]\[Bullet]"], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "6"}], " ", 
      SuperscriptBox["H", "4"], " ", 
      SuperscriptBox["\[Epsilon]", "3"]}], "+", 
     RowBox[{"7", " ", 
      SuperscriptBox["H", "4"], " ", 
      SuperscriptBox["\[Epsilon]", "2"], " ", "\[Eta]"}], "-", 
     RowBox[{
      SuperscriptBox["H", "4"], " ", "\[Epsilon]", " ", 
      SuperscriptBox["\[Eta]", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["H", "4"], " ", "\[Epsilon]", " ", "\[Eta]", " ", 
      "\[Eta]2"}]}]}], ",", 
   RowBox[{
    OverscriptBox["\[Epsilon]", "\[Bullet]"], "\[Rule]", 
    RowBox[{"H", " ", "\[Epsilon]", " ", "\[Eta]"}]}], ",", 
   RowBox[{
    OverscriptBox["\[Eta]", "\[Bullet]"], "\[Rule]", 
    RowBox[{"H", " ", "\[Eta]", " ", "\[Eta]2"}]}], ",", 
   RowBox[{
    OverscriptBox["\[Eta]2", "\[Bullet]"], "\[Rule]", 
    RowBox[{"H", " ", "\[Eta]2", " ", "\[Eta]3"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     OverscriptBox["\[Phi]", "\[Bullet]"], "2"], "\[Rule]", 
    RowBox[{"2", " ", 
     SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}], ",", 
   RowBox[{
    RowBox[{"V", "[", "\[Phi]", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["H", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["H", "2"], " ", "\[Epsilon]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5925661330107822`*^9, 3.5925662430249662`*^9}, 
   3.592566910606022*^9, {3.5926233127432632`*^9, 3.592623333263301*^9}, {
   3.592623392632369*^9, 3.5926234056957607`*^9}, {3.592623447372363*^9, 
   3.592623454358177*^9}, 3.5969590443331614`*^9, 3.598259059762434*^9, 
   3.598263630599455*^9, 3.598759059048648*^9, 3.598761406302848*^9, 
   3.598852365986247*^9, 3.598852439888967*^9, 3.598852581096834*^9, 
   3.598870366366914*^9, 3.598897611577057*^9, 3.598942715500927*^9, 
   3.5989429611369047`*^9, 3.5989430020979548`*^9, 3.60820857389021*^9, 
   3.608208652752613*^9, 3.608209045693379*^9, 3.6082091232946653`*^9}]
}, Open  ]],

Cell["The second order action.", "Text",
 CellChangeTimes->{{3.592566834006785*^9, 3.5925668382864532`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"s012", "//", 
     RowBox[{"OO", "[", "2", "]"}]}], "//", "Fourier2"}], "//", 
   "Ibp"}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566131041789*^9}, {3.598759035823015*^9, 
   3.5987590368962507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"]}], "+", 
  RowBox[{"2", " ", "a", " ", "H", " ", 
   SuperscriptBox["k", "2"], " ", "\[Alpha]", " ", "\[Beta]"}], "+", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Epsilon]"}], "+", 
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["k", "2"], " ", "\[Alpha]", " ", "\[Zeta]"}], "+", 
  RowBox[{"a", " ", 
   SuperscriptBox["k", "2"], " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["k", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      TagBox[
       RowBox[{
        AdjustmentBox["b",
         BoxMargins->{{0, -0.2}, {0, 0}}], 
        StyleBox[GridBox[{
           {""},
           {
            TagBox[
             StyleBox["\<\"a\"\>",
              FontColor->GrayLevel[0]],
             MathGR`tensor`DN]}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         FontSize->10]}],
       "mgrTsr"], ")"}], "2"]}], 
   RowBox[{"4", " ", "a"}]], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "3"], " ", "H", " ", "\[Alpha]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["k", "2"], " ", "\[Beta]", " ", 
   OverscriptBox["\[Zeta]", "\[Bullet]"]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "3"], " ", 
   SuperscriptBox[
    OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.5925662466214867`*^9, 3.5925669107414913`*^9, {3.592623312865692*^9, 
   3.592623333574745*^9}, {3.592623392767048*^9, 3.59262340582801*^9}, {
   3.5926234474911623`*^9, 3.5926234544783916`*^9}, 3.596959044396988*^9, 
   3.598259061420475*^9, 3.598263630644785*^9, 3.598759062426592*^9, 
   3.598761407928206*^9, 3.598852366299086*^9, 3.598852440162516*^9, 
   3.598852581234374*^9, 3.598870366465105*^9, 3.5988976116896152`*^9, 
   3.598942715795418*^9, 3.598942961288905*^9, 3.598943002254052*^9, 
   3.60820857413083*^9, 3.6082086529930983`*^9, 3.6082090459313507`*^9, 
   3.6082091236084213`*^9}]
}, Open  ]],

Cell["\<\
Solving constraints in the second order action.\
\>", "Text",
 CellChangeTimes->{{3.5925668477139378`*^9, 3.592566858279282*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solCons", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", "\[Beta]"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"s2", ",", 
          RowBox[{"b", "[", 
           RowBox[{"DN", "@", "\"\<a\>\""}], "]"}]}], "]"}], "\[Equal]", 
        "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
       RowBox[{"b", "[", 
        RowBox[{"DN", "@", "\"\<a\>\""}], "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566117708316*^9}, {3.592566252107847*^9, 
   3.592566254434847*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Alpha]", "\[Rule]", 
    FractionBox[
     OverscriptBox["\[Zeta]", "\[Bullet]"], "H"]}], ",", 
   RowBox[{"\[Beta]", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["k", "2"], " ", "\[Zeta]"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "H", " ", "\[Epsilon]", " ", 
        OverscriptBox["\[Zeta]", "\[Bullet]"]}]}], 
      RowBox[{"H", " ", 
       SuperscriptBox["k", "2"]}]]}]}], ",", 
   RowBox[{
    TagBox[
     RowBox[{
      AdjustmentBox["b",
       BoxMargins->{{0, -0.2}, {0, 0}}], 
      StyleBox[GridBox[{
         {""},
         {
          TagBox[
           StyleBox["\<\"a\"\>",
            FontColor->GrayLevel[0]],
           MathGR`tensor`DN]}
        },
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       FontSize->10]}],
     "mgrTsr"], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.592566255651764*^9, 3.5925669108105917`*^9, {3.5926233129715157`*^9, 
   3.592623334104526*^9}, {3.592623392939781*^9, 3.592623405988326*^9}, {
   3.5926234475277653`*^9, 3.592623454553454*^9}, 3.596959044418895*^9, 
   3.598259065068953*^9, 3.598263630657868*^9, 3.598759065137192*^9, 
   3.5987614117984324`*^9, 3.5988523663731623`*^9, 3.598852440249073*^9, 
   3.598852581261929*^9, 3.5988703664811974`*^9, 3.5988976117058973`*^9, 
   3.598942715864132*^9, 3.598942961320668*^9, 3.598943002290593*^9, 
   3.608208574172327*^9, 3.608208653028666*^9, 3.6082090459673243`*^9, 
   3.608209123837851*^9}]
}, Open  ]],

Cell["\<\
Inserting the solved constraints, and do integration by parts, we get the \
desired second order action.\
\>", "Text",
 CellChangeTimes->{{3.5925668657837667`*^9, 3.5925668890597563`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2Solved", "=", 
  RowBox[{
   RowBox[{"s2", "/.", "solCons"}], "//", 
   RowBox[{
    RowBox[{"Ibp", "[", 
     RowBox[{"#", ",", 
      RowBox[{"\"\<Rank\>\"", "\[Rule]", "IbpStd2"}]}], "]"}], 
    "&"}]}]}]], "Input",
 CellChangeTimes->{{3.592565904539886*^9, 3.592565904542253*^9}, {
   3.592565936939898*^9, 3.592565992536055*^9}, 3.592566052381837*^9, {
   3.5925660860275183`*^9, 3.592566117708316*^9}, {3.592566252107847*^9, 
   3.592566260591505*^9}, {3.598852354339527*^9, 3.5988523595395813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "a"}], " ", 
   SuperscriptBox["k", "2"], " ", "\[Epsilon]", " ", 
   SuperscriptBox["\[Zeta]", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["a", "3"], " ", "\[Epsilon]", " ", 
   SuperscriptBox[
    OverscriptBox["\[Zeta]", "\[Bullet]"], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.5925662626264563`*^9, 3.592566911054432*^9, {3.592623313274959*^9, 
   3.592623334431535*^9}, {3.5926233934436283`*^9, 3.59262340644344*^9}, {
   3.5926234477124968`*^9, 3.592623454748464*^9}, 3.5969590444703007`*^9, 
   3.5982590686322308`*^9, 3.598263630686297*^9, 3.5987590695612173`*^9, 
   3.5987614136036777`*^9, 3.5988523665559053`*^9, 3.5988524403536797`*^9, 
   3.598852581292733*^9, 3.598870366520563*^9, 3.598897611748088*^9, 
   3.598942715931431*^9, 3.5989429613906107`*^9, 3.598943002366852*^9, 
   3.60820857428617*^9, 3.608208653132022*^9, 3.6082090460702457`*^9, 
   3.6082091239836283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2Solved", "//", "ToTeX"}]], "Input",
 CellChangeTimes->{{3.598943010335799*^9, 3.598943013087586*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Hint: set ToTexTemplate = False to output equation \
only.\"\>"], "Print",
 CellChangeTimes->{3.608208574379209*^9, 3.608208653248886*^9, 
  3.6082090462362547`*^9, 3.608209124031909*^9}],

Cell[BoxData["\<\"%Generated by MathGR/typeset.m, Sun 4 May 2014 17:18:43.\\n\
\\\\documentclass{revtex4}\\n\\\\usepackage{breqn}\\n\\\\begin{document}\\n\\\
\\begin{dmath}\\n-a k^2 \\\\epsilon  \\\\zeta ^2\\n + a^3 \\\\epsilon  \
\\\\dot\\\\zeta {}^2\\n\\\\end{dmath}\\n\\\\end{document}\\n\"\>"], "Print",
 CellChangeTimes->{3.608208574379209*^9, 3.608208653248886*^9, 
  3.6082090462362547`*^9, 3.608209124032651*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"PdHold", ",", "h"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"clean", " ", "up", " ", "for", " ", "non"}], "-", 
    RowBox[{"standard", " ", "definition"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.592623340769743*^9, 3.592623381390614*^9}, {
  3.5926234309349737`*^9, 3.5926234312312613`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1025},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
InputAliases->{"td" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td0" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`DE]}}, 
        ColumnSpacings -> 0, RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], 
  "td0d0" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`DE], 
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`DE]}}, 
        ColumnSpacings -> 0, RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], 
  "td0u0" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`UE]}, {
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`DE], 
          ""}}, ColumnSpacings -> 0, RowSpacings -> 0], FontSize -> 10]}], 
    "mgrTsr"], "td1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`D1]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`D1]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "td1d1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`D1], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`D1]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td1d1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`D1], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`D1]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "td1u1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`U1]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`D1], ""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td1u1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`U1]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`D1], ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "td2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`D2]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`D2]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "td2d2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`D2], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`D2]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td2d2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`D2], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`D2]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "td2u2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`U2]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`D2], ""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "td2u2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`U2]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`D2], ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tdd" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tddd" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", "", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdddd" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", "", "", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tde" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`DE]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdede" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`DE], 
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`DE]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdeue" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`UE]}, {
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`DE], ""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdt" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdt" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tdtdt" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`DTot], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdtdt" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", ""}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`DTot], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tdtut" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`UTot]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`DTot], ""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tdtut" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`UTot]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`DTot], ""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tdu" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP]}, {
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], ""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tp" -> TagBox[
    RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\[SelectionPlaceholder]\"", FontColor -> GrayLevel[0]], 
        MathGR`tensor`DN]], "\[Placeholder]"}], "mgrPd"], "tp" -> TagBox[
    RowBox[{
      TagBox[
       RowBox[{
         AdjustmentBox["\[CapitalSampi]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
         
         StyleBox[
          GridBox[{{""}, {
             TagBox[
              StyleBox[
              "\"\[SelectionPlaceholder]\"", FontColor -> GrayLevel[0]], 
              MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
          FontSize -> 10]}], "mgrTsr"], "\[Placeholder]"}], "mgrPdT"], "tp0" -> 
  OverscriptBox["\[SelectionPlaceholder]", "\[Bullet]"], "tp1" -> TagBox[
    RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox["\"\[SelectionPlaceholder]\"", FontColor -> GrayLevel[0]], 
        MathGR`typeset`Private`D1]], "\[Placeholder]"}], "mgrPd"], "tp1" -> 
  TagBox[
    RowBox[{
      TagBox[
       RowBox[{
         AdjustmentBox["\[CapitalSampi]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
         
         StyleBox[
          GridBox[{{""}, {
             TagBox[
              StyleBox[
              "\"\[SelectionPlaceholder]\"", FontColor -> GrayLevel[0]], 
              MathGR`tensor`D1]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
          FontSize -> 10]}], "mgrTsr"], "\[Placeholder]"}], "mgrPdT"], "tp2" -> 
  TagBox[
    RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox[
        "\"\[SelectionPlaceholder]\"", FontColor -> RGBColor[1, 0, 0]], 
        MathGR`typeset`Private`D2]], "\[Placeholder]"}], "mgrPd"], "tp2" -> 
  TagBox[
    RowBox[{
      TagBox[
       RowBox[{
         AdjustmentBox["\[CapitalSampi]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
         
         StyleBox[
          GridBox[{{""}, {
             TagBox[
              StyleBox[
              "\"\[SelectionPlaceholder]\"", FontColor -> RGBColor[1, 0, 0]], 
              MathGR`tensor`D2]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
          FontSize -> 10]}], "mgrTsr"], "\[Placeholder]"}], "mgrPdT"], "tpt" -> 
  TagBox[
    RowBox[{
      SubscriptBox["\[CapitalSampi]", 
       TagBox[
        StyleBox[
        "\"\[SelectionPlaceholder]\"", FontColor -> RGBColor[0, 0, 1]], 
        MathGR`typeset`Private`DTot]], "\[Placeholder]"}], "mgrPd"], "tpt" -> 
  TagBox[
    RowBox[{
      TagBox[
       RowBox[{
         AdjustmentBox["\[CapitalSampi]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
         
         StyleBox[
          GridBox[{{""}, {
             TagBox[
              StyleBox[
              "\"\[SelectionPlaceholder]\"", FontColor -> RGBColor[0, 0, 1]], 
              MathGR`tensor`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
          FontSize -> 10]}], "mgrTsr"], "\[Placeholder]"}], "mgrPdT"], "tu" -> 
  TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP]}, {""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tu0" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`UE]}, {
         ""}}, ColumnSpacings -> 0, RowSpacings -> 0], FontSize -> 10]}], 
    "mgrTsr"], "tu0d0" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`UE], 
          ""}, {"", 
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`DE]}}, 
        ColumnSpacings -> 0, RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], 
  "tu0u0" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`UE], 
          TagBox[
           StyleBox["0", FontColor -> GrayLevel[0.5]], MathGR`tensor`UE]}, {
         "", ""}}, ColumnSpacings -> 0, RowSpacings -> 0], FontSize -> 10]}], 
    "mgrTsr"], "tu1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`U1]}, {""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tu1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`U1]}, {""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tu1d1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`U1], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`D1]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tu1d1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`U1], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`D1]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tu1u1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`U1], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`U1]}, {"", ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tu1u1" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`U1], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`typeset`Private`U1]}, {"", ""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tu2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`U2]}, {""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tu2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`U2]}, {""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tu2d2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`U2], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`D2]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tu2d2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`U2], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`D2]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tu2u2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`U2], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`tensor`U2]}, {"", ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tu2u2" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`U2], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[1, 0, 0]], 
           MathGR`typeset`Private`U2]}, {"", ""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tud" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tudd" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], "", ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`DN]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tue" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`UE]}, {""}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tuede" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`UE], ""}, {"", 
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`DE]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tueue" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`UE], 
          TagBox[
           StyleBox["\[Placeholder]", FontColor -> GrayLevel[0.5]], 
           MathGR`tensor`UE]}, {"", ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tut" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`UTot]}, {""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tut" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`UTot]}, {""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tutdt" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`UTot], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 0], 
       FontSize -> 10]}], "mgrTsr"], "tutdt" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`UTot], ""}, {"", 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`DTot]}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tutut" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`UTot], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`tensor`UTot]}, {"", ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tutut" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`UTot], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> RGBColor[0, 0, 1]], 
           MathGR`typeset`Private`UTot]}, {"", ""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tuu" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP]}, {"", ""}}, ColumnSpacings -> 0, RowSpacings -> 
        0], FontSize -> 10]}], "mgrTsr"], "tuuu" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP]}, {"", "", ""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"], "tuuuu" -> TagBox[
    RowBox[{
      AdjustmentBox[
      "\[SelectionPlaceholder]", BoxMargins -> {{0, -0.2}, {0, 0}}], 
      StyleBox[
       GridBox[{{
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP], 
          TagBox[
           StyleBox["\"\[Placeholder]\"", FontColor -> GrayLevel[0]], 
           MathGR`tensor`UP]}, {"", "", "", ""}}, ColumnSpacings -> 0, 
        RowSpacings -> 0], FontSize -> 10]}], "mgrTsr"]},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 95, 1, 92, "Title"],
Cell[677, 25, 849, 15, 106, "Text"],
Cell[CellGroupData[{
Cell[1551, 44, 164, 2, 80, "Section"],
Cell[1718, 48, 372, 8, 55, "Input"],
Cell[CellGroupData[{
Cell[2115, 60, 107, 1, 44, "Subsection"],
Cell[2225, 63, 138, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[2388, 70, 345, 8, 32, "Input"],
Cell[2736, 80, 1663, 44, 36, "Output"]
}, Open  ]],
Cell[4414, 127, 2546, 42, 403, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6997, 174, 146, 3, 44, "Subsection"],
Cell[7146, 179, 9897, 324, 139, "Text"],
Cell[17046, 505, 574, 19, 32, "Input"],
Cell[CellGroupData[{
Cell[17645, 528, 214, 5, 32, "Input"],
Cell[17862, 535, 1865, 59, 36, "Output"]
}, Open  ]],
Cell[19742, 597, 355, 7, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20134, 609, 109, 1, 44, "Subsection"],
Cell[20246, 612, 201, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[20472, 620, 3281, 111, 36, "Input"],
Cell[23756, 733, 2195, 63, 36, "Output"]
}, Open  ]],
Cell[25966, 799, 222, 4, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26225, 808, 110, 1, 44, "Subsection"],
Cell[26338, 811, 291, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[26654, 820, 435, 10, 32, "Input"],
Cell[27092, 832, 250, 6, 32, "Output"]
}, Open  ]],
Cell[27357, 841, 132, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[27514, 848, 2128, 71, 36, "Input"],
Cell[29645, 921, 1773, 46, 36, "Output"]
}, Open  ]],
Cell[31433, 970, 278, 7, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31748, 982, 133, 2, 44, "Subsection"],
Cell[31884, 986, 153, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[32062, 992, 1171, 38, 36, "Input"],
Cell[33236, 1032, 2235, 67, 36, "Output"]
}, Open  ]],
Cell[35486, 1102, 148, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[35659, 1109, 277, 7, 32, "Input"],
Cell[35939, 1118, 2868, 88, 36, "Output"]
}, Open  ]],
Cell[38822, 1209, 206, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[39053, 1217, 386, 11, 55, "Input"],
Cell[39442, 1230, 1374, 36, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40865, 1272, 119, 1, 44, "Subsection"],
Cell[40987, 1275, 159, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[41171, 1282, 1519, 53, 36, "Input"],
Cell[42693, 1337, 1324, 34, 36, "Output"]
}, Open  ]],
Cell[44032, 1374, 286, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[44343, 1383, 1516, 53, 36, "Input"],
Cell[45862, 1438, 2146, 62, 36, "Output"]
}, Open  ]],
Cell[48023, 1503, 121, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[48169, 1510, 796, 27, 36, "Input"],
Cell[48968, 1539, 650, 10, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49667, 1555, 119, 1, 44, "Subsection"],
Cell[49789, 1558, 225, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[50039, 1566, 351, 8, 32, "Input"],
Cell[50393, 1576, 3839, 120, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54281, 1702, 162, 2, 44, "Subsection"],
Cell[54446, 1706, 320, 6, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54803, 1717, 198, 4, 44, "Subsection"],
Cell[CellGroupData[{
Cell[55026, 1725, 849, 28, 36, "Input"],
Cell[55878, 1755, 2046, 60, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57961, 1820, 855, 28, 36, "Input"],
Cell[58819, 1850, 2034, 61, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60914, 1918, 109, 1, 80, "Section"],
Cell[61026, 1921, 235, 4, 55, "Input"],
Cell[CellGroupData[{
Cell[61286, 1929, 101, 1, 44, "Subsection"],
Cell[61390, 1932, 259, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[61674, 1941, 917, 31, 36, "Input"],
Cell[62594, 1974, 6080, 189, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68711, 2168, 142, 3, 32, "Input"],
Cell[68856, 2173, 35145, 1176, 84, "Output"]
}, Open  ]],
Cell[104016, 3352, 145, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[104186, 3359, 256, 6, 32, "Input"],
Cell[104445, 3367, 35139, 1176, 84, "Output"]
}, Open  ]],
Cell[139599, 4546, 286, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[139910, 4555, 270, 7, 32, "Input"],
Cell[140183, 4564, 10795, 354, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151027, 4924, 109, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[151161, 4929, 324, 8, 32, "Input"],
Cell[151488, 4939, 10931, 363, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162468, 5308, 108, 1, 44, "Subsection"],
Cell[162579, 5311, 203, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[162807, 5319, 1515, 53, 36, "Input"],
Cell[164325, 5374, 2117, 63, 36, "Output"]
}, Open  ]],
Cell[166457, 5440, 329, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[166811, 5450, 468, 13, 32, "Input"],
Cell[167282, 5465, 4123, 131, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171466, 5603, 115, 1, 80, "Section"],
Cell[171584, 5606, 285, 5, 55, "Input"],
Cell[171872, 5613, 186, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[172083, 5621, 626, 22, 32, "Input"],
Cell[172712, 5645, 793, 14, 32, "Output"]
}, Open  ]],
Cell[173520, 5662, 308, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[173853, 5673, 622, 22, 32, "Input"],
Cell[174478, 5697, 1574, 41, 36, "Output"]
}, Open  ]],
Cell[176067, 5741, 454, 9, 68, "Text"],
Cell[176524, 5752, 162, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[176711, 5759, 538, 16, 32, "Input"],
Cell[177252, 5777, 1615, 41, 36, "Output"]
}, Open  ]],
Cell[178882, 5821, 177, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[179084, 5829, 420, 13, 32, "Input"],
Cell[179507, 5844, 1400, 36, 36, "Output"]
}, Open  ]],
Cell[180922, 5883, 145, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[181092, 5890, 694, 18, 44, "Input"],
Cell[181789, 5910, 1231, 29, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183069, 5945, 229, 5, 80, "Section"],
Cell[183301, 5952, 398, 7, 99, "Input"],
Cell[183702, 5961, 580, 11, 70, "Text"],
Cell[184285, 5974, 997, 21, 77, "Input"],
Cell[185285, 5997, 665, 12, 87, "Text"],
Cell[CellGroupData[{
Cell[185975, 6013, 17274, 513, 161, "Input"],
Cell[203252, 6528, 15734, 502, 36, "Output"]
}, Open  ]],
Cell[219001, 7033, 1284, 36, 99, "Input"],
Cell[220288, 7071, 104, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[220417, 7076, 398, 9, 32, "Input"],
Cell[220818, 7087, 10901, 334, 47, "Output"]
}, Open  ]],
Cell[231734, 7424, 254, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[232013, 7433, 4381, 119, 36, "Input"],
Cell[236397, 7554, 4069, 137, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240503, 7696, 151, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[240679, 7702, 225, 3, 23, "Print"],
Cell[240907, 7707, 541, 7, 176, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[241509, 7721, 185, 4, 80, "Section"],
Cell[241697, 7727, 318, 6, 30, "Text"],
Cell[242018, 7735, 729, 13, 121, "Input"],
Cell[242750, 7750, 340, 7, 70, "Text"],
Cell[243093, 7759, 733, 17, 77, "Input"],
Cell[243829, 7778, 310, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[244164, 7788, 484, 13, 32, "Input"],
Cell[244651, 7803, 33043, 975, 164, "Output"]
}, Open  ]],
Cell[277709, 8781, 186, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[277920, 8789, 297, 6, 32, "Input"],
Cell[278220, 8797, 4507, 130, 47, "Output"]
}, Open  ]],
Cell[282742, 8930, 180, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[282947, 8938, 1061, 29, 32, "Input"],
Cell[284011, 8969, 2879, 72, 45, "Output"]
}, Open  ]],
Cell[286905, 9044, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[287038, 9049, 415, 10, 32, "Input"],
Cell[287456, 9061, 2464, 64, 56, "Output"]
}, Open  ]],
Cell[289935, 9128, 139, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[290099, 9135, 1014, 27, 32, "Input"],
Cell[291116, 9164, 1812, 49, 56, "Output"]
}, Open  ]],
Cell[292943, 9216, 198, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[293166, 9224, 532, 12, 32, "Input"],
Cell[293701, 9238, 941, 19, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294679, 9262, 127, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[294831, 9268, 205, 3, 23, "Print"],
Cell[295039, 9273, 420, 5, 195, "Print"]
}, Open  ]]
}, Open  ]],
Cell[295486, 9282, 386, 9, 32, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
